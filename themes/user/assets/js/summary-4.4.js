webpackJsonp([4,5],Array(240).concat([function(e,t,n){var i,r;i=[n(3),n(229),n(223),n(241),n(242),n(244)],r=function(e,t,n,i,r){"use strict";return t.extend({template:"widgets/addAddress",events:{"click .saveAddress":"addAddress","click .cancelAddress":"cancelAddAddress"},initialize:function(){this.alertMsg||(this.alertMsg=new r)},serialize:function(){return{section:this.model.get("section"),isBillingAddress:this.collection.isBillingAddress,newAddress:this.model.get("newAddress"),addAddressTemplateCountry:this.model.get("addAddressTemplateCountry")}},afterRender:function(){this.formView=new i({el:this.$("form")}),this.$(".selectDropdown").nativeDropdown(),this.$(".lap").lap()},removeServiceErrorMsg:function(){this.$(".alertMsg").remove()},showServiceErrorMsg:function(e){this.removeServiceErrorMsg(),this.$el.find(".overpanel-header").after(this.alertMsg.setMessage(e).el)},cancelAddAddress:function(e){e.preventDefault(),n.trigger("address:cancelAdd"),n.history.navigate(this.model.get("addAddressReturnRoute"),{trigger:!0})},handleAddAddress:function(e,t){var i,r,a=t.addressBook,o=e.get("street1");this.toggleLoading(!1),500===t.statusCode?(r=t.err,this.showServiceErrorMsg(this.$("form").data("error")),n.trigger("trackError",{message:r.errorMsg||r.message,code:r.errorCode})):(n.history.navigate(this.model.get("addAddressReturnRoute"),{trigger:!0}),this.collection.reset(a),i=this.collection.find(function(e){var t=e&&e.get("addressLine1")&&e.get("addressLine1").value;return t&&t.toLowerCase()===o.toLowerCase()?e:void 0}),this.trigger("addAddressSuccess"),n.trigger("address:added",i))},addAddress:function(e){var t=n.Syphon.serialize(this);e.preventDefault(),this.toggleLoading(!0),t.state=t.stateOrProvince,t.countryCode=t.country,t.zip=t.postalCode,t.zip2=t.postalCode2,t.isNewShipping=this.model.get("isNewShipping"),this.listenToOnce(this.collection,"sync",this.handleAddAddress),this.collection.create(t,{wait:!0})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,function(e,t,n){var i,r,a;!function(o,s){n(233)&&(r=[n(224),n(3),n(223)],i=s,a="function"==typeof i?i.apply(t,r):i,!(void 0!==a&&(e.exports=a)))}(this,function(e,t,n){return n.Syphon=function(e,t,n){var i={};i.ignoredTypes=["button","submit","reset","fieldset"],i.serialize=function(e,i){var o={},c=s(i),u=r(e,c);return n.each(u,function(e){var n=t(e),i=a(n),r=c.keyExtractors.get(i),s=r(n),u=c.inputReaders.get(i),d=u(n),h=c.keyAssignmentValidators.get(i);if(h(n,s,d)){var p=c.keySplitter(s);o=l(o,p,d)}}),o},i.deserialize=function(e,i,o){var l=s(o),u=r(e,l),d=c(l,i);n.each(u,function(e){var n=t(e),i=a(n),r=l.keyExtractors.get(i),o=r(n),s=l.inputWriters.get(i),c=d[o];s(n,c)})};var r=function(e,i){var r=o(e),s=r.elements;return s=n.reject(s,function(e){var r,o=a(e),s=i.keyExtractors.get(o),l=s(t(e)),c=n.include(i.ignoredTypes,o),u=n.include(i.include,l),d=n.include(i.exclude,l);return r=u?!1:i.include?!0:d||c})},a=function(e){var n,i=t(e),r=i[0].tagName,a=r;return"input"===r.toLowerCase()&&(n=i.attr("type"),a=n?n:"text"),a.toLowerCase()},o=function(e){return n.isUndefined(e.$el)&&"form"===e.tagName.toLowerCase()?e:e.$el.is("form")?e.el:e.$("form")[0]},s=function(e){var t=n.clone(e)||{};return t.ignoredTypes=n.clone(i.ignoredTypes),t.inputReaders=t.inputReaders||i.InputReaders,t.inputWriters=t.inputWriters||i.InputWriters,t.keyExtractors=t.keyExtractors||i.KeyExtractors,t.keySplitter=t.keySplitter||i.KeySplitter,t.keyJoiner=t.keyJoiner||i.KeyJoiner,t.keyAssignmentValidators=t.keyAssignmentValidators||i.KeyAssignmentValidators,t},l=function(e,t,i){if(!t)return e;var r=t.shift();return e[r]||(e[r]=n.isArray(r)?[]:{}),0===t.length&&(n.isArray(e[r])?e[r].push(i):e[r]=i),t.length>0&&l(e[r],t,i),e},c=function(e,t,i){var r={};return n.each(t,function(t,a){var o={};i&&(a=e.keyJoiner(i,a)),n.isArray(t)?(a+="[]",o[a]=t):n.isObject(t)?o=c(e,t,a):o[a]=t,n.extend(r,o)}),r};return i}(n,t,e),n.Syphon.TypeRegistry=function(){this.registeredTypes={}},n.Syphon.TypeRegistry.extend=n.Model.extend,e.extend(n.Syphon.TypeRegistry.prototype,{get:function(e){var t=this.registeredTypes[e];return t||(t=this.registeredTypes["default"]),t},register:function(e,t){this.registeredTypes[e]=t},registerDefault:function(e){this.registeredTypes["default"]=e},unregister:function(e){this.registeredTypes[e]&&delete this.registeredTypes[e]}}),n.Syphon.KeyExtractorSet=n.Syphon.TypeRegistry.extend(),n.Syphon.KeyExtractors=new n.Syphon.KeyExtractorSet,n.Syphon.KeyExtractors.registerDefault(function(e){return e.prop("name")}),n.Syphon.InputReaderSet=n.Syphon.TypeRegistry.extend(),n.Syphon.InputReaders=new n.Syphon.InputReaderSet,n.Syphon.InputReaders.registerDefault(function(e){return e.val()}),n.Syphon.InputReaders.register("checkbox",function(e){var t=e.prop("checked");return t}),n.Syphon.InputWriterSet=n.Syphon.TypeRegistry.extend(),n.Syphon.InputWriters=new n.Syphon.InputWriterSet,n.Syphon.InputWriters.registerDefault(function(e,t){e.val(t)}),n.Syphon.InputWriters.register("checkbox",function(e,t){e.prop("checked",t)}),n.Syphon.InputWriters.register("radio",function(e,t){e.prop("checked",e.val()===t)}),n.Syphon.KeyAssignmentValidatorSet=n.Syphon.TypeRegistry.extend(),n.Syphon.KeyAssignmentValidators=new n.Syphon.KeyAssignmentValidatorSet,n.Syphon.KeyAssignmentValidators.registerDefault(function(){return!0}),n.Syphon.KeyAssignmentValidators.register("radio",function(e,t,n){return e.prop("checked")}),n.Syphon.KeySplitter=function(e){var t=e.match(/[^\[\]]+/g);return e.indexOf("[]")===e.length-2&&(lastKey=t.pop(),t.push([lastKey])),t},n.Syphon.KeyJoiner=function(e,t){return e+"["+t+"]"},n.Syphon})},,function(e,t,n){var i,r;i=[n(223),n(224),n(247)],r=function(e,t,n){"use strict";var i=e.Collection.extend({url:function(){return e.history.options.root+"address"},model:n,primaryState:"",isBillingAddress:!0,initialize:function(){this.trigger("reset")},parse:function(e){var n;return e.collection?(n=e.collection.findWhere({isDefault:!0}),this.primaryState=n&&n.get("state").value):(n=t.findWhere(e,{isDefault:!0}),this.primaryState=n&&n.state.value),this.homeAddress=n,e},getAddressBook:function(){return this.map(function(e){return{id:e.get("id"),addressLine1:e.get("addressLine1")||{value:e.get("street1")},addressLine2:e.get("addressLine2")||{value:e.get("street2")},city:"string"==typeof e.get("city")?{value:e.get("city")}:e.get("city"),state:"string"==typeof e.get("state")?{value:e.get("state")}:e.get("state"),zipcode:e.get("zipcode")||{value:e.get("zip")},countryCode:e.get("countryCode")||e.get("country"),isDefault:e.get("isDefault"),isNewShipping:e.get("isNewShipping")}},this)},setHomeAddress:function(){this.homeAddress=this.findWhere({isDefault:!0})}});return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({defaults:{isDefault:!1},getAddressDisplayData:function(){return{countryCode:this.get("countryCode"),street1:this.get("addressLine1").value,street2:this.get("addressLine2").value,locality:this.get("city").value,stateOrProvince:this.get("state").value,postalCode:this.get("zipcode").value}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Collection.extend({url:function(){return e.history.options.root+"wallet/balances"},parse:function(e){var t=e.data.balance;return this.canWithdraw=t.canWithdraw,this.primaryCurrency=t.primaryCurrency,this.totalAmount=t.totalAmount,this.totalAvailable=t.totalAvailable,this.totalPending=t.totalPending,this.country=e.sys.locality.country,this.balanceSpecs=e.data.wallet.config.balanceSpecs,t.balanceDetails},setBalanceData:function(e){this.canWithdraw=e.canWithdraw,this.primaryCurrency=e.primaryCurrency,this.totalAmount=e.totalAmount,this.totalAvailable=e.totalAvailable,this.totalPending=e.totalPending,this.country=e.country,this.balanceSpecs=e.balanceSpecs},getBalanceData:function(){return{balanceDetails:this.toJSON(),canWithdraw:this.canWithdraw,primaryCurrency:this.primaryCurrency,totalAmount:this.totalAmount,totalAvailable:this.totalAvailable,totalPending:this.totalPending,country:this.country}},getBalanceConfig:function(){return{balanceSpecs:this.balanceSpecs}},getCurrencySymbol:function(e){var t=this.findWhere({currency:e}),n=t&&t.get("currencySymbol");return n}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(250)],r=function(e,t){"use strict";return e.Collection.extend({url:function(){return e.history.options.root+"wallet/banks"},model:t,parse:function(e){return e.data.banks}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({urlRoot:function(){return e.history.options.root+"wallet/banks"},idAttribute:"fiId",states:{READY_TO_USE:"ready_to_use",CONFIRMED:"confirmed",INITIATE_CONFIRMATION:"initiate_confirmation"},agreementTypes:{SEPA:"sepa",DDI:"ddi",PADS:"pads",CHECKING_SAVINGS:"checkingSavings",DDA:"dda"},authorizationMethods:{NOT_SUPPORTED:"not_supported"},confirmationMethods:{NOT_SUPPORTED:"not_supported"},defaults:{isInstorePreferred:!1,isPrimary:!1,fabExperimentation:!1},needToCheckYodleeEligibility:function(){return"US"===this.get("countryCode")&&!("confirmed"===this.get("state")||""===this.get("state"))&&!this.has("yodleeEligiblity")},walletExperimentation:function(e){var t=e&&e.experiment;this.set({fabExperimentation:t.us_8ball_web_wallet_fab_treatment||t.ca_8ball_web_wallet_fab_treatment||!1})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(252)],r=function(e,t){"use strict";return e.Collection.extend({url:function(){return e.history.options.root+"wallet/cards"},model:t,parse:function(e){return e.CREDIT}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({urlRoot:function(){return e.history.options.root+"wallet/cards"},idAttribute:"fiId",defaults:{hasExpired:!1,isInstorePreferred:!1,isPrimary:!1},getBalance:function(t){function n(e){e.data.balance.prepaid.netspend&&e.data.balance.prepaid.netspend.value?r.set("prepaidBalance",e.data.balance.prepaid.netspend.value):r.set("prepaidBalance",null),t&&t(r.get("prepaidBalance"))}function i(){t&&t(r.get("prepaidBalance"))}var r=this;e.$.ajax({timeout:5e3,url:e.history.options.root+"wallet/cardDetails/"+r.get("fiId")+"/balance",success:n,error:i,ignoreErrors:!0})},getUpdatedCardData:function(t,n,i){var r=this;t.get(e.history.options.root+"wallet/cardDetails/"+this.get("fiId"),function(e){n?r.set("cachedCardState",e.data):(r.unset("cachedCardState"),r.set({riskCardState:e.data.riskCardState,securityCode:e.data.securityCode,state:e.data.state,confirmationMethod:e.data.confirmationMethod}),r.setReadyToUseFlag()),i&&i()})},setReadyToUseFlag:function(){"confirmed"!==this.get("state")&&this.get("state")||this.set("state","ready_to_use")},setCachedCardState:function(){function e(n){var i=t.get("cachedCardState");n>0&&(i?(t.clear({silent:!0}),t.set(i),t.setReadyToUseFlag()):setTimeout(function(){e(n-1)},200))}var t=this;e(600)},parse:function(e){return e.CREDIT?{updated:this.hasChanged()}:e}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,function(e,t,n){var i,r;i=[n(223),n(224)],r=function(e,t){"use strict";var n=e.Model.extend({defaults:{countryCode:"US",accttype:"",state:"",section:"",docNum:"",address:{id:""}},shouldCheckCIPStatus:function(){return"US"===this.get("countryCode")&&"BUSINESS"!==this.get("accttype")},isDocNumMasked:function(){return 0===this.get("docNum").indexOf("XX")},isFourDigits:function(e){return/^\d{4}$/.test(e)},getAddressID:function(){var e=this.get("address");return e.id},getFormattedDocNum:function(e){return this.get("shouldMaskTaxId")?"XX"+e.slice(-2):e},setDenyState:function(e,n,i,r){var a={type:"SSN",value:""};return"DO_DATA_COLLECTION"===e?(n.length&&(a=t.findWhere(n,{confirmation_status:"CONFIRMED"})||n[0]),void this.set({state:"collectData",user:i,birthYears:r.birthYearList,birthMonth:this.get("birthMonth")||r.month,birthDay:this.get("birthDay")||r.day,birthYear:this.get("birthYear")||r.year,docType:a.type,docNum:a.value,isTaxIdConfirmed:"CONFIRMED"===a.confirmation_status,shouldMaskTaxId:""!==a.value})):void this.set("state","CIP_NOT_COMPLETED"===e?"restricted":"failed")},setStateAfterCheck:function(e){var t=e.get("decision"),n=e.get("action"),i=e.get("user")||{birthDate:{}},r=i.birthDate,a=e.get("taxIds")||[];"ALLOW"!==t||"CIP_COMPLETED"!==n&&"INTERNAL_SERVICE_DOWN"!==n?"DENY"===t?this.setDenyState(n,a,i,r):this.set("state","techFailure"):this.set("state","pass")},setStateAfterDataCollection:function(e){var t=e.get("decision"),n=e.get("action");"ALLOW"!==t||"CIP_COMPLETED"!==n&&"INTERNAL_SERVICE_DOWN"!==n?"DENY"===t?"CIP_NOT_COMPLETED"===n?this.set("state","restricted"):this.set("state","failed"):this.set("state","techFailure"):this.set("state","success")}});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/enrollInPAD"},idAttribute:"fiId"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,function(e,t,n){var i,r;i=[n(3),n(229),n(228),n(261)],r=function(e,t,n,i){"use strict";var r=t.extend({el:"#alertDialogs",alert:null,next:null,events:{"click .close, .no, .cancel, .action, .continue":"hideAlert","click .yes":"goNext",transitionend:"transitionEnd",webkitTransitionEnd:"transitionEnd",oTransitionEnd:"transitionEnd",MSTransitionEnd:"transitionEnd"},initialize:function(){this.$el.on("focusin",function(e){e.stopPropagation()})},serialize:function(){return{padExperimentation:i.isTreatment("GB_8ball_wallet_PADportlet_testvariant1_autoenrollPAD")||i.isTreatment("GB_8ball_wallet_PADportlet_testvariant2_PADoptin")}},showAlert:function(t,i){this.next=i,this.alert=this.$("#"+t),this.alert.show(),this.alert.focus(),this.alert.removeClass("hide"),this.$(".alertBackdrop").removeClass("hide"),this.$el.removeClass("isFadingOut").addClass("isFadingIn"),e(window).scrollTop(0),n.isOpen&&n.shouldListenToEsc(!1),this.shouldListenToEsc(!0)},hideAlert:function(e){var t=this.$el;e.preventDefault(),t.addClass("isFadingOut"),this.alert?this.alert.hide():this.$(e.currentTarget).closest(".alert").hide(),n.isOpen&&n.shouldListenToEsc(!0),this.shouldListenToEsc(!1)},transitionEnd:function(){var e=this.$el;e.hasClass("isFadingOut")&&e.removeClass("isFadingIn")},goNext:function(t){var n=(this.alert||this.$(".alert:visible")).attr("id"),i=e(t.target).closest(".alert").attr("id");t.preventDefault(),this.hideAlert(t),"function"==typeof this.next&&n===i&&this.next()},destroyView:function(){this.undelegateEvents(),e(this.el).removeData().unbind()},closeDialog:function(e){27===e.which&&this.hideAlert(e)},shouldListenToEsc:function(t){t?e("body").on("keydown",e.proxy(this.closeDialog,this)):e("body").off("keydown",e.proxy(this.closeDialog,this))}});return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[],r=function(){"use strict";var e=document.body.getAttribute("data-pxp"),t={};try{t=JSON.parse(e)}catch(n){}return{isTreatment:function(e){return t[e]}}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(224),n(263),n(228),n(264),n(223),n(261)],r=function(e,t,n,i,r,a,o){"use strict";return e.extend({template:"widgets/creditProductModule",initialize:function(e){var i,r,a,o,s,l,c,u=!1,d=this.checkChoiceCFSEnabled(),h=e&&e.creditProduct&&e.creditProduct.type||"",p=e&&e.creditPreference&&e.creditPreference.walletPreferences&&e.creditPreference.walletPreferences.PAYPAL_CREDIT&&e.creditPreference.walletPreferences.PAYPAL_CREDIT[0]&&e.creditPreference.walletPreferences.PAYPAL_CREDIT[0].specificType||"";/smartconnect|ebay|paypalextras|bml|extrasmastercard/.test(h)&&e&&e.creditProduct&&(i=e.creditProduct,/BCVL|DLEBAY|DLPLUS|TXNBML|OPENENDED/.test(p)&&e.creditPreference&&(a=e.creditPreference.walletPreferences.PAYPAL_CREDIT,o=e.creditPreference.instorePreference,s=e.creditPreference.onlinePreference,o&&o.accessorDetails&&(l=t.findWhere(a,{id:o.accessorDetails[0].accessorId}),l&&l.id&&(l.id=l.id.replace("-",""))),s&&s.accessorDetails&&(c=t.findWhere(a,{id:s.accessorDetails[0].accessorId}),c&&c.id&&(c.id=c.id.replace("-",""))),u=l&&c&&l.id===c.id),this.model=new n({flavor:i.flavor,moduleContext:e.moduleContext,isPreferredTypeInstoreOnlineSame:u,preferredTypeInstore:l,preferredTypeOnline:c,choiceCFSEnabled:d}),this.listenTo(this.model,"change:summaryData",this.render),i.type&&(r=i),r.paypalCreditRebrand=this.$el.data("paypalcreditrebrand")||!1,this.model.set("summaryData",r))},beforeRender:function(){this.toggleLoading(!0)},afterRender:function(){this.toggleLoading(!1)},showCreditProductDetails:function(){this.creditProductView||(this.creditProductView=new r({model:this.model})),i.setContent(this.creditProductView)},checkChoiceCFSEnabled:function(){return o.isTreatment("Treatment_US_FMX_8Ball_Choice_CFS_Preferred")||o.isTreatment("Treatment_GB_FMX_8Ball_Choice_CFS_Preferred")||o.isTreatment("Treatment_DE_FMX_8Ball_Choice_CFS_Preferred")||o.isTreatment("Treatment_FR_FMX_8Ball_Choice_CFS_Preferred")||o.isTreatment("Treatment_AU_FMX_8Ball_Choice_CFS_Preferred")||o.isTreatment("Treatment_CA_FMX_8Ball_Choice_CFS_Preferred")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({defaults:{summaryData:{},flavor:"","feature-credit":""},setAttributeValues:function(e,t,n,i){this.set({summaryData:e,flavor:t,"feature-credit":n,hasDeferredInterest:i})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229)],r=function(e){"use strict";return e.extend({template:"wallet/overpanel/creditProduct"})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,function(e,t,n){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},r=i(n(3)),a=i(n(223)),o=i(n(4)),s=i(n(229)),l=i(n(245)),c=i(n(267)),u=i(n(268)),d=(i(n(228)),i(n(241))),h=i(n(242)),p=i(n(269)),f=i(n(270)),m=i(n(271)),g=i(n(275)),v=i(n(261)),y=i(n(276));e.exports=s.extend({template:"wallet/overpanel/bank/confirmInstantly",events:{"click .submitYodlee":"submitYodlee","click .linkInstantly":"submitFrictionlessBank","click .submitNO":"submitNO","click .cancelFrictionless":"gotoManualLinking","click .confirmRandomDeposit":"gotoConfirmRandomDeposit","keyup .username, .password":"fabValidation",'click form[name="confirmInstantly"] .viewPADA':"viewPADA"},initialize:function(){this.yodleeModel=new c,this.bankLogoModel=new a.Model,a.trigger("toggleLoading",!1),this.alertMsg=new h,this.submitFrictionLessBankLoginModel=new u},afterRender:function(){this.$(".textInput").textField(),this.$(".lap").lap(),this.confirmType=this.model.get("confirmType"),this.addBankformView=new d({el:this.$('form[name="confirmInstantly"]')}),this.bankLogoView||(this.bankLogoView=new p({el:this.$(".bankLogo"),model:this.bankLogoModel})),this.bankLogoModel.set("bankName",this.model.get("bankName"))},removeServiceErrorMsg:function(){this.$(".alertMsg").remove()},showServiceErrorMsg:function(e){this.removeServiceErrorMsg(),this.$el.find(".overpanel-header").after(this.alertMsg.setMessage(e).el)},submitYodlee:function(e){e.preventDefault();var t=a.Syphon.serialize(this);t.fiId=this.model.id,this.linkingAndLoadingView=this.linkingAndLoadingView||new f({model:new a.Model({confirmType:"yodlee",viewContext:this.model.get("viewContext")})}),this.linkingAndLoadingView.setElement(this.$el).render(),this.listenToOnce(this.yodleeModel,"sync",this.submitSuccess),this.listenToOnce(this.yodleeModel,"error",this.submitError),this.yodleeModel.save(t),this.linkingAndLoadingView=this.linkingAndLoadingView||new f({model:new a.Model({confirmType:"yodlee",viewContext:this.model.get("viewContext")})}),this.linkingAndLoadingView.setElement(this.$el).render()},submitFrictionlessBank:function(e,t){e&&e.preventDefault(),t=t||a.Syphon.serialize(this);var n="fabConfirmBankFlow"===this.confirmType?"fabConfirmBankFlow":"frictionless";window.clearTimeout(this.mfaTimer),this.linkingAndLoadingView=this.linkingAndLoadingView||new f({model:new a.Model({confirmType:n,viewContext:this.model.get("viewContext")})}),this.linkingAndLoadingView.setElement(this.$el).render(),t.id=this.model.get("id"),this.listenToOnce(this.submitFrictionLessBankLoginModel,"sync",this.showNextScreen),this.listenToOnce(this.submitFrictionLessBankLoginModel,"error",this.submitError),this.submitFrictionLessBankLoginModel.save(t)},submitNO:function(e){e.preventDefault(),a.trigger("closeAddBankOverpanel")},submitSuccess:function(e,t){a.trigger("updateBankState",this.model.get("fiId"),"ready_to_use"),v.isTreatment("8ball_wallet_fmx_PADaddbankflow_testvariant2_PADoptin")||v.isTreatment("8ball_wallet_fmx_PADaddbankflow_testvariant1_autoenrollPAD")?(this.linkBankSuccessView=this.linkBankSuccessView||new g({model:new a.Model({data:{manualBankConfirmation:!0,pad:t.pad,fiId:this.model.get("fiId"),viewContext:this.model.get("viewContext")}})}),this.linkBankSuccessView.setElement(this.$el).render()):a.trigger("closeAddBankOverpanel")},submitError:function(e,t,n){var i=t.error&&t.error.code;a.trigger("trackError",{message:n,code:i}),t.error.code===l.wallet.bank.errors.yodleeErrorMaxLoginAttemptsExceeded&&this.model.set("maxAttemptsExceeded",!0),i===l.wallet.bank.errors.attemptsExceeded?this.renderViewFailure():i===l.wallet.bank.errors.invalidMFA&&this.model.get("mfaFlow")?(this.model.set("mfaFlow",!1),"fabConfirmBankFlow"===this.model.get("confirmType")?"fabAddConfirmBankFlow"===this.model.get("flowType")?a.trigger("addConfirminvalidMFA"):a.trigger("confirminvalidMFA"):a.trigger("invalidMFA")):(this.render(),this.showServiceErrorMsg(n))},showNextScreen:function(e,t){var n=t.data,i=t.pad,r=n.bankAccountLists&&n.bankAccountLists.auth_status;if(r){var o=n.bankAccountLists;if("SUCCESS"===o.auth_status)0===o.unconfirmed.length&&0===o.confirmed.length?this.renderViewFailure():(this.model.set({bankAccountLength:o.unconfirmed.length,bankAccounts:o.unconfirmed,bankAccountsConfirmed:o.confirmed,bankAccountsConfirmedLength:o.confirmed.length,bankDetail:this.model.get("bankDetail"),viewContext:this.model.get("viewContext"),bankSpecs:this.model.get("bankSpecs"),selectedAccounts:!1,maxBankLimit:!1}),window.clearTimeout(this.mfaTimer),this.accountLinkingView=this.accountLinkingView||new m({model:this.model}),this.accountLinkingView.addBankConfirmYodleeView=this,this.accountLinkingView.setElement(this.$el).render(),a.trigger("trackLink",null,"continue","main:walletweb:wallet:add:fabaccountlinking"));else if("IN_PROGRESS"===o.auth_status){var s=o.authentication_questions.time_out;this.model.set({loginData:o.authentication_questions,bankDetail:this.model.get("bankDetail"),MFAtimeOut:!1,invalidMFA:!1,mfaFlow:!0,timeout:Math.floor(s/1e3),viewContext:this.model.get("viewContext")}),this.render(),this.mfaTimeoutRedirect(this.model,s),this.model.set("mfaFlow",!1),a.trigger("trackLink",null,"continue","main:walletweb:wallet:add:fabinprogress")}}else this.fabConfirmBank(n,i)},viewPADA:function(e){e.preventDefault(),o.render(o.createElement(y,{context:"confirmBank",next:this.submitFrictionlessBank.bind(this),data:a.Syphon.serialize(this)}),r(".overpanel-content")[0])},fabConfirmBank:function(e,t){if(a.trigger("toggleLoading",!1),0!==e.BANK.confirmed.length||e.BANK.instrumentUnavailable){window.clearTimeout(this.mfaTimer);var n=e.BANK;n.confirmType="fabConfirmBankFlow",n.pad=t,this.renderLinkBankSuccess(n)}else this.renderViewFailure()},gotoManualLinking:function(e){e.preventDefault(),a.trigger("addBank:renderNoFailure")},gotoConfirmRandomDeposit:function(e){e.preventDefault(),"fabAddConfirmBankFlow"===this.model.get("flowType")?a.trigger("fabAddconfirmLater"):a.trigger("confirmDeposit:render")},renderLinkBankSuccess:function(e){this.linkBankSuccessView=this.linkBankSuccessView||new g({model:new a.Model({bankDetail:this.model.get("bankDetail"),data:e,viewContext:this.model.get("viewContext")})}),this.linkBankSuccessView.setElement(this.$el).render(),a.trigger("trackLink",null,"linkBankSuccess","main:walletweb:wallet:add:fabconfirmsuccess")},renderViewFailure:function(){a.trigger("trackLink",null,"notConfirmed","main:walletweb:wallet:add:bankadd"),"fabConfirmBankFlow"===this.model.get("confirmType")?"fabAddConfirmBankFlow"===this.model.get("flowType")?a.trigger("fabAddConfirmBankFlowFailure"):a.trigger("fabConfirmBankFlowFailure"):a.trigger("addBank:render")},mfaTimeoutRedirect:function(e,t){window.clearTimeout(this.mfaTimer),this.mfaTimer=window.setTimeout(function(){e.set("mfaFlow",!1),"fabConfirmBankFlow"===e.get("confirmType")?"fabAddConfirmBankFlow"===e.get("flowType")?a.trigger("mfaAddConfirmtimeOut"):a.trigger("MFAConfirmtimeOut"):a.trigger("MFAtimeOut")},t)},fabValidation:function(e){var t=this.model.get("loginData"),n=t&&t.constraints.length?t.constraints[0].properties:[],i=r(e.currentTarget).children("input").attr("id"),a=n.indexOf(parseInt(i,10)),o=void 0,s=void 0;if(n.length)for(s=0;s<n.length;s++)a>=0&&(o=r("#"+n[s]),n[s]!==parseInt(i,10)?o.removeProp("required").val("").siblings("label").removeClass("accessAid"):o.prop("required",!0))}})},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/banks/instantConfirmBank"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/submitFrictionLessBankLogin"},parse:function(e){return e}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229)],r=function(e){"use strict";return e.extend({template:"widgets/bankLogo",initialize:function(){this.listenTo(this.model,"change",this.render)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},r=i(n(229)),a=1e4;e.exports=r.extend({template:"wallet/overpanel/bank/linkingAndLoading",afterRender:function(){this.updateStatus()},updateStatus:function(){var e=this;this.$(".steps li:nth-child(1)").addClass("progress"),setTimeout(function(){e.$(".steps li:nth-child(1)").removeClass("progress").addClass("done"),e.$(".steps li:nth-child(2)").addClass("progress")},a),setTimeout(function(){e.$(".steps li:nth-child(2)").removeClass("progress").addClass("done"),e.$(".steps li:nth-child(3)").addClass("progress")},a)}})},function(e,t,n){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},r=i(n(3)),a=i(n(223)),o=i(n(4)),s=i(n(229)),l=i(n(245)),c=i(n(242)),u=i(n(241)),d=(i(n(272)),i(n(274))),h=i(n(249)),p=i(n(275)),f=i(n(276));e.exports=s.extend({template:"wallet/overpanel/bank/accountLinking",events:{"click .linkBank":"addFI","click .okBtn":"gotoWalletHome",'click form[name="accountLinking"] .viewPADA':"viewPADA"},initialize:function(){this.listenTo(this.model,"change:selectedAccounts",this.render),this.listenTo(this.model,"change:maxBankLimit",this.render)},afterRender:function(){this.alertView=this.alertView||new c,this.bankCollection=new h(r("section#wallet").data("banks")),this.$(".ppCheckbox").checkbox(),this.formView=new u({el:"form[name=accountLinking]"})},viewPADA:function(e){e.preventDefault(),o.render(o.createElement(f,{context:"addBank",next:this.addFI.bind(this),data:this.$(".linkAccount input:checked")}),r(".overpanel-content")[0])},addFI:function(e,t){var n=t||this.$(".linkAccount input:checked");if(e&&e.preventDefault(),0===n.length&&this.model.get("bankAccountLength")>1){var i=this.$('form[name="accountLinking"]').data("errormsg");return this.model.set({selectedAccounts:!0,maxBankLimit:!1}),void a.trigger("trackError",{message:i})}var o=this.bankCollection.length+n.length;if(o>l.wallet.bank.MAX_BANKS_LIMIT)return void this.model.set({selectedAccounts:!1,maxBankLimit:!0});a.trigger("toggleLoading",!0),this.saveFrictionlessBankModel=this.saveFrictionlessBankModel||new d,this.listenToOnce(this.saveFrictionlessBankModel,"sync",this.gotoSuccessPage),this.listenToOnce(this.saveFrictionlessBankModel,"error",this.onError),this.model.set({selectedAccounts:!1,maxBankLimit:!1});var s=window.fpti;s&&(s.bash=this.$(".linkAccount input:checkbox").length,s.basel=n.length);var c=this.model.get("bankSpecs"),u=[];n.each(function(){var e=r(this).data("routingnumber").toString(),t=e,n="";c.transitCode&&c.routingNumberLength===e.length&&(t=e.slice(0,5),n=e.slice(5,8)),u.push({accountNumber:r(this).val(),fiId:r(this).data("fiid"),routingNumber1:t,routingNumber2:n,bankName:r(this).data("bankname"),accountType:r(this).data("accounttype"),hashToken:r(this).data("hashtoken")})}),this.saveFrictionlessBankModel.save({frictionlessBankData:u})},gotoSuccessPage:function(e,t){var n=this,i=t.data.BANK&&t.data.BANK.confirmed&&t.data.BANK.confirmed.length,r=t.data.BANK&&t.data.BANK.instrumentUnavailable;0!==i||r?!function(){var e=n.model.get("bankAccounts"),i=t.data.BANK&&t.data.BANK.unConfirmed,o={unConfirmed:[]};i.length>0&&e.forEach(function(e){i.forEach(function(t){e.account_number_last_4===t.lastDigits&&o.unConfirmed.push({lastDigits:t.lastDigits,accountType:e.account_type,instrumentUnavailable:t.instrumentUnavailable})})}),o.instrumentUnavailable=r,o.confirmed=t.data.BANK&&t.data.BANK.confirmed,o.pad=t.pad,a.trigger("setReplaceBankPresent",n.model),n.listenToOnce(a,"bankReplaced",n.renderLinkBankSuccess.bind(n,o)),a.trigger("replaceBank"),o.unConfirmed.length?a.trigger("trackLink",null,"linkBankSuccess","main:walletweb:wallet:add:fabpartialsuccess"):o.instrumentUnavailable?a.trigger("trackLink",null,"linkBankSuccess","main:walletweb:wallet:add:fabinstrumentunavailable"):a.trigger("trackLink",null,"linkBankSuccess","main:walletweb:wallet:add:fabsuccess")}():(a.trigger("toggleLoading",!1),a.trigger("addBank:render"),a.trigger("trackError",{message:"no banks confirmed"}))},renderLinkBankSuccess:function(e,t){a.trigger("toggleLoading",!1);var n=new a.Model({data:e,bankDetail:this.model.get("bankDetail"),replaceBankPresent:this.model.get("replaceBankPresent"),viewContext:this.model.get("viewContext")});t&&n.set("replaceBankDeleteError",!0),this.linkBankSuccessView=new p({model:n}),this.linkBankSuccessView.addBankConfirmYodleeView=this.addBankConfirmYodleeView,this.linkBankSuccessView.setElement(this.$el).render()},onError:function(e,t){a.trigger("toggleLoading",!1),this.linkBankSuccessView=this.linkBankSuccessView||new p({model:new a.Model({errorMessage:t.error})}),this.linkBankSuccessView.setElement(this.$el).render(),a.trigger("trackError",{message:t.error,code:t.error.code})},gotoWalletHome:function(e){e.preventDefault(),a.trigger("closeAddBankOverpanel")}})},function(e,t,n){var i,r;i=[n(224),n(3),n(273)],r=function(e,t){"use strict";t.widget("pp.checkbox",{options:{radio:!1},_create:function(){this.$el=this.element,this.options.radio&&this.$el.addClass("radio"),this.$input=this.$el.find("input"),this.$label=this.$el.find("label"),this.$input.off("click"),this.$input.on("click",t.proxy(this.onClick,this))},destroy:function(){t.Widget.prototype.destroy.call(this),this.$input.off("click")},onClick:function(n){var i=this;e.defer(function(){var e=t(n.currentTarget),r=i.$label.not(".disabled");i.options.radio&&(e.parent().parent().find(".checked").removeClass("checked"),e.parent().siblings().find(".icon").removeClass("icon-checkmark-small")),e.attr("checked")?e.removeAttr("checked"):e.attr("checked",!0),r.find(".icon").toggleClass("icon-checkmark-small"),r.parent().addClass("checked")})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){(function(e){/*! jQuery UI - v1.10.1 - 2013-03-11
	* http://jqueryui.com
	* Includes: jquery.ui.widget.js
	* Copyright (c) 2013 jQuery Foundation and other contributors Licensed MIT */
!function(e,t){var n=0,i=Array.prototype.slice,r=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(a){}r(t)},e.widget=function(t,n,i){var r,a,o,s,l={},c=t.split(".")[0];t=t.split(".")[1],r=c+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][r.toLowerCase()]=function(t){return!!e.data(t,r)},e[c]=e[c]||{},a=e[c][t],o=e[c][t]=function(e,t){return this._createWidget?void(arguments.length&&this._createWidget(e,t)):new o(e,t)},e.extend(o,a,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),s=new n,s.options=e.widget.extend({},s.options),e.each(i,function(t,i){return e.isFunction(i)?void(l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},r=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,a=this._superApply;return this._super=e,this._superApply=r,t=i.apply(this,arguments),this._super=n,this._superApply=a,t}}()):void(l[t]=i)}),o.prototype=e.widget.extend(s,{widgetEventPrefix:a?s.widgetEventPrefix:t},l,{constructor:o,namespace:c,widgetName:t,widgetFullName:r}),a?(e.each(a._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,o,n._proto)}),delete a._childConstructors):n._childConstructors.push(o),e.widget.bridge(t,o)},e.widget.extend=function(n){for(var r,a,o=i.call(arguments,1),s=0,l=o.length;l>s;s++)for(r in o[s])a=o[s][r],o[s].hasOwnProperty(r)&&a!==t&&(e.isPlainObject(a)?n[r]=e.isPlainObject(n[r])?e.widget.extend({},n[r],a):e.widget.extend({},a):n[r]=a);return n},e.widget.bridge=function(n,r){var a=r.prototype.widgetFullName||n;e.fn[n]=function(o){var s="string"==typeof o,l=i.call(arguments,1),c=this;return o=!s&&l.length?e.widget.extend.apply(null,[o].concat(l)):o,s?this.each(function(){var i,r=e.data(this,a);return r?e.isFunction(r[o])&&"_"!==o.charAt(0)?(i=r[o].apply(r,l),i!==r&&i!==t?(c=i&&i.jquery?c.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+o+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+o+"'")}):this.each(function(){var t=e.data(this,a);t?t.option(o||{})._init():e.data(this,a,new r(o,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var r,a,o,s=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(s={},r=n.split("."),n=r.shift(),r.length){for(a=s[n]=e.widget.extend({},this.options[n]),o=0;o<r.length-1;o++)a[r[o]]=a[r[o]]||{},a=a[r[o]];if(n=r.pop(),i===t)return a[n]===t?null:a[n];a[n]=i}else{if(i===t)return this.options[n]===t?null:this.options[n];s[n]=i}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var r,a=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=r=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,r=this.widget()),e.each(i,function(i,o){function s(){return t||a.options.disabled!==!0&&!e(this).hasClass("ui-state-disabled")?("string"==typeof o?a[o]:o).apply(a,arguments):void 0}"string"!=typeof o&&(s.guid=o.guid=o.guid||s.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),c=l[1]+a.eventNamespace,u=l[2];u?r.delegate(u,c,s):n.bind(c,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function n(){return("string"==typeof e?i[e]:e).apply(i,arguments)}var i=this;return setTimeout(n,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var r,a,o=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],a=n.originalEvent)for(r in a)r in n||(n[r]=a[r]);return this.element.trigger(n,i),!(e.isFunction(o)&&o.apply(this.element[0],[n].concat(i))===!1||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,r,a){"string"==typeof r&&(r={effect:r});var o,s=r?r===!0||"number"==typeof r?n:r.effect||n:t;r=r||{},"number"==typeof r&&(r={duration:r}),o=!e.isEmptyObject(r),r.complete=a,r.delay&&i.delay(r.delay),o&&e.effects&&e.effects.effect[s]?i[t](r):s!==t&&i[s]?i[s](r.duration,r.easing,a):i.queue(function(n){e(this)[t](),a&&a.call(i[0]),n()})}})}(e)}).call(t,n(3))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/addConfirmBank"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(223),n(3),n(258),n(261)],r=function(e,t,n,i,r){"use strict";return e.extend({template:"wallet/overpanel/bank/linkBankSuccess",initialize:function(){var e,i,a=n("section#wallet").data("balance"),o=a&&a.totalAvailable&&a.totalAvailable.unformattedAmount||"",s=a&&a.totalAvailable&&a.totalAvailable.isNegative||"",l=this.model.get("data"),c=l.confirmed||[],u=l.unConfirmed||[],d=l.manualBankConfirmation;this.model.set({totalbalanceavailable:o,isNegative:s,padOptIn:r.isTreatment("8ball_wallet_fmx_PADaddbankflow_testvariant3_PADoptin2")||r.isTreatment("8ball_wallet_fmx_PADaddbankflow_testvariant2_PADoptin")||r.isTreatment("GB_8ball_wallet_PADportlet_testvariant2_PADoptin"),padVariantName:this.getCurrentPADOptinTreatment(),padAutoEnrollSuccess:(r.isTreatment("8ball_wallet_fmx_PADaddbankflow_testvariant1_autoenrollPAD")||r.isTreatment("GB_8ball_wallet_PADportlet_testvariant1_autoenrollPAD"))&&this.model.get("data")&&this.model.get("data").pad,confirmedAccounts:c&&c.length>0||d?!0:!1,unconfirmedAccounts:u&&0===u.length?!1:!0,iconPositive:c.length>0&&0===u.length||d?!0:!1}),l.manualBankConfirmation||(e=l.confirmed,i=e.map(function(e){return e.fiId}),e.forEach(function(e){var n={};n.BANK=e,t.trigger("addCards",n)}),i.forEach(function(e){t.trigger("updateBankState",e,"ready_to_use")})),this.render()},events:{"click #padOptIn":"enrollInPAD","click .gotoStart":"showWalletPage","click .js_gotoPayment":"gotoPayment"},afterRender:function(){this.model.get("padAutoEnrollSuccess")&&t.trigger("renderPadStatus",{fiId:this.getPADfiId()})},showWalletPage:function(e){return e.preventDefault(),t.trigger("closeAddBankOverpanel"),!1},gotoPayment:function(e){return this.addBankConfirmYodleeView.triggerPaymentFlow(),!1},padSuccess:function(){return t.trigger("renderPadStatus",{fiId:this.getPADfiId()}),t.trigger("toggleLoading",!1),t.trigger("trackLink",null,"PADOptin","main:walletweb:wallet:home:enrollpadsuccess"),t.trigger("closeAddBankOverpanel"),!1},enrollPADFailed:function(){return t.trigger("renderPadStatus",!1),t.trigger("toggleLoading",!1),t.trigger("trackLink",null,"PADOptin","main:walletweb:wallet:home:enrollpadfailed"),t.trigger("closeAddBankOverpanel"),!1},enrollInPAD:function(e){return e.preventDefault(),t.trigger("toggleLoading",!0),this.padModel=new i,this.listenTo(this.padModel,"sync",this.padSuccess),this.listenTo(this.padModel,"error",this.enrollPADFailed),this.padModel.save({default_payment_method:!0}),!1},getPADfiId:function(){var e=this.model.get("data"),t=e.fiId||e.confirmed&&e.confirmed[0].fiId;return t},getCurrentPADOptinTreatment:function(){var e;return["8ball_wallet_fmx_PADaddbankflow_control1","8ball_wallet_fmx_PADaddbankflow_control2","8ball_wallet_fmx_PADaddbankflow_testvariant2_PADoptin","8ball_wallet_fmx_PADaddbankflow_testvariant3_PADoptin2"].forEach(function(t){r.isTreatment(t)&&(e=t)}),e}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},r=i(n(4)),a=i(n(277)),o=n(312).printSectionInPopup,s=r.createClass({displayName:"PreAuthorizedDebitsAgreement",mixins:[a("locales/wallet/overpanel/bank/agreement/pads")],propTypes:{context:r.PropTypes.string.isRequired,next:r.PropTypes.func.isRequired,data:r.PropTypes.object.isRequired},handlePrint:function(e){e.preventDefault(),o(document.getElementById("pada").innerHTML,this.i18n("header.padsHeader"))},handleAcceptPADA:function(e){e.preventDefault(),this.props.next(null,this.props.data)},renderAddBankInfo:function(){return r.createElement("div",null,r.createElement("p",null,this.i18n("info.addBankText1")),r.createElement("p",null,this.i18n("info.addBankText2")),r.createElement("p",null,this.i18n("info.addBankText3")))},render:function(){return r.createElement("div",null,r.createElement("div",{id:"overpanel-header",className:"overpanel-header"},r.createElement("h2",{className:"detailsHeader"},this.i18n("header.acceptAuthorization"))),r.createElement("div",{className:"overpanel-body"},"addBank"===this.props.context?this.renderAddBankInfo():null,r.createElement("div",{id:"pada",className:"mandateText"},r.createElement("p",{className:"linkToPrint pull-right"},r.createElement("a",{href:"#print",onClick:this.handlePrint},this.i18n("action.print"))),r.createElement("h3",null,this.i18n("header.mandateInnerHeader")),r.createElement("h4",null,this.i18n("header.padsHeader")),r.createElement("ol",null,r.createElement("li",null,r.createElement("strong",null,this.i18n("info.rightsHeader1")),r.createElement("p",{dangerouslySetInnerHTML:{__html:this.i18n("info.rightsText1")}})),r.createElement("li",null,r.createElement("strong",null,this.i18n("info.rightsHeader2")),r.createElement("p",null,this.i18n("info.rightsText2"))),r.createElement("li",null,r.createElement("strong",null,this.i18n("info.rightsHeader3")),r.createElement("p",null,this.i18n("info.rightsText3"))),r.createElement("li",null,r.createElement("strong",null,this.i18n("info.rightsHeader4")),r.createElement("p",null,this.i18n("info.rightsText4"))),r.createElement("li",null,r.createElement("strong",null,this.i18n("info.rightsHeader5")),r.createElement("p",null,this.i18n("info.rightsText5"))),r.createElement("li",null,r.createElement("strong",null,this.i18n("info.rightsHeader6")),r.createElement("p",{dangerouslySetInnerHTML:{__html:this.i18n("info.rightsText6")}})),r.createElement("li",null,r.createElement("strong",null,this.i18n("info.rightsHeader7")),r.createElement("p",null,this.i18n("info.rightsText7"))),r.createElement("li",null,r.createElement("strong",null,this.i18n("info.rightsHeader8")),r.createElement("p",null,this.i18n("info.rightsText8"))),r.createElement("li",null,r.createElement("strong",null,this.i18n("info.rightsHeader9")),r.createElement("p",null,this.i18n("info.rightsText9"))),r.createElement("li",null,r.createElement("strong",null,this.i18n("info.rightsHeader10")),r.createElement("p",{dangerouslySetInnerHTML:{__html:this.i18n("info.rightsText10")}})),r.createElement("li",null,this.i18n("info.rightsText11")),r.createElement("li",null,this.i18n("info.rightsText12")))),r.createElement("a",{href:"#",className:"vx_btn vx_btn-block",name:"acceptAuthorization",role:"button","data-pagename":"main:walletweb:wallet:add:bankpada",style:{marginTop:"15px"},onClick:this.handleAcceptPADA},this.i18n("action.accept"))))}});e.exports=s},function(e,t,n){"use strict";var i=function(e){return e&&e.__esModule?e["default"]:e},r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e)){for(var n,i=[],r=e[Symbol.iterator]();!(n=r.next()).done&&(i.push(n.value),!t||i.length!==t););return i}throw new TypeError("Invalid attempt to destructure non-iterable instance")},a=i(n(278)),o=i(n(224)),s=n(279).IntlMixin,l=n(219).requirejs,c=a.getLocale(),u=c.split("-"),d=r(u,2),h=d[0],p=d[1],f=""+document.body.getAttribute("data-js-path").replace("/js","")+"/locales/"+p+"/"+h;l.config({paths:{locales:f}}),e.exports=function(){for(var e=arguments.length,t=Array(e),n=0;e>n;n++)t[n]=arguments[n];var i={};return o.extend(i,s,{componentWillMount:function(){var e=this;l(t,function(){for(var t=arguments.length,n=Array(t),i=0;t>i;i++)n[i]=arguments[i];e.context.messages=o.extend.apply(null,[{}].concat(n)),e.forceUpdate()})},getDefaultProps:function(){return{locales:[c]}},i18n:function(e,t){return this.context.messages?this.formatMessage(this.getIntlMessage(e),t):""}}),i}},function(e,t){"use strict";var n=document.getElementsByTagName("html")[0],i=n.getAttribute("lang")||"en_US",r=i.replace("_","-"),a={getLocale:function(){return r}};e.exports=a},function(e,t,n){(function(i){"use strict";var r=i.React;i.React=n(4);var a=n(280);if(n(311),t=e.exports=a.IntlMixin,Object.keys(a).forEach(function(e){Object.defineProperty(t,e,{enumerable:!0,value:a[e]})}),r)i.React=r;else try{delete i.React}catch(o){i.React=void 0}}).call(t,function(){return this}())},function(e,t,n){"use strict";function i(e){r["default"].__addLocaleData(e),a["default"].__addLocaleData(e)}t.__addLocaleData=i;var r=n(281),a=n(291),o=n(298),s=n(299),l=n(304),c=n(305),u=n(306),d=n(307),h=n(308),p=n(309);i(o["default"]),t.IntlMixin=s["default"],t.FormattedDate=l["default"],t.FormattedTime=c["default"],t.FormattedRelative=u["default"],t.FormattedNumber=d["default"],t.FormattedMessage=h["default"],t.FormattedHTMLMessage=p["default"]},function(e,t,n){"use strict";var i=n(282)["default"];n(290),t=e.exports=i,t["default"]=t},function(e,t,n){"use strict";var i=n(283),r=n(289);i["default"].__addLocaleData(r["default"]),i["default"].defaultLocale="en",t["default"]=i["default"]},function(e,t,n){"use strict";function i(e,t,n){var r="string"==typeof e?i.__parse(e):e;if(!r||"messageFormatPattern"!==r.type)throw new TypeError("A message must be provided as a String or AST.");n=this._mergeFormats(i.formats,n),a.defineProperty(this,"_locale",{value:this._resolveLocale(t)});var o=this._findPluralRuleFunction(this._locale),s=this._compilePattern(r,t,n,o),l=this;this.format=function(e){return l._format(s,e)}}var r=n(284),a=n(285),o=n(286),s=n(287);t["default"]=i,a.defineProperty(i,"formats",{enumerable:!0,value:{number:{currency:{style:"currency"},percent:{style:"percent"}},date:{"short":{month:"numeric",day:"numeric",year:"2-digit"},medium:{month:"short",day:"numeric",year:"numeric"},"long":{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"}},time:{"short":{hour:"numeric",minute:"numeric"},medium:{hour:"numeric",minute:"numeric",second:"numeric"},"long":{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"},full:{hour:"numeric",minute:"numeric",second:"numeric",timeZoneName:"short"}}}}),a.defineProperty(i,"__localeData__",{value:a.objCreate(null)}),a.defineProperty(i,"__addLocaleData",{value:function(e){if(!e||!e.locale)throw new Error("Locale data provided to IntlMessageFormat is missing a `locale` property");i.__localeData__[e.locale.toLowerCase()]=e}}),a.defineProperty(i,"__parse",{value:s["default"].parse}),a.defineProperty(i,"defaultLocale",{enumerable:!0,writable:!0,value:void 0}),i.prototype.resolvedOptions=function(){return{locale:this._locale}},i.prototype._compilePattern=function(e,t,n,i){var r=new o["default"](t,n,i);return r.compile(e)},i.prototype._findPluralRuleFunction=function(e){for(var t=i.__localeData__,n=t[e.toLowerCase()];n;){if(n.pluralRuleFunction)return n.pluralRuleFunction;n=n.parentLocale&&t[n.parentLocale.toLowerCase()]}throw new Error("Locale data added to IntlMessageFormat is missing a `pluralRuleFunction` for :"+e)},i.prototype._format=function(e,t){var n,i,a,o,s,l="";for(n=0,i=e.length;i>n;n+=1)if(a=e[n],"string"!=typeof a){if(o=a.id,!t||!r.hop.call(t,o))throw new Error("A value must be provided for: "+o);s=t[o],l+=a.options?this._format(a.getOption(s),t):a.format(s)}else l+=a;return l},i.prototype._mergeFormats=function(e,t){var n,i,o={};for(n in e)r.hop.call(e,n)&&(o[n]=i=a.objCreate(e[n]),t&&r.hop.call(t,n)&&r.extend(i,t[n]));return o},i.prototype._resolveLocale=function(e){"string"==typeof e&&(e=[e]),e=(e||[]).concat(i.defaultLocale);var t,n,r,a,o=i.__localeData__;for(t=0,n=e.length;n>t;t+=1)for(r=e[t].toLowerCase().split("-");r.length;){if(a=o[r.join("-")])return a.locale;r.pop()}var s=e.pop();throw new Error("No locale data has been added to IntlMessageFormat for: "+e.join(", ")+", or the default locale: "+s)}},function(e,t){"use strict";function n(e){var t,n,r,a,o=Array.prototype.slice.call(arguments,1);for(t=0,n=o.length;n>t;t+=1)if(r=o[t])for(a in r)i.call(r,a)&&(e[a]=r[a]);return e}t.extend=n;var i=Object.prototype.hasOwnProperty;t.hop=i},function(e,t,n){"use strict";var i=n(284),r=function(){try{return!!Object.defineProperty({},"a",{})}catch(e){return!1}}(),a=(!r&&!Object.prototype.__defineGetter__,r?Object.defineProperty:function(e,t,n){"get"in n&&e.__defineGetter__?e.__defineGetter__(t,n.get):(!i.hop.call(e,t)||"value"in n)&&(e[t]=n.value)}),o=Object.create||function(e,t){function n(){}var r,o;n.prototype=e,r=new n;for(o in t)i.hop.call(t,o)&&a(r,o,t[o]);return r};t.defineProperty=a,t.objCreate=o},function(e,t){"use strict";function n(e,t,n){this.locales=e,this.formats=t,this.pluralFn=n}function i(e){this.id=e}function r(e,t,n,i,r){this.id=e,this.useOrdinal=t,this.offset=n,this.options=i,this.pluralFn=r}function a(e,t,n,i){this.id=e,this.offset=t,this.numberFormat=n,this.string=i}function o(e,t){this.id=e,this.options=t}t["default"]=n,n.prototype.compile=function(e){return this.pluralStack=[],this.currentPlural=null,this.pluralNumberFormat=null,this.compileMessage(e)},n.prototype.compileMessage=function(e){if(!e||"messageFormatPattern"!==e.type)throw new Error('Message AST is not of type: "messageFormatPattern"');var t,n,i,r=e.elements,a=[];for(t=0,n=r.length;n>t;t+=1)switch(i=r[t],i.type){case"messageTextElement":a.push(this.compileMessageText(i));break;case"argumentElement":a.push(this.compileArgument(i));break;default:throw new Error("Message element does not have a valid type")}return a},n.prototype.compileMessageText=function(e){return this.currentPlural&&/(^|[^\\])#/g.test(e.value)?(this.pluralNumberFormat||(this.pluralNumberFormat=new Intl.NumberFormat(this.locales)),new a(this.currentPlural.id,this.currentPlural.format.offset,this.pluralNumberFormat,e.value)):e.value.replace(/\\#/g,"#")},n.prototype.compileArgument=function(e){var t=e.format;if(!t)return new i(e.id);var n,a=this.formats,s=this.locales,l=this.pluralFn;switch(t.type){case"numberFormat":return n=a.number[t.style],{id:e.id,format:new Intl.NumberFormat(s,n).format};case"dateFormat":return n=a.date[t.style],{id:e.id,format:new Intl.DateTimeFormat(s,n).format};case"timeFormat":return n=a.time[t.style],{id:e.id,format:new Intl.DateTimeFormat(s,n).format};case"pluralFormat":return n=this.compileOptions(e),new r(e.id,t.ordinal,t.offset,n,l);case"selectFormat":return n=this.compileOptions(e),new o(e.id,n);default:throw new Error("Message element does not have a valid format type")}},n.prototype.compileOptions=function(e){var t=e.format,n=t.options,i={};this.pluralStack.push(this.currentPlural),this.currentPlural="pluralFormat"===t.type?e:null;var r,a,o;for(r=0,a=n.length;a>r;r+=1)o=n[r],i[o.selector]=this.compileMessage(o.value);return this.currentPlural=this.pluralStack.pop(),i},i.prototype.format=function(e){return e?"string"==typeof e?e:String(e):""},r.prototype.getOption=function(e){var t=this.options,n=t["="+e]||t[this.pluralFn(e-this.offset,this.useOrdinal)];return n||t.other},a.prototype.format=function(e){var t=this.numberFormat.format(e-this.offset);return this.string.replace(/(^|[^\\])#/g,"$1"+t).replace(/\\#/g,"#")},o.prototype.getOption=function(e){var t=this.options;return t[e]||t.other}},function(e,t,n){"use strict";t=e.exports=n(288)["default"],t["default"]=t},function(e,t){"use strict";t["default"]=function(){function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function t(e,t,n,i,r,a){this.message=e,this.expected=t,this.found=n,this.offset=i,this.line=r,this.column=a,this.name="SyntaxError"}function n(e){function n(t){function n(t,n,i){var r,a;for(r=n;i>r;r++)a=e.charAt(r),"\n"===a?(t.seenCR||t.line++,t.column=1,t.seenCR=!1):"\r"===a||"\u2028"===a||"\u2029"===a?(t.line++,t.column=1,t.seenCR=!0):(t.column++,t.seenCR=!1)}return He!==t&&(He>t&&(He=0,qe={line:1,column:1,seenCR:!1}),n(qe,He,t),He=t),qe}function i(e){Ge>ze||(ze>Ge&&(Ge=ze,Ke=[]),Ke.push(e))}function r(i,r,a){function o(e){var t=1;for(e.sort(function(e,t){return e.description<t.description?-1:e.description>t.description?1:0});t<e.length;)e[t-1]===e[t]?e.splice(t,1):t++}function s(e,t){function n(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}var i,r,a,o=new Array(e.length);for(a=0;a<e.length;a++)o[a]=e[a].description;return i=e.length>1?o.slice(0,-1).join(", ")+" or "+o[e.length-1]:o[0],r=t?'"'+n(t)+'"':"end of input","Expected "+i+" but "+r+" found."}var l=n(a),c=a<e.length?e.charAt(a):null;return null!==r&&o(r),new t(null!==i?i:s(r,c),r,c,a,l.line,l.column)}function a(){var e;return e=o()}function o(){var e,t,n;for(e=ze,t=[],n=s();n!==A;)t.push(n),n=s();return t!==A&&(Ye=e,t=O(t)),e=t}function s(){var e;return e=c(),e===A&&(e=d()),e}function l(){var t,n,i,r,a,o;if(t=ze,n=[],i=ze,r=C(),r!==A?(a=E(),a!==A?(o=C(),o!==A?(r=[r,a,o],i=r):(ze=i,i=I)):(ze=i,i=I)):(ze=i,i=I),i!==A)for(;i!==A;)n.push(i),i=ze,r=C(),r!==A?(a=E(),a!==A?(o=C(),o!==A?(r=[r,a,o],i=r):(ze=i,i=I)):(ze=i,i=I)):(ze=i,i=I);else n=I;return n!==A&&(Ye=t,n=B(n)),t=n,t===A&&(t=ze,n=k(),n!==A&&(n=e.substring(t,ze)),t=n),t}function c(){var e,t;return e=ze,t=l(),t!==A&&(Ye=e,t=F(t)),e=t}function u(){var t,n,r;if(t=x(),t===A){if(t=ze,n=[],L.test(e.charAt(ze))?(r=e.charAt(ze),ze++):(r=A,0===Xe&&i(V)),r!==A)for(;r!==A;)n.push(r),L.test(e.charAt(ze))?(r=e.charAt(ze),ze++):(r=A,0===Xe&&i(V));else n=I;n!==A&&(n=e.substring(t,ze)),t=n}return t}function d(){var t,n,r,a,o,s,l,c,d;return t=ze,123===e.charCodeAt(ze)?(n=R,ze++):(n=A,0===Xe&&i($)),n!==A?(r=C(),r!==A?(a=u(),a!==A?(o=C(),o!==A?(s=ze,44===e.charCodeAt(ze)?(l=U,ze++):(l=A,0===Xe&&i(W)),l!==A?(c=C(),c!==A?(d=h(),d!==A?(l=[l,c,d],s=l):(ze=s,s=I)):(ze=s,s=I)):(ze=s,s=I),s===A&&(s=j),s!==A?(l=C(),l!==A?(125===e.charCodeAt(ze)?(c=z,ze++):(c=A,0===Xe&&i(Y)),c!==A?(Ye=t,n=H(a,s),t=n):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I),t}function h(){var e;return e=p(),e===A&&(e=f(),e===A&&(e=m(),e===A&&(e=g()))),e}function p(){var t,n,r,a,o,s,l;return t=ze,e.substr(ze,6)===q?(n=q,ze+=6):(n=A,0===Xe&&i(G)),n===A&&(e.substr(ze,4)===K?(n=K,ze+=4):(n=A,0===Xe&&i(X)),n===A&&(e.substr(ze,4)===J?(n=J,ze+=4):(n=A,0===Xe&&i(Q)))),n!==A?(r=C(),r!==A?(a=ze,44===e.charCodeAt(ze)?(o=U,ze++):(o=A,0===Xe&&i(W)),o!==A?(s=C(),s!==A?(l=E(),l!==A?(o=[o,s,l],a=o):(ze=a,a=I)):(ze=a,a=I)):(ze=a,a=I),a===A&&(a=j),a!==A?(Ye=t,n=Z(n,a),t=n):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I),t}function f(){var t,n,r,a,o,s;return t=ze,e.substr(ze,6)===ee?(n=ee,ze+=6):(n=A,0===Xe&&i(te)),n!==A?(r=C(),r!==A?(44===e.charCodeAt(ze)?(a=U,ze++):(a=A,0===Xe&&i(W)),a!==A?(o=C(),o!==A?(s=b(),s!==A?(Ye=t,n=ne(s),t=n):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I),t}function m(){var t,n,r,a,o,s;return t=ze,e.substr(ze,13)===ie?(n=ie,ze+=13):(n=A,0===Xe&&i(re)),n!==A?(r=C(),r!==A?(44===e.charCodeAt(ze)?(a=U,ze++):(a=A,0===Xe&&i(W)),a!==A?(o=C(),o!==A?(s=b(),s!==A?(Ye=t,n=ae(s),t=n):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I),t}function g(){var t,n,r,a,o,s,l;if(t=ze,e.substr(ze,6)===oe?(n=oe,ze+=6):(n=A,0===Xe&&i(se)),n!==A)if(r=C(),r!==A)if(44===e.charCodeAt(ze)?(a=U,ze++):(a=A,0===Xe&&i(W)),a!==A)if(o=C(),o!==A){if(s=[],l=y(),l!==A)for(;l!==A;)s.push(l),l=y();else s=I;s!==A?(Ye=t,n=le(s),t=n):(ze=t,t=I)}else ze=t,t=I;else ze=t,t=I;else ze=t,t=I;else ze=t,t=I;return t}function v(){var t,n,r,a;return t=ze,n=ze,61===e.charCodeAt(ze)?(r=ce,ze++):(r=A,0===Xe&&i(ue)),r!==A?(a=x(),a!==A?(r=[r,a],n=r):(ze=n,n=I)):(ze=n,n=I),n!==A&&(n=e.substring(t,ze)),t=n,t===A&&(t=E()),t}function y(){var t,n,r,a,s,l,c,u,d;return t=ze,n=C(),n!==A?(r=v(),r!==A?(a=C(),a!==A?(123===e.charCodeAt(ze)?(s=R,ze++):(s=A,0===Xe&&i($)),s!==A?(l=C(),l!==A?(c=o(),c!==A?(u=C(),u!==A?(125===e.charCodeAt(ze)?(d=z,ze++):(d=A,0===Xe&&i(Y)),d!==A?(Ye=t,n=de(r,c),t=n):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I),t}function w(){var t,n,r,a;return t=ze,e.substr(ze,7)===he?(n=he,ze+=7):(n=A,0===Xe&&i(pe)),n!==A?(r=C(),r!==A?(a=x(),a!==A?(Ye=t,n=fe(a),t=n):(ze=t,t=I)):(ze=t,t=I)):(ze=t,t=I),t}function b(){var e,t,n,i,r;if(e=ze,t=w(),t===A&&(t=j),t!==A)if(n=C(),n!==A){if(i=[],r=y(),r!==A)for(;r!==A;)i.push(r),r=y();else i=I;i!==A?(Ye=e,t=me(t,i),e=t):(ze=e,e=I)}else ze=e,e=I;else ze=e,e=I;return e}function k(){var t,n;if(Xe++,t=[],ve.test(e.charAt(ze))?(n=e.charAt(ze),ze++):(n=A,0===Xe&&i(ye)),n!==A)for(;n!==A;)t.push(n),ve.test(e.charAt(ze))?(n=e.charAt(ze),ze++):(n=A,0===Xe&&i(ye));else t=I;return Xe--,t===A&&(n=A,0===Xe&&i(ge)),t}function C(){var t,n,r;for(Xe++,t=ze,n=[],r=k();r!==A;)n.push(r),r=k();return n!==A&&(n=e.substring(t,ze)),t=n,Xe--,t===A&&(n=A,0===Xe&&i(we)),t}function _(){var t;return be.test(e.charAt(ze))?(t=e.charAt(ze),ze++):(t=A,0===Xe&&i(ke)),t}function D(){var t;return Ce.test(e.charAt(ze))?(t=e.charAt(ze),ze++):(t=A,0===Xe&&i(_e)),t}function x(){var t,n,r,a,o,s;if(t=ze,48===e.charCodeAt(ze)?(n=De,ze++):(n=A,0===Xe&&i(xe)),n===A){if(n=ze,r=ze,Te.test(e.charAt(ze))?(a=e.charAt(ze),ze++):(a=A,0===Xe&&i(Ee)),a!==A){for(o=[],s=_();s!==A;)o.push(s),s=_();o!==A?(a=[a,o],r=a):(ze=r,r=I)}else ze=r,r=I;r!==A&&(r=e.substring(n,ze)),n=r}return n!==A&&(Ye=t,n=Me(n)),t=n}function T(){var t,n,r,a,o,s,l,c;return Se.test(e.charAt(ze))?(t=e.charAt(ze),ze++):(t=A,0===Xe&&i(Ae)),t===A&&(t=ze,e.substr(ze,2)===Ne?(n=Ne,ze+=2):(n=A,0===Xe&&i(Pe)),n!==A&&(Ye=t,n=Oe()),t=n,t===A&&(t=ze,e.substr(ze,2)===Ie?(n=Ie,ze+=2):(n=A,0===Xe&&i(Be)),n!==A&&(Ye=t,n=Fe()),t=n,t===A&&(t=ze,e.substr(ze,2)===Le?(n=Le,ze+=2):(n=A,0===Xe&&i(Ve)),n!==A&&(Ye=t,n=Re()),t=n,t===A&&(t=ze,e.substr(ze,2)===$e?(n=$e,ze+=2):(n=A,0===Xe&&i(je)),n!==A?(r=ze,a=ze,o=D(),o!==A?(s=D(),s!==A?(l=D(),l!==A?(c=D(),c!==A?(o=[o,s,l,c],a=o):(ze=a,a=I)):(ze=a,a=I)):(ze=a,a=I)):(ze=a,a=I),a!==A&&(a=e.substring(r,ze)),r=a,r!==A?(Ye=t,n=Ue(r),t=n):(ze=t,t=I)):(ze=t,t=I))))),t}function E(){var e,t,n;if(e=ze,t=[],n=T(),n!==A)for(;n!==A;)t.push(n),n=T();else t=I;return t!==A&&(Ye=e,t=We(t)),e=t}var M,S=arguments.length>1?arguments[1]:{},A={},N={start:a},P=a,O=function(e){return{type:"messageFormatPattern",elements:e}},I=A,B=function(e){var t,n,i,r,a,o="";for(t=0,i=e.length;i>t;t+=1)for(r=e[t],n=0,a=r.length;a>n;n+=1)o+=r[n];return o},F=function(e){return{type:"messageTextElement",value:e}},L=/^[^ \t\n\r,.+={}#]/,V={type:"class",value:"[^ \\t\\n\\r,.+={}#]",description:"[^ \\t\\n\\r,.+={}#]"},R="{",$={type:"literal",value:"{",description:'"{"'},j=null,U=",",W={type:"literal",value:",",description:'","'},z="}",Y={type:"literal",value:"}",description:'"}"'},H=function(e,t){return{type:"argumentElement",id:e,format:t&&t[2]}},q="number",G={type:"literal",value:"number",description:'"number"'},K="date",X={type:"literal",value:"date",description:'"date"'},J="time",Q={type:"literal",value:"time",description:'"time"'},Z=function(e,t){return{type:e+"Format",style:t&&t[2]}},ee="plural",te={type:"literal",value:"plural",description:'"plural"'},ne=function(e){return{type:e.type,ordinal:!1,offset:e.offset||0,options:e.options}},ie="selectordinal",re={type:"literal",value:"selectordinal",description:'"selectordinal"'},ae=function(e){return{type:e.type,ordinal:!0,offset:e.offset||0,options:e.options}},oe="select",se={type:"literal",value:"select",description:'"select"'},le=function(e){return{type:"selectFormat",options:e}},ce="=",ue={type:"literal",value:"=",description:'"="'},de=function(e,t){return{type:"optionalFormatPattern",selector:e,value:t}},he="offset:",pe={type:"literal",value:"offset:",description:'"offset:"'},fe=function(e){return e},me=function(e,t){return{type:"pluralFormat",offset:e,options:t}},ge={type:"other",description:"whitespace"},ve=/^[ \t\n\r]/,ye={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},we={type:"other",description:"optionalWhitespace"},be=/^[0-9]/,ke={type:"class",value:"[0-9]",description:"[0-9]"},Ce=/^[0-9a-f]/i,_e={type:"class",value:"[0-9a-f]i",description:"[0-9a-f]i"},De="0",xe={type:"literal",value:"0",description:'"0"'},Te=/^[1-9]/,Ee={type:"class",value:"[1-9]",description:"[1-9]"},Me=function(e){return parseInt(e,10)},Se=/^[^{}\\\0-\x1F \t\n\r]/,Ae={type:"class",value:"[^{}\\\\\\0-\\x1F \\t\\n\\r]",description:"[^{}\\\\\\0-\\x1F \\t\\n\\r]"},Ne="\\#",Pe={type:"literal",value:"\\#",description:'"\\\\#"'},Oe=function(){return"\\#"},Ie="\\{",Be={type:"literal",value:"\\{",description:'"\\\\{"'},Fe=function(){return"{"},Le="\\}",Ve={type:"literal",value:"\\}",description:'"\\\\}"'},Re=function(){return"}"},$e="\\u",je={type:"literal",value:"\\u",description:'"\\\\u"'},Ue=function(e){return String.fromCharCode(parseInt(e,16))},We=function(e){return e.join("")},ze=0,Ye=0,He=0,qe={line:1,column:1,seenCR:!1},Ge=0,Ke=[],Xe=0;if("startRule"in S){if(!(S.startRule in N))throw new Error("Can't start parsing from rule \""+S.startRule+'".');P=N[S.startRule]}if(M=P(),M!==A&&ze===e.length)return M;throw M!==A&&ze<e.length&&i({type:"end",description:"end of input"}),r(null,Ke,Ge)}return e(t,Error),{SyntaxError:t,parse:n}}()},function(e,t){"use strict";t["default"]={locale:"en",pluralRuleFunction:function(e,t){var n=String(e).split("."),i=!n[1],r=Number(n[0])==e,a=r&&n[0].slice(-1),o=r&&n[0].slice(-2);return t?1==a&&11!=o?"one":2==a&&12!=o?"two":3==a&&13!=o?"few":"other":1==e&&i?"one":"other"}}},function(e,t){},function(e,t,n){"use strict";var i=n(292)["default"];n(297),t=e.exports=i,t["default"]=t},function(e,t,n){"use strict";var i=n(293),r=n(296);i["default"].__addLocaleData(r["default"]),i["default"].defaultLocale="en",t["default"]=i["default"]},function(e,t,n){"use strict";function i(e,t){t=t||{},o.isArray(e)&&(e=e.concat()),
o.defineProperty(this,"_locale",{value:this._resolveLocale(e)}),o.defineProperty(this,"_options",{value:{style:this._resolveStyle(t.style),units:this._isValidUnits(t.units)&&t.units}}),o.defineProperty(this,"_locales",{value:e}),o.defineProperty(this,"_fields",{value:this._findFields(this._locale)}),o.defineProperty(this,"_messages",{value:o.objCreate(null)});var n=this;this.format=function(e,t){return n._format(e,t)}}var r=n(281),a=n(294),o=n(295);t["default"]=i;var s=["second","minute","hour","day","month","year"],l=["best fit","numeric"];o.defineProperty(i,"__localeData__",{value:o.objCreate(null)}),o.defineProperty(i,"__addLocaleData",{value:function(e){if(!e||!e.locale)throw new Error("Locale data provided to IntlRelativeFormat is missing a `locale` property value");i.__localeData__[e.locale.toLowerCase()]=e,r["default"].__addLocaleData(e)}}),o.defineProperty(i,"defaultLocale",{enumerable:!0,writable:!0,value:void 0}),o.defineProperty(i,"thresholds",{enumerable:!0,value:{second:45,minute:45,hour:22,day:26,month:11}}),i.prototype.resolvedOptions=function(){return{locale:this._locale,style:this._options.style,units:this._options.units}},i.prototype._compileMessage=function(e){var t,n=this._locales,i=(this._locale,this._fields[e]),a=i.relativeTime,o="",s="";for(t in a.future)a.future.hasOwnProperty(t)&&(o+=" "+t+" {"+a.future[t].replace("{0}","#")+"}");for(t in a.past)a.past.hasOwnProperty(t)&&(s+=" "+t+" {"+a.past[t].replace("{0}","#")+"}");var l="{when, select, future {{0, plural, "+o+"}}past {{0, plural, "+s+"}}}";return new r["default"](l,n)},i.prototype._getMessage=function(e){var t=this._messages;return t[e]||(t[e]=this._compileMessage(e)),t[e]},i.prototype._getRelativeUnits=function(e,t){var n=this._fields[t];return n.relative?n.relative[e]:void 0},i.prototype._findFields=function(e){for(var t=i.__localeData__,n=t[e.toLowerCase()];n;){if(n.fields)return n.fields;n=n.parentLocale&&t[n.parentLocale.toLowerCase()]}throw new Error("Locale data added to IntlRelativeFormat is missing `fields` for :"+e)},i.prototype._format=function(e,t){var n=t&&void 0!==t.now?t.now:o.dateNow();if(void 0===e&&(e=n),!isFinite(n))throw new RangeError("The `now` option provided to IntlRelativeFormat#format() is not in valid range.");if(!isFinite(e))throw new RangeError("The date value provided to IntlRelativeFormat#format() is not in valid range.");var i=a["default"](n,e),r=this._options.units||this._selectUnits(i),s=i[r];if("numeric"!==this._options.style){var l=this._getRelativeUnits(s,r);if(l)return l}return this._getMessage(r).format({0:Math.abs(s),when:0>s?"past":"future"})},i.prototype._isValidUnits=function(e){if(!e||o.arrIndexOf.call(s,e)>=0)return!0;if("string"==typeof e){var t=/s$/.test(e)&&e.substr(0,e.length-1);if(t&&o.arrIndexOf.call(s,t)>=0)throw new Error('"'+e+'" is not a valid IntlRelativeFormat `units` value, did you mean: '+t)}throw new Error('"'+e+'" is not a valid IntlRelativeFormat `units` value, it must be one of: "'+s.join('", "')+'"')},i.prototype._resolveLocale=function(e){"string"==typeof e&&(e=[e]),e=(e||[]).concat(i.defaultLocale);var t,n,r,a,o=i.__localeData__;for(t=0,n=e.length;n>t;t+=1)for(r=e[t].toLowerCase().split("-");r.length;){if(a=o[r.join("-")])return a.locale;r.pop()}var s=e.pop();throw new Error("No locale data has been added to IntlRelativeFormat for: "+e.join(", ")+", or the default locale: "+s)},i.prototype._resolveStyle=function(e){if(!e)return l[0];if(o.arrIndexOf.call(l,e)>=0)return e;throw new Error('"'+e+'" is not a valid IntlRelativeFormat `style` value, it must be one of: "'+l.join('", "')+'"')},i.prototype._selectUnits=function(e){var t,n,r;for(t=0,n=s.length;n>t&&(r=s[t],!(Math.abs(e[r])<i.thresholds[r]));t+=1);return r}},function(e,t){"use strict";function n(e){return 400*e/146097}var i=Math.round;t["default"]=function(e,t){e=+e,t=+t;var r=i(t-e),a=i(r/1e3),o=i(a/60),s=i(o/60),l=i(s/24),c=i(l/7),u=n(l),d=i(12*u),h=i(u);return{millisecond:r,second:a,minute:o,hour:s,day:l,week:c,month:d,year:h}}},function(e,t){"use strict";var n=Object.prototype.hasOwnProperty,i=Object.prototype.toString,r=function(){try{return!!Object.defineProperty({},"a",{})}catch(e){return!1}}(),a=(!r&&!Object.prototype.__defineGetter__,r?Object.defineProperty:function(e,t,i){"get"in i&&e.__defineGetter__?e.__defineGetter__(t,i.get):(!n.call(e,t)||"value"in i)&&(e[t]=i.value)}),o=Object.create||function(e,t){function i(){}var r,o;i.prototype=e,r=new i;for(o in t)n.call(t,o)&&a(r,o,t[o]);return r},s=Array.prototype.indexOf||function(e,t){var n=this;if(!n.length)return-1;for(var i=t||0,r=n.length;r>i;i++)if(n[i]===e)return i;return-1},l=Array.isArray||function(e){return"[object Array]"===i.call(e)},c=Date.now||function(){return(new Date).getTime()};t.defineProperty=a,t.objCreate=o,t.arrIndexOf=s,t.isArray=l,t.dateNow=c},function(e,t){"use strict";t["default"]={locale:"en",pluralRuleFunction:function(e,t){var n=String(e).split("."),i=!n[1],r=Number(n[0])==e,a=r&&n[0].slice(-1),o=r&&n[0].slice(-2);return t?1==a&&11!=o?"one":2==a&&12!=o?"two":3==a&&13!=o?"few":"other":1==e&&i?"one":"other"},fields:{year:{displayName:"Year",relative:{0:"this year",1:"next year","-1":"last year"},relativeTime:{future:{one:"in {0} year",other:"in {0} years"},past:{one:"{0} year ago",other:"{0} years ago"}}},month:{displayName:"Month",relative:{0:"this month",1:"next month","-1":"last month"},relativeTime:{future:{one:"in {0} month",other:"in {0} months"},past:{one:"{0} month ago",other:"{0} months ago"}}},day:{displayName:"Day",relative:{0:"today",1:"tomorrow","-1":"yesterday"},relativeTime:{future:{one:"in {0} day",other:"in {0} days"},past:{one:"{0} day ago",other:"{0} days ago"}}},hour:{displayName:"Hour",relativeTime:{future:{one:"in {0} hour",other:"in {0} hours"},past:{one:"{0} hour ago",other:"{0} hours ago"}}},minute:{displayName:"Minute",relativeTime:{future:{one:"in {0} minute",other:"in {0} minutes"},past:{one:"{0} minute ago",other:"{0} minutes ago"}}},second:{displayName:"Second",relative:{0:"now"},relativeTime:{future:{one:"in {0} second",other:"in {0} seconds"},past:{one:"{0} second ago",other:"{0} seconds ago"}}}}}},function(e,t){},function(e,t){"use strict";t["default"]={locale:"en",pluralRuleFunction:function(e,t){var n=String(e).split("."),i=!n[1],r=Number(n[0])==e,a=r&&n[0].slice(-1),o=r&&n[0].slice(-2);return t?1==a&&11!=o?"one":2==a&&12!=o?"two":3==a&&13!=o?"few":"other":1==e&&i?"one":"other"},fields:{year:{displayName:"Year",relative:{0:"this year",1:"next year","-1":"last year"},relativeTime:{future:{one:"in {0} year",other:"in {0} years"},past:{one:"{0} year ago",other:"{0} years ago"}}},month:{displayName:"Month",relative:{0:"this month",1:"next month","-1":"last month"},relativeTime:{future:{one:"in {0} month",other:"in {0} months"},past:{one:"{0} month ago",other:"{0} months ago"}}},day:{displayName:"Day",relative:{0:"today",1:"tomorrow","-1":"yesterday"},relativeTime:{future:{one:"in {0} day",other:"in {0} days"},past:{one:"{0} day ago",other:"{0} days ago"}}},hour:{displayName:"Hour",relativeTime:{future:{one:"in {0} hour",other:"in {0} hours"},past:{one:"{0} hour ago",other:"{0} hours ago"}}},minute:{displayName:"Minute",relativeTime:{future:{one:"in {0} minute",other:"in {0} minutes"},past:{one:"{0} minute ago",other:"{0} minutes ago"}}},second:{displayName:"Second",relative:{0:"now"},relativeTime:{future:{one:"in {0} second",other:"in {0} seconds"},past:{one:"{0} second ago",other:"{0} seconds ago"}}}}}},function(e,t,n){"use strict";function i(e,t){if(!isFinite(e))throw new TypeError(t)}var r=n(300),a=n(281),o=n(291),s=n(301),l={locales:r["default"].PropTypes.oneOfType([r["default"].PropTypes.string,r["default"].PropTypes.array]),formats:r["default"].PropTypes.object,messages:r["default"].PropTypes.object};t["default"]={statics:{filterFormatOptions:function(e,t){return t||(t={}),(this.formatOptions||[]).reduce(function(n,i){return e.hasOwnProperty(i)?n[i]=e[i]:t.hasOwnProperty(i)&&(n[i]=t[i]),n},{})}},propTypes:l,contextTypes:l,childContextTypes:l,getNumberFormat:s["default"](Intl.NumberFormat),getDateTimeFormat:s["default"](Intl.DateTimeFormat),getMessageFormat:s["default"](a["default"]),getRelativeFormat:s["default"](o["default"]),getChildContext:function(){var e=this.context,t=this.props;return{locales:t.locales||e.locales,formats:t.formats||e.formats,messages:t.messages||e.messages}},formatDate:function(e,t){return e=new Date(e),i(e,"A date or timestamp must be provided to formatDate()"),this._format("date",e,t)},formatTime:function(e,t){return e=new Date(e),i(e,"A date or timestamp must be provided to formatTime()"),this._format("time",e,t)},formatRelative:function(e,t,n){return e=new Date(e),i(e,"A date or timestamp must be provided to formatRelative()"),this._format("relative",e,t,n)},formatNumber:function(e,t){return this._format("number",e,t)},formatMessage:function(e,t){var n=this.props.locales||this.context.locales,i=this.props.formats||this.context.formats;return"function"==typeof e?e(t):("string"==typeof e&&(e=this.getMessageFormat(e,n,i)),e.format(t))},getIntlMessage:function(e){var t,n=this.props.messages||this.context.messages,i=e.split(".");try{t=i.reduce(function(e,t){return e[t]},n)}finally{if(void 0===t)throw new ReferenceError("Could not find Intl message: "+e)}return t},getNamedFormat:function(e,t){var n=this.props.formats||this.context.formats,i=null;try{i=n[e][t]}finally{if(!i)throw new ReferenceError("No "+e+" format named: "+t)}return i},_format:function(e,t,n,i){var r=this.props.locales||this.context.locales;switch(n&&"string"==typeof n&&(n=this.getNamedFormat(e,n)),e){case"date":case"time":return this.getDateTimeFormat(r,n).format(t);case"number":return this.getNumberFormat(r,n).format(t);case"relative":return this.getRelativeFormat(r,n).format(t,i);default:throw new Error("Unrecognized format type: "+e)}}}},function(e,t){"use strict";t["default"]=React},function(e,t,n){"use strict";t=e.exports=n(302)["default"],t["default"]=t},function(e,t,n){"use strict";function i(e){var t=o.objCreate(null);return function(){var n=Array.prototype.slice.call(arguments),i=r(n),a=i&&t[i];return a||(a=o.objCreate(e.prototype),e.apply(a,n),i&&(t[i]=a)),a}}function r(e){if("undefined"!=typeof JSON){var t,n,i,r=[];for(t=0,n=e.length;n>t;t+=1)i=e[t],i&&"object"==typeof i?r.push(a(i)):r.push(i);return JSON.stringify(r)}}function a(e){var t,n,i,r,a=[],o=[];for(t in e)e.hasOwnProperty(t)&&o.push(t);var s=o.sort();for(n=0,i=s.length;i>n;n+=1)t=s[n],r={},r[t]=e[t],a[n]=r;return a}var o=n(303);t["default"]=i},function(e,t){"use strict";var n=Object.prototype.hasOwnProperty,i=function(){try{return!!Object.defineProperty({},"a",{})}catch(e){return!1}}(),r=(!i&&!Object.prototype.__defineGetter__,i?Object.defineProperty:function(e,t,i){"get"in i&&e.__defineGetter__?e.__defineGetter__(t,i.get):(!n.call(e,t)||"value"in i)&&(e[t]=i.value)}),a=Object.create||function(e,t){function i(){}var a,o;i.prototype=e,a=new i;for(o in t)n.call(t,o)&&r(a,o,t[o]);return a};t.defineProperty=r,t.objCreate=a},function(e,t,n){"use strict";var i=n(300),r=n(299),a=i["default"].createClass({displayName:"FormattedDate",mixins:[r["default"]],statics:{formatOptions:["localeMatcher","timeZone","hour12","formatMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName"]},propTypes:{format:i["default"].PropTypes.string,value:i["default"].PropTypes.any.isRequired},render:function(){var e=this.props,t=e.value,n=e.format,r=n&&this.getNamedFormat("date",n),o=a.filterFormatOptions(e,r);return i["default"].DOM.span(null,this.formatDate(t,o))}});t["default"]=a},function(e,t,n){"use strict";var i=n(300),r=n(299),a=i["default"].createClass({displayName:"FormattedTime",mixins:[r["default"]],statics:{formatOptions:["localeMatcher","timeZone","hour12","formatMatcher","weekday","era","year","month","day","hour","minute","second","timeZoneName"]},propTypes:{format:i["default"].PropTypes.string,value:i["default"].PropTypes.any.isRequired},render:function(){var e=this.props,t=e.value,n=e.format,r=n&&this.getNamedFormat("time",n),o=a.filterFormatOptions(e,r);return i["default"].DOM.span(null,this.formatTime(t,o))}});t["default"]=a},function(e,t,n){"use strict";var i=n(300),r=n(299),a=i["default"].createClass({displayName:"FormattedRelative",mixins:[r["default"]],statics:{formatOptions:["style","units"]},propTypes:{format:i["default"].PropTypes.string,value:i["default"].PropTypes.any.isRequired,now:i["default"].PropTypes.any},render:function(){var e=this.props,t=e.value,n=e.format,r=n&&this.getNamedFormat("relative",n),o=a.filterFormatOptions(e,r),s=this.formatRelative(t,o,{now:e.now});return i["default"].DOM.span(null,s)}});t["default"]=a},function(e,t,n){"use strict";var i=n(300),r=n(299),a=i["default"].createClass({displayName:"FormattedNumber",mixins:[r["default"]],statics:{formatOptions:["localeMatcher","style","currency","currencyDisplay","useGrouping","minimumIntegerDigits","minimumFractionDigits","maximumFractionDigits","minimumSignificantDigits","maximumSignificantDigits"]},propTypes:{format:i["default"].PropTypes.string,value:i["default"].PropTypes.any.isRequired},render:function(){var e=this.props,t=e.value,n=e.format,r=n&&this.getNamedFormat("number",n),o=a.filterFormatOptions(e,r);return i["default"].DOM.span(null,this.formatNumber(t,o))}});t["default"]=a},function(e,t,n){"use strict";var i=n(300),r=n(299),a=i["default"].createClass({displayName:"FormattedMessage",mixins:[r["default"]],propTypes:{tagName:i["default"].PropTypes.string,message:i["default"].PropTypes.string.isRequired},getDefaultProps:function(){return{tagName:"span"}},render:function(){var e=this.props,t=e.tagName,n=e.message,r=Math.floor(1099511627776*Math.random()).toString(16),a=new RegExp("(@__ELEMENT-"+r+"-\\d+__@)","g"),o={},s=function(){var e=0;return function(){return"@__ELEMENT-"+r+"-"+(e+=1)+"__@"}}(),l=Object.keys(e).reduce(function(t,n){var r,a=e[n];return i["default"].isValidElement(a)?(r=s(),t[n]=r,o[r]=a):t[n]=a,t},{}),c=this.formatMessage(n,l),u=c.split(a).filter(function(e){return!!e}).map(function(e){return o[e]||e}),d=[t,null].concat(u);return i["default"].createElement.apply(null,d)}});t["default"]=a},function(e,t,n){"use strict";var i=n(300),r=n(310),a=n(299),o=i["default"].createClass({displayName:"FormattedHTMLMessage",mixins:[a["default"]],propTypes:{tagName:i["default"].PropTypes.string,message:i["default"].PropTypes.string.isRequired},getDefaultProps:function(){return{tagName:"span"}},render:function(){var e=this.props,t=e.tagName,n=e.message,a=Object.keys(e).reduce(function(t,n){var a=e[n];return"string"==typeof a?a=r["default"](a):i["default"].isValidElement(a)&&(a=i["default"].renderToStaticMarkup(a)),t[n]=a,t},{});return i["default"].DOM[t]({dangerouslySetInnerHTML:{__html:this.formatMessage(n,a)}})}});t["default"]=o},function(e,t){"use strict";var n={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},i=/[&><"']/g;t["default"]=function(e){return(""+e).replace(i,function(e){return n[e]})}},function(e,t){},,,,,,,,,function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/listFrictionLessBankLogin"},parse:function(e){return e.data.bankLogin.authentication_questions&&(e.data=e.data.bankLogin.authentication_questions),e}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,,,,function(e,t,n){var i,r;i=[n(3),n(224),n(229),n(223),n(260),n(242),n(329),n(331),n(332),n(275),n(261)],r=function(e,t,i,r,a,o,s,l,c,u,d){"use strict";return i.extend({events:{"click .acceptAuthorizationSubmit":"acceptDirectDebitAuthorization","touchstart .acceptAuthorizationSubmit":"acceptDirectDebitAuthorization","click .acceptAuthorizationSkip":"skipDirectDebitAuthorization","click .deleteAuthorization":"deleteDirectDebitAuthorization","click .linkToPrint a, a.linkToPrint":"doPrint","change #termsCB":"toggleSubmit"},initialize:function(){this.alertView=this.alertView||new a,this.alertMsg=this.alertMsg||new o},afterRender:function(){this.$(".ppCheckbox").checkbox()},acceptDirectDebitAuthorization:function(e){e.preventDefault(),r.trigger("toggleLoading",!0),this.model.url=r.history.options.root+"wallet/completeAuthorization",this.listenToOnce(this.model,"sync",this.acceptSuccess),this.listenToOnce(this.model,"error",this.submitError),this.model.save()},skipDirectDebitAuthorization:function(e){var t=this.model.get("agreementType"),n={ddi:!0,dda:!0,ddi_BR:!0};e.preventDefault(),n[t]?this.alertView.showAlert("confirmSkipDDI",function(){this.acceptSuccess()}.bind(this)):this.acceptSuccess()},deleteDirectDebitAuthorizationConfirmed:function(){r.trigger("toggleLoading",!0),this.model.url=r.history.options.root+"wallet/revokeAuthorization",this.model.save(),this.listenToOnce(this.model,"sync",this.deleteSuccess),this.listenToOnce(this.model,"error",this.submitError)},showCodeConfirmBankView:function(){this.addBankCodeConfirmBankView?this.addBankCodeConfirmBankView.model=this.model:this.addBankCodeConfirmBankView=new c({model:this.model}),this.addBankCodeConfirmBankView.setElement(this.$el).render()},showDepositConfirmBankView:function(){this.addBankDepositConfirmBankView?this.addBankDepositConfirmBankView.model=this.model:this.addBankDepositConfirmBankView=new l({model:this.model}),this.addBankDepositConfirmBankView.setElement(this.$el).render()},showAddBankConfirmBankView:function(){this.addBankConfirmBankView?this.addBankConfirmBankView.model=this.model:this.addBankConfirmBankView=new s({model:this.model}),this.addBankConfirmBankView.setElement(this.$el).render()},acceptSuccess:function(e,t){var n=this.model.get("confirmationMethod"),i=this.model.get("state"),a=d.isTreatment("GB_8ball_wallet_PADportlet_testvariant1_autoenrollPAD")||d.isTreatment("GB_8ball_wallet_PADportlet_testvariant2_PADoptin");return r.trigger("toggleLoading",!1),this.parentView&&this.parentView.skipBankConfirm?void this.parentView.doCustomAction():(t?r.trigger("updateAuthState",t.data.fiId,t.authDetails.authStatus):r.trigger("updateAuthState",this.model.get("fiId"),"unauthorized"),void("bankDetail"===this.model.get("fromPage")?a&&"confirmed"===i?this.showSuccessPage(t):this.parentView.render():"double-deposit"===n?"confirmed"===this.model.get("state")?a?this.showSuccessPage(t):this.parentView.render():this.showDepositConfirmBankView():"paypal-code"===n&&("initiate_confirmation"===i?this.showAddBankConfirmBankView():this.showCodeConfirmBankView())))},deleteSuccess:function(e,t){r.trigger("updateAuthState",t.data.fiId,t.authDetails.authStatus),r.trigger("toggleLoading",!1),this.parentView&&this.parentView.render()},submitError:function(e,t,n){r.trigger("toggleLoading",!1),this.showServiceErrorMsg(n)},removeServiceErrorMsg:function(){this.$(".alertMsg").remove()},showServiceErrorMsg:function(e){this.removeServiceErrorMsg(),this.alertMsg=this.alertMsg||new o,this.$el.find(".overpanel-header").after(this.alertMsg.setMessage(e).el)},deleteDirectDebitAuthorization:function(e){e.preventDefault(),this.alertView.showAlert("deleteAuthorizationConfirm",this.deleteDirectDebitAuthorizationConfirmed.bind(this))},doPrint:function(t){t.preventDefault(),n.e(2,function(t){var n=[t(333)];(function(t){var n=new t;n.model=new r.Model,n.model.set({layout:!1,pageTitle:e("title").text(),bodyContent:e(".mandateText").html()}),n.render()}).apply(null,n)})},toggleSubmit:function(e){var t=this.$(e.currentTarget).prop("checked");this.$(".acceptAuthorizationSubmit").prop("disabled",!t)},showSuccessPage:function(e){this.linkBankSuccessView=this.linkBankSuccessView||new u({model:new r.Model({data:{manualBankConfirmation:!0,pad:e.pad,fiId:this.model.get("fiId")}})}),this.linkBankSuccessView.setElement(this.$el).render(),r.trigger("trackLink",null,"linkBankSuccess","main:walletweb:wallet:add:bank:rdsuccess")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(223),n(241),n(228),n(242),n(320),n(330),n(275),n(261)],r=function(e,t,n,i,r,a,o,s,l){"use strict";return e.extend({template:"wallet/overpanel/bank/addBankConfirmBank",initialize:function(){this.listenTo(t,"mfaAddConfirmtimeOut",this.MFAtimeOut),this.listenTo(t,"addConfirminvalidMFA",this.confirminvalidMFACase),this.listenTo(t,"fabAddConfirmBankFlowFailure",this.errorFrictionlessLogin),this.listenTo(t,"fabAddconfirmLater",this.confirmLater),this.alertMsg=new r},events:{"click .addBankConfirmBank .confirmLater":"pendingConfirmBank","click .confirmCodeNow":"confirmCodeNow","click .showLogin":"showFABLoginPage","click .paypal-code .confirmCodeLater":"confirmCodeLater"},confirmCodeLater:function(e){e.preventDefault(),t.trigger("closeAddBankOverpanel")},confirmCodeNow:function(e){t.trigger("toggleLoading",!0),e.preventDefault();var n=this.model.get("fiId"),i=new o({fiId:n});this.listenToOnce(i,"sync",this.submitSuccess),this.listenToOnce(i,"error",this.submitError),i.save({currency:this.model.get("currency"),numericCode:this.$('input[name="bankCode"]').val()})},removeServiceErrorMsg:function(){this.$(".alertMsg").remove()},showServiceErrorMsg:function(e){this.removeServiceErrorMsg(),this.$el.find(".overpanel-header").after(this.alertMsg.setMessage(e).el)},pendingConfirmBank:function(e){var n=this.model.get("fiId")||this.model.get("data")&&this.model.get("data").BANK&&this.model.get("data").BANK.fiId,i=this.model.get("confirmationMethod")||"double-deposit";"paypal-code"===i&&(i="numeric-code"),e.preventDefault(),t.trigger("toggleLoading",!0),this.pendingConfirmBankModel=this.pendingConfirmBankModel||new t.Model({fiId:n}),this.pendingConfirmBankModel.url=t.history.options.root+"wallet/banks/"+n+"/initiate-confirmation/"+i,this.listenToOnce(this.pendingConfirmBankModel,"sync",this.submitSuccess),this.listenToOnce(this.pendingConfirmBankModel,"error",this.submitError),this.pendingConfirmBankModel.save()},afterRender:function(){this.formView=new n({el:"form[name=later]"}),this.$("input").prop("disabled",!1)},submitSuccess:function(e,n){var i=n.data.state||n.data.bank&&n.data.bank.state,r=n.data.authStatus||n.data.bank&&n.data.bank.authStatus;t.trigger("toggleLoading",!1),t.trigger("updateBankState",n.data.fiId,i),"authorized"===r&&(l.isTreatment("GB_8ball_wallet_PADportlet_testvariant1_autoenrollPAD")||l.isTreatment("GB_8ball_wallet_PADportlet_testvariant2_PADoptin"))?(this.linkBankSuccessView=this.linkBankSuccessView||new s({model:new t.Model({data:{manualBankConfirmation:!0,pad:n.pad,fiId:this.model.get("fiId")}})}),this.linkBankSuccessView.setElement(this.$el).render(),t.trigger("trackLink",null,"linkBankSuccess","main:walletweb:wallet:add:bank:rdsuccess")):t.trigger("closeAddBankOverpanel")},submitError:function(e,n,i){var r=n.error&&n.error.code;r&&"4054"===r&&(t.trigger("removeBankAndRenderBanks",this.model),this.$("input").prop("disabled",!0)),this.toggleLoading(!1),this.formView.showError(i)},showFABLoginPage:function(e){var n=this.model.get("eligibility");e&&e.preventDefault(),t.trigger("toggleLoading",!0),this.frictionLessBankLoginModel=new a,this.listenTo(this.frictionLessBankLoginModel,"sync",this.successFrictionlessLogin),this.listenToOnce(this.frictionLessBankLoginModel,"error",this.errorFrictionlessLogin),this.frictionLessBankLoginModel.fetch({data:{id:n.institution_id}})},MFAtimeOut:function(){t.trigger("toggleLoading",!0),this.timeout=!0,this.invalidMFA=!1,this.showFABLoginPage()},confirminvalidMFACase:function(){this.invalidMFA=!0,this.timeout=!1,this.showFABLoginPage()},successFrictionlessLogin:function(){var e=this.model.get("eligibility"),n={bankClassName:"generic",id:e.institution_id,institution_name:e.institution_name,yodleeEligiblity:!0},i=e.institution_id,r=this.frictionLessBankLoginModel.get("data"),a="fabConfirmBankFlow",o=this.dividerData(r);this.loginModel=new t.Model,this.loginModel.set({generic:!0,loginData:r,id:i,bankDetail:n,confirmType:a,MFAtimeOut:this.timeout||!1,invalidMFA:this.invalidMFA||!1,flowType:"fabAddConfirmBankFlow",divider:o}),t.trigger("toggleLoading",!1),t.trigger("fabLoginView",this.loginModel)},dividerData:function(e){var t,n=e&&e.constraints&&e.constraints[0]&&e.constraints[0].properties,i=[];for(n=n||[],t=0;t<n.length-1;t++)i.push(n[t]);return i},confirmLater:function(){this.render()},errorFrictionlessLogin:function(e,n){if(t.trigger("toggleLoading",!1),n){var i=n.error&&n.error.message,r=n.error&&n.error.code;"90008"===r?(this.model.set({fabConfirmBankFlowFailure:!0}),this.render()):this.showServiceErrorMsg(i)}else this.model.set({fabConfirmBankFlowFailure:!0}),this.render()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/banks/"+this.get("fiId")+"/complete-confirmation/numeric-code"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(223)],r=function(e,t){"use strict";return e.extend({template:"wallet/overpanel/bank/addBankDepositConfirmBank",events:{"click .addBankDepositConfirmBank .confirmLater":"exitAddBank"},exitAddBank:function(e){e.preventDefault(),t.trigger("closeAddBankOverpanel")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(223)],r=function(e,t){"use strict";return e.extend({template:"wallet/overpanel/bank/addBankCodeConfirmBank",events:{"click .confirmCodeNow":"confirmCodeNow","click .confirmCodeLater":"confirmCodeLater"},confirmCodeNow:function(e){t.trigger("toggleLoading",!0),e.preventDefault();var n=this.model.get("fiId");this.confirmCodeNowkModel=this.confirmCodeNowkModel||new t.Model({fiId:n}),this.confirmCodeNowkModel.url=t.history.options.root+"wallet/banks/"+n+"/complete-confirmation/numeric-code",this.listenToOnce(this.confirmCodeNowkModel,"sync",this.submitSuccess),this.listenToOnce(this.confirmCodeNowkModel,"error",this.submitError),this.confirmCodeNowkModel.save({numericCode:this.$('input[name="bankCode"]').val()})},confirmCodeLater:function(e){e.preventDefault(),t.trigger("closeAddBankOverpanel")},submitSuccess:function(){t.trigger("toggleLoading",!1),t.trigger("updateBankState",this.model.get("fiId"),"ready_to_use"),t.trigger("closeAddBankOverpanel")},submitError:function(e,n,i){t.trigger("toggleLoading",!1),this.showServiceErrorMsg(i)},removeServiceErrorMsg:function(){this.$(".alertMsg").remove()},showServiceErrorMsg:function(e){this.removeServiceErrorMsg(),this.$el.find(".overpanel-header").after(this.alertMsg.setMessage(e).el)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({idAttribute:"fiId",urlRoot:function(){return e.history.options.root+"wallet/viewAuthorization"},parse:function(e){var t={};return"undefined"!=typeof e.authDetails&&(t=e.authDetails,"undefined"!=typeof t.BANK&&(t.bankDetails=t.BANK,delete t.BANK)),e.authorizationMethod&&(t.authorizationMethod=e.authorizationMethod),t}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,,function(e,t,n){var i,r;i=[n(3),n(224),n(223),n(229),n(261),n(245),n(228),n(250),n(342),n(343),n(344),n(345),n(346),n(347),n(341),n(329),n(348),n(349),n(328),n(275),n(350),n(334),n(351),n(242),n(241),n(272),n(244)],r=function(e,t,n,i,r,a,o,s,l,c,u,d,h,p,f,m,g,v,y,w,b,k,C,_,D){"use strict";return i.extend({template:"wallet/overpanel/bank/addBank",events:{"change .bankType.vx_btn-group input":"toggleCheck",'change [name="country"]':"changeCountry","change #accountType":"changeAccountType","change #hasPatronymicName":"togglePatronymicName","change .showHideInstructions .radio":"showDynamicInstructions","change #otherBankName":"showDynamicInstructions","select #bankName":"showDynamicInstructions","change #dynamicBankName":"changeDynamicBankName","change #bankNameDrop":"handleBankOption","focusout #bankName":"handleBankName","focusin #routingNum, #routingNum2, #accountNum":"routingAccountNumberFocusHandler","focusout #routingNum, #routingNum2, #accountNum":"routingAccountNumberFocusHandler","focusout #iban":"getCountryName","focusout .taxIdentifier input":"formatTaxIdFocusOut","keydown #routingNum, #accountNum":"hasTyped","keydown .taxIdentifier input":"formatTaxIdentifier",'change [name="accountType"]':"changeValidationRule","click .toggleElement":"toggleElements",'submit form[name="bankInfo"]':"saveBankInfo","click .findYourBank":"openSearchBankOverPanel","click .js_toggleIFSC":"toggleIfsc","change #js_bankList":"getStateList","change #js_stateList":"getCityList","change #js_cityList":"getBranchLocationsList","change #js_bankLocationList":"setIfscCode"},patterns:{custom:"[0-9]{11,14}",bankgiro:"[0-9]{7,8}",plusgiro:"[0-9]{2,8}"},errorMessages:{custom:"#accountNumberError",bankgiro:"#bankGiroError",plusgiro:"#plusGiroError",checking:"#accountNumberError",savings:"#accountNumberError"},initialize:function(){var t=this.getAgreementType();this.views=[],this.alertMsg=this.alertMsg||new _,this.model.set("accountType","checking"),this.addBankEntry=this.addBankEntry||new v({model:this.model}),this.bankSpecs=this.model.get("bankSpecs"),this.randomDeposits=this.model.get("randomDeposits"),this.bankNameLookup=this.bankSpecs&&this.bankSpecs.bankNameLookup,t&&this.model.set("agreementType",t),this.listenTo(n,"inputValid",this.getBankName),this.listenTo(n,"addBank:render",e.proxy(this.renderThisPage,this)),this.listenTo(n,"addBank:renderNoFailure",e.proxy(this.renderWithoutError,this)),this.listenTo(this.model,"change:flow",this.addFlow),this.listenTo(this.model,"change:bankTemplateCountry",this.toggleCheckImage),this.listenTo(this.model,"change:addOtherBank",this.renderFields),this.saveBankInfoModel=this.saveBankInfoModel||new p,this.saveBankInfoModel.clear(),this.listenTo(this.saveBankInfoModel,"sync",this.checkReplaceBank),this.listenTo(this.saveBankInfoModel,"error",this.saveBankInfoError),this.linkBankSuccessModel=new n.Model,this.getBanksListModel=this.getBanksListModel||new c,this.listenTo(this.getBanksListModel,"sync",this.getBanksListSuccess),this.getStatesListModel=this.getStatesListModel||new u,this.listenTo(this.getStatesListModel,"sync",this.getStatesListSuccess),this.getCityListModel=this.getCityListModel||new d,this.listenTo(this.getCityListModel,"sync",this.getCityListSuccess),this.getBranchLocationsListModel=this.getBranchLocationsListModel||new h,this.listenTo(this.getBranchLocationsListModel,"sync",this.getBankLocationsListSuccess)},addFlow:function(){if("addFunds"===this.model.get("flow")){var e=this.model.get("addFundsSpecs"),t=e&&e.allowedCountries&&e.allowedCountries[0];t&&this.model.set("bankTemplateCountry",t),this.toggleRegionalContent(),this.$(".bankNameLabel").addClass("hide"),this.renderFields(),this.model.set("flow","")}},toggleIfsc:function(e){e.preventDefault();var t,i,r,a=!this.model.get("hasIfscCode");r=this.$("#accountNumber").val(),a||(this.getBanksListModel=this.getBanksListModel||new c,this.$('input[name="country"]')&&(i=this.$('input[name="country"]').val()),t={issuerCountry:i},this.getBanksListModel.save(t)),this.model.set("hasIfscCode",a),this.render(),r&&(this.$('[for="accountNumber"]').addClass("accessAid"),this.$("#accountNumber").val(r)),a||n.trigger("toggleLoading",!0)},getBanksListSuccess:function(t,i){var r=i.banksList,a=this.$("#js_bankList");a.removeAttr("disabled"),r.forEach(function(t){a.append(e("<option></option>").attr("value",t).text(t))}),n.trigger("toggleLoading",!1)},getStateList:function(){var e,t;this.setStateListToPrevState(),this.setCityListToPrevState(),this.setBranchLocationListToPrevState(),e=this.$("#js_bankList").find(":selected").val(),"-11"!==e&&(n.trigger("toggleLoading",!0),this.getStatesListModel=this.getStatesListModel||new u,t={issuerCountry:"IN",bankName:e},this.getStatesListModel.save(t))},getStatesListSuccess:function(t,i){var r=i.bankStates,a=this.$("#js_stateList");a.removeAttr("disabled"),r.forEach(function(t){a.append(e("<option></option>").attr("value",t).text(t))}),n.trigger("toggleLoading",!1)},getCityList:function(){var e,t,i;this.setCityListToPrevState(),this.setBranchLocationListToPrevState(),t=this.$("#js_stateList").find(":selected").val(),"-11"!==t&&(n.trigger("toggleLoading",!0),
e=this.$("#js_bankList").find(":selected").val(),this.getCityListModel=this.getCityListModel||new d,i={issuerCountry:"IN",bankName:e,stateName:t},this.getCityListModel.save(i))},getCityListSuccess:function(t,i){var r=i.citiesList,a=this.$("#js_cityList");a.removeAttr("disabled"),r.forEach(function(t){a.append(e("<option></option>").attr("value",t).text(t))}),n.trigger("toggleLoading",!1)},getBranchLocationsList:function(){var e,t,i,r;this.setBranchLocationListToPrevState(),i=this.$("#js_cityList").find(":selected").val(),"-11"!==i&&(n.trigger("toggleLoading",!0),e=this.$("#js_bankList").find(":selected").val(),t=this.$("#js_stateList").find(":selected").val(),this.getBranchLocationsListModel=this.getBranchLocationsListModel||new h,r={issuerCountry:"IN",bankName:e,stateName:t,cityName:i},this.getBranchLocationsListModel.save(r))},getBankLocationsListSuccess:function(t,i){var r=i.bankBulkDetails,a=this.$("#js_bankLocationList");a.removeAttr("disabled"),r.forEach(function(t){a.append(e("<option></option>").attr("value",t.sort_code).text(t.branch_location))}),n.trigger("toggleLoading",!1)},setStateListToPrevState:function(){this.$('#js_stateList option[value="-11"]').attr("selected","selected"),this.$("#js_stateList").attr("disabled","disabled"),this.$('#js_stateList option[value!="-11"]').remove()},setCityListToPrevState:function(){this.$('#js_cityList option[value="-11"]').attr("selected","selected"),this.$("#js_cityList").attr("disabled","disabled"),this.$('#js_cityList option[value!="-11"]').remove()},setBranchLocationListToPrevState:function(){this.$('#js_bankLocationList option[value="-11"]').attr("selected","selected"),this.$("#js_bankLocationList").attr("disabled","disabled"),this.$('#js_bankLocationList option[value!="-11"]').remove()},setIfscCode:function(){var e=this.$("#js_bankLocationList").find(":selected").val(),t=this.$("#js_bankList").find(":selected").val();this.model.set("bankCode",e),this.model.set("bankName",t)},toggleCheckImage:function(e,t){this.$el.find(".check").attr("class","check "+t)},togglePatronymicName:function(t){var n=e(t.currentTarget),i=this.$(".middleName"),r=i.find("input[type=text]");n.siblings("label").is(".checked")?(n.siblings("label").removeClass("checked"),i.removeClass("disabled"),r.removeProp("disabled")):(n.siblings("label").addClass("checked"),i.addClass("disabled"),r.siblings("label").removeClass("accessAid"),r.val(""),r.prop("disabled",!0))},routingAccountNumberFocusHandler:function(e){this.selectBankErrorMessage(e),this.highlightCheck(e)},toggleElements:function(t){var n=e(t.currentTarget).closest("[data-toggle-element]");t.preventDefault(),n.addClass("hide"),1===n.data("toggle-element")?n.next().removeClass("hide"):n.prev().removeClass("hide")},getAgreementType:function(){return this.model.get("bankSpecs")&&this.model.get("bankSpecs").agreement},getSkipConfirmation:function(){return this.model.get("bankSpecs")&&this.model.get("bankSpecs").skipConfirmation},getEntryFormType:function(){return this.model.get("bankSpecs")&&this.model.get("bankSpecs").entryForm&&this.model.get("bankSpecs").entryForm.type},beforeRender:function(){this.model.set("padExperimentation",r.isTreatment("8ball_wallet_fmx_PADaddbankflow_testvariant1_autoenrollPAD")||r.isTreatment("8ball_wallet_fmx_PADaddbankflow_testvariant2_PADoptin")||r.isTreatment("8ball_wallet_fmx_PADaddbankflow_testvariant3_PADoptin2")||r.isTreatment("GB_8ball_wallet_PADportlet_testvariant1_autoenrollPAD")||r.isTreatment("GB_8ball_wallet_PADportlet_testvariant2_PADoptin")),n.trigger("setReplaceBankPresent",this.model)},changeDynamicBankName:function(t){var n=e(t.target).find(":selected").val();this.$('input[name="bankName"]:hidden').val(n)},afterRender:function(){var t=this.$(".accountNumbers").data("banks");this.$(".textInput").lap().textField(),this.$(".selectDropdown").nativeDropdown(),this.$(".ppCheckbox").checkbox(),this.addBankformView=new D({el:'form[name="bankInfo"]',customRule:function(e){var t,n,i;return this.bankNameLookup===!1?!1:(t=this.$(".routingNum, .routingNumber"),n=this.$(".routingNum2, .routingNumber2"),i=this.$(".routingNum3, .routingNumber3"),(t.length>0&&(t.hasClass("hasError")||!t.find("input").val())||n.length>0&&(n.hasClass("hasError")||!n.find("input").val())||i.length>0&&(i.hasClass("hasError")||!i.find("input").val()))&&this.$(".bankNameLabel").addClass("hide"),e)}.bind(this),checkInput:e(e('input[name="routingNumber3"]').length>0?'input[name="routingNumber3"]':'input[name="routingNumber"]')}),!this.bankTypeAhead&&t&&(t=t.map(function(e){return{uuid:"string"==typeof e.$id?e.$id.replace("code",""):e.$id,itemValue:e.$elt}}),this.bankNameCollection=new f(t),this.bankTypeAhead=new C({collection:this.bankNameCollection,list:new n.Collection(t)}),this.listenTo(this.bankTypeAhead,"selectTypeAheadItem",this.selectedBankName),this.listenTo(this.bankTypeAhead,"deselectItem",this.deselectBank)),this.bankTypeAhead&&this.bankTypeAhead.setElement(this.$(".input-typeahead")).updateInputSource(this.$("#bankName")),this.model.get("bankSpecs").showVariationNumber&&this.listenTo(this.model,"change",this.showVariationNumberOrComplementNumber),n.trigger("toggleLoading",!1),this.$el.focus()},renderThisPage:function(){this.model=new n.Model({frictionlessFailure:!0}),o.setContent(this),this.render()},renderFields:function(){this.addBankEntry.setElement(".fields").render()},renderWithoutError:function(){o.setContent(this),this.render()},removeServiceErrorMsg:function(){this.$(".alertMsg").remove()},getCountryName:function(){var e,t,n,i=this.$("#iban").val(),r=this.$(".autoCountryName"),a={};t=r.data("countrynames"),t&&t.forEach(function(e){a[e.$id]=e.$elt}),i&&(e=i.substring(0,2),n=a[e],r&&r.html(n))},showServiceErrorMsg:function(e){this.removeServiceErrorMsg(),this.$el.find(".overpanel-header").after(this.alertMsg.setMessage(e).el)},selectedBankName:function(e){var t,n,i=this.bankNameCollection.findWhere({itemValue:e.value}),r=e.value.split("-"),a=/^\d{1,}\s{0,1}$/;this.bankTypeAhead.hideItems(!0).model.set("selectedItem",i),this.$("#bankName").val(e.value),r.length>1&&a.test(r[0])?(n=r.shift().trim(),t=r.join("-").trim()):r.length&&(t=r.join("-").trim()),this.model.set({bankCode:n||e.id,bankName:t}),this.handleBankName()},deselectBank:function(){this.model.unset("bankCode").unset("bankName")},handleBankName:function(t){var n,i=t?this.$(t.currentTarget).val():this.$("#bankName").val(),r=this.$(".bankCode");r&&(n=!i||!!this.model.get("bankCode"),r.toggleClass("hide",n),0===e(".input-typeahead").has("li").length&&e("#bankCode").focus())},toggleCheck:function(t){var n,i=e(t.currentTarget),r=this.$(".check"),a=i.attr("id");n="undefined"!==a&&a!==!1?i.attr("id"):i.attr("id"),i.siblings("label").removeClass("checked"),i.next().addClass("checked"),"checking"===n?r.removeClass("savings"):r.addClass("savings")},formatTaxIdentifier:function(t){if("BR"===this.model.get("countryCode")){var n=e(t.currentTarget),i=n.val(),r=i.length;3!==r&&7!==r||8===t.keyCode||(i+=".",n.val(i)),11===r&&8!==t.keyCode&&(i+="-",n.val(i))}},formatTaxIdFocusOut:function(e){if("BR"===this.model.get("countryCode")){var t=this.$(e.currentTarget),n=t.val(),i=n.length,r="",a="";if(11===i&&"number"==typeof i){for(r=n.toString();r.length>6;)a+=r.substr(0,3)+".",r=r.substr(3);a+=r.substr(0,3)+"-"+r.substr(3),t.val(a)}}},selectBankErrorMessage:function(t){var n,i=e(t.currentTarget),r=i.val(),a=this.$("#accountHelpTextDefault").text(),o=this.$('input[name="accountType"]:checked').val();/^[0-9]+$/.test(r)?r.length<parseInt(i.attr("maxlength"),10)&&("accountNum"===i.attr("id")?o&&(n=this.errorMessages[o],a=this.$(n).text()):a=this.$("#routingNumberError").text()):a=this.$("#accountHelpTextNumberOnly").text(),i.siblings(".help-error").text(a)},highlightCheck:function(e){var t=this.$(".check"),n="on"+e.currentTarget.id;t.length>0&&("focusin"===e.type?t.addClass(n):t.removeClass(n))},hasTyped:t.throttle(function(){window.s&&window.fpti&&(window.s.prop11="y",window.fpti.bfty="y")},3e3),getBankName:function(){var e,t,n=this.$('input[name="routingNumber"]').val(),i=this.$('input[name="routingNumber2"]').val(),r=this.$('input[name="routingNumber3"]').val(),a=this.$('.bankType input[type="radio"]:checked').val();this.$('input[name="country"]')&&(t=this.$('input[name="country"]:checked').val()),"HK"!==t&&"SG"!==t&&"JP"!==t&&(this.model.get("bankSpecs").autoWithdrawal&&(t="IN"),e={routingNumber:n,routingNumber2:i,routingNumber3:r,accountType:a,issuerCountry:t},this.getBankNameModel=this.getBankNameModel||new l,this.listenToOnce(this.getBankNameModel,"sync",this.getBankNameSuccess),this.getBankNameModel.save(e))},getBankNameSuccess:function(e,t){var n=t.bankName;this.removeServiceErrorMsg(),this.$(".bankNameLabel > span").text(n),this.$('input[name="bankName"]:hidden').val(n),this.$(".bankNameLabel").removeClass("hide")},getBankNameError:function(e,t,i){this.showServiceErrorMsg(i),this.$(".routingNum").addClass("hasError"),this.$(".bankNameLabel").addClass("hide"),n.trigger("trackError",{fieldId:"routingNum",message:i})},saveBankInfo:function(e){var t=this.$("#bankNameDrop option:selected");e.preventDefault(),this.saveBankInfoModel.clear(),n.trigger("toggleLoading",!0);var i=n.Syphon.serialize(this);this.model.get("bankCode")&&(i.routingNumber1=this.model.get("bankCode"),i.bankName=this.model.get("bankName")),t&&(i.routingNumber1=i.routingNumber1||t.data("bankcode"),"other"===t.val()&&(i.bankName=i.bankName||this.$("#otherBankName").val())),i&&i.taxIdentifier&&(i.taxIdentifier=i.taxIdentifier.replace(/\D/g,"")),i.accountNumber=i.variationNumber?i.variationNumber+i.accountNumber:i.accountNumber,i.accountNumber=i.complementNumber?i.accountNumber+i.complementNumber:i.accountNumber,i.accountNumber=i.digitNumber?i.accountNumber+i.digitNumber:i.accountNumber,this.saveBankInfoModel.save(i)},saveBankAfterAuthFlow:function(){this.toggleLoading(!0);var e,t,n=(window.location.search||"?").substr(1),i={};n.replace(/([^&=]+)=?([^&]*)(?:&+|$)/g,function(t,n,i){return"authflowpassed"===n?void(e=i):void 0}),t="true"===e?!0:!1,t?this.saveBankInfoModel.save({useDataFromSession:!0}):(i.confirmed=[],i.unConfirmed=[],this.linkBankSuccessModel.set({data:i,authfail:!0}),this.linkBankSuccessView=new w({model:this.linkBankSuccessModel}),this.toggleLoading(!1),o.setContent(this.linkBankSuccessView))},buildAgreementModel:function(e){var n,i=e.model&&e.model.attributes||e.BANK,r=e.data&&e.data.authDetails||{};return e.authDetails&&(e=t.extend(e.data,e.data.authDetails)),n=new k(e.data,{parse:!0}),n.set({presentation:i.presentation||"addBank",fiId:i.fiId,authorizationMethod:i.authorizationMethod,countryCode:i.countryCode,confirmationMethod:i.confirmationMethod,agreementType:e.agreementType||e.model&&e.model.get("agreementType"),state:i.state,iban:r.iban||i.iban,iban_last4:r.iban_last4||i.iban_last4,bankName:i.bankName,accountNumber:e.accountNumber,currency:i.currency}),e.parentView&&e.parentView.skipBankConfirm&&(this.parentView=e.parentView,n.set("viewContext","credit")),n},setupAgreementView:function(e,t){this.agreementView.template="wallet/overpanel/bank/agreement/"+t,this.agreementView.parentView=this,this.agreementView.alertMsg=this.alertMsg,this.agreementView.model=this.buildAgreementModel(e)},loadAgreementView:function(e){var t=this.getAgreementType();n.trigger("toggleLoading",!1),n.trigger("updateBankState",e.BANK.fiId,e.BANK.state),e.parentView=this,e.agreementType=t,e.accountNumber=this.saveBankInfoModel.get("accountNumber"),e.BANK.presentation="addBank",this.setupAgreementView(e,t),o.setContent(this.agreementView)},initBankConfirmation:function(e,t){var i,r;("ddi"===t||"sepa"===t||"dda"===t)&&(i=new n.Model({presentation:"addBank",fiId:e.BANK.fiId,authorizationMethod:e.BANK.authorizationMethod}),this.listenToOnce(i,"sync",this.initBankConfirm),r="double-deposit"===e.BANK.confirmationMethod?"/initiate-confirmation/double-deposit":"/initiate-confirmation/numeric-code",i.url=n.history.options.root+"wallet/banks/"+i.get("fiId")+r,i.save())},loadConfirmationView:function(e){var t=new n.Model({presentation:"addBank",fiId:e.data.BANK.fiId,currency:e.data.BANK.currency,currencySymbol:e.data.BANK.currencySymbol,authorizationMethod:e.data.BANK.authorizationMethod,confirmationMethod:e.data.BANK.confirmationMethod,eligibility:e.data.BANK.eligibility,randomDeposits:this.randomDeposits});this.addBankConfirmBankView?this.addBankConfirmBankView.model=t:this.addBankConfirmBankView=new m({model:t}),this.addBankConfirmBankView.setElement(this.$el).render()},checkReplaceBank:function(e,t){this.listenToOnce(n,"bankReplaced",this.saveBankInfoSuccess.bind(this,e,t)),n.trigger("replaceBank")},saveBankInfoSuccess:function(e,t,i){var r=this.getAgreementType(),a=this.model.get("bankSpecs"),o=a.confirmBeforeAuthorization,s=a.autoInitConfirm;if(t.BANK=t.data.BANK,r=t.BANK&&t.BANK.agreementType,n.trigger("toggleLoading",!1),n.trigger("addCards",t),i&&(t.replaceBankDeleteError=!0),"authorized"!==t.BANK.authStatus&&!o||"confirmed"===t.BANK.state)if(r&&"authorized"!==t.BANK.authStatus)this.loadAgreementView(t),s&&this.initBankConfirmation(t,r);else{if(this.skipBankConfirm)return void this.doCustomAction(t);if(this.getSkipConfirmation()||"not_supported"===t.BANK.authorizationMethod&&"not_supported"===t.BANK.confirmationMethod||"confirmed"===t.BANK.state)return n.trigger("toggleLoading",!1),n.trigger("updateBankState",t.BANK.fiId,t.BANK.state),void n.trigger("closeAddBankOverpanel");this.loadConfirmationView(t)}else this.loadConfirmationView(t)},saveBankInfoError:function(e,t,i){n.trigger("toggleLoading",!1),t.error.code&&"authRequired"===t.error.code?window.location=t.data.location:("1111"===t.error.code&&this.$(".accountNum").addClass("hasError"),n.trigger("trackError",{message:i,code:t.error.code}),this.showServiceErrorMsg(i))},initBankConfirm:function(e,t){n.trigger("toggleLoading",!1),n.trigger("updateBankState",t.data.fiId,t.data.state)},changeCountry:function(t){var n=e(t.target).val(),i=e(".vx_alert").length;"HK"!==n&&"SG"!==n||!i||this.$(".vx_alert").remove(),!n||n&&"-1"===n||(this.model.set("bankTemplateCountry",n),this.toggleRegionalContent(),this.$(".bankNameLabel").addClass("hide"),this.renderFields())},toggleRegionalContent:function(){var t=this.$el.find(".js_regionalContent"),n=this.model.get("bankTemplateCountry");t.each(function(t,i){var r=e(i);r.toggleClass("hide",!r.hasClass("js_regionalContent_"+n))})},changeAccountType:function(t){var n=e(t.target).find(":selected").val();!n||n&&"-1"===n||(this.model.set("accountType",n),this.addBankEntry.model.set("accountType",n),this.renderFields())},changeValidationRule:function(t){var n=e(t.currentTarget).val();this.model.set("accountType",n),this.$("#accountNum").attr("pattern",this.patterns[n]);var i=this.$(".accountNumberHelpText"),r=i.data(n+"Text");i.html(r)},handleBankOption:function(t){this.model.set("addOtherBank","other"===e(t.currentTarget).val())},showDynamicInstructions:function(){var e,t,n=this.$('input[name="accountType"]:checked').val(),i=this.$("#otherBankName"),r=i.val();i.length&&("others"!==r?(t=r.split("-"),e=t[0].trim(),this.$("#routingNumber1").val(e),this.$(".bankName, .variationNumber, .complementNumber .digitNumber").addClass("hide"),this.$(".textInput.accountNum").removeClass("pull-right pull-left"),"checking"===n?(this.$(".digitNumber").removeClass("hide"),this.$(".textInput.accountNum").addClass("pull-left floatingWidth")):(this.$(".digitNumber").addClass("hide"),this.$(".textInput.accountNum").removeClass("pull-left floatingWidth"))):this.showVariationNumberOrComplementNumber(),this.$('input[name="bankName"]').val(r),e!==a.wallet.bank.BRAZIL_CITIBANK&&e!==a.wallet.bank.HSBC&&e!==a.wallet.bank.SANTANDER||"checking"!==n?this.$(".dynamicInstructions").removeClass("hide"):this.$(".dynamicInstructions").addClass("hide"))},showVariationNumberOrComplementNumber:function(){var t,n,i,r=this.$('input[name="accountType"]:checked').val();this.$(".bankName").removeClass("hide"),t=this.$("#bankName").val(),n=t&&t.split("-"),i=n&&n[0].trim(),e("#routingNumber1").val(i),"001"===i&&"savings"===r?(this.$(".variationNumber").removeClass("hide"),this.$(".complementNumber, .digitNumber").addClass("hide"),this.$(".textInput.accountNum").addClass("pull-right floatingWidth")):i===a.wallet.bank.ITAU_UNIBANCO&&"savings"===r?(this.$(".complementNumber").removeClass("hide"),this.$(".variationNumber, .digitNumber").addClass("hide"),this.$(".textInput.accountNum").addClass("pull-left floatingWidth")):"checking"===r?(this.$(".digitNumber").removeClass("hide"),this.$(".textInput.accountNum").addClass("pull-left floatingWidth"),this.$(".variationNumber, .complementNumber").addClass("hide")):(this.$(".variationNumber, .complementNumber, .digitNumber").addClass("hide"),this.$(".textInput.accountNum").removeClass("pull-right floatingWidth pull-left")),this.$('input[name="bankName"]').val(t)},openSearchBankOverPanel:function(){var e=this.$(".searchBanksBR").data("banknames");this.model=new n.Model,this.model.set("bankNames",e),this.searchBankNameView||(this.searchBankNameView=new b({model:this.model})),this.searchBankNameView.setElement(this.$el).render()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Collection.extend({parse:function(e){this.reset(e)},searchList:function(e){return this.models.filter(function(t){var n=t.toJSON(),i=(n.itemValue||"").toLowerCase(),r=(n.itemSubValue||"").toLowerCase(),a=i.split(" ").concat(r.split(" "));e=e.toLowerCase();for(var o=0;o<a.length;o++)if(a[o]&&0===a[o].indexOf(e))return t})}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/getBankName"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/getBanksList/"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/getStatesList"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/getCitiesList"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/getBranchLocationsList"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/saveBankInfo"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(329),n(266)],r=function(e,t,n){"use strict";return e.extend({el:"#overpanel",template:"wallet/overpanel/bank/addBankChooseConfirmMethod",events:{"click .confirmBank":"goAddBankConfirmBankView","click .confirmYodlee":"goAddBankConfirmYodleeView"},goAddBankConfirmBankView:function(e){e.preventDefault(),this.addBankConfirmBankView||(this.addBankConfirmBankView=new t),this.addBankConfirmBankView.render()},goAddBankConfirmYodleeView:function(e){e.preventDefault(),this.addBankConfirmYodleeView?this.addBankConfirmYodleeView.model=this.model:this.addBankConfirmYodleeView=new n({model:this.model}),this.addBankConfirmYodleeView.alertMsg=this.alertMsg,this.addBankConfirmYodleeView.render()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(223),n(229),n(241)],r=function(e,t,n,i){"use strict";return n.extend({el:".fields",template:function(){return"wallet/overpanel/bank/entryForm/inc/fields_"+this.model.get("bankTemplateCountry")},afterRender:function(){this.$(".textInput").lap().textField(),this.$(".selectDropdown").nativeDropdown(),this.addBankFormView=new i({el:'form[name="bankInfo"]',checkInput:e(e('input[name="routingNumber3"]').length>0?'input[name="routingNumber3"]':'input[name="routingNumber"]')})},serialize:function(){return this.model&&this.model.toJSON()||{}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(223),n(228),n(341),n(351),n(340),n(229)],r=function(e,t,n,i,r,a,o){"use strict";return o.extend({template:"wallet/overpanel/bank/searchBankName",initialize:function(){},events:{"click .bankList li":"selectThisBank"},afterRender:function(){this.$(".textInput").lap().textField();var e=this.model.get("bankNames");e=e.bankNames,!this.bankTypeAhead&&e&&(e=e.map(function(e){return{itemValue:e.bankName,itemSubValue:e.bankNumber}}),this.bankNameCollection=new i(e),this.bankTypeAhead=new r({collection:this.bankNameCollection,list:new t.Collection(e)}),this.listenTo(this.bankTypeAhead,"selectTypeAheadItem",this.selectedBankName)),this.bankTypeAhead&&this.bankTypeAhead.setElement(this.$(".input-typeahead")).updateInputSource(this.$("#searchBankName"))},selectThisBank:function(e){e.preventDefault();var n=this.$(e.target).data("banknumber"),i=this.$(e.target).data("bankname"),r={};r.bankNumber=n,r.bankName=i,t.trigger("addBank:renderAfterSelectingBankName",r)},selectedBankName:function(e){var t=this.bankNameCollection.findWhere({itemValue:e.value});this.bankTypeAhead.hideItems(!0).model.set("selectedItem",t),this.$("#searchBankName").val(e.value)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229),n(224),n(223)],r=function(e,t,n,i){"use strict";return t.extend({template:"widgets/typeAhead",events:{"click li":"selectItem","keydown .typeahead-item":"selectAccessibleItem"},initialize:function(e){this.model=new i.Model,e=e||{},this.$inputSource=e.$inputSource,this.collection=this.collection||e.collection,this.list=e.list||null,this.options=e.options,this.listenTo(this.collection,"reset",this.render),n.bindAll(this,"searchListFromInputSource")},serialize:function(){return{typeAheadList:this.collection.toJSON()}},afterRender:function(){var e=this.collection.length<=0;this.hideItems(e),this.trigger("loading",!1),i.trigger("toggleLoading",!1),this.$("img").on("error",this.removeThumbnail.bind(this))},updateInputSource:function(e){this.$inputSource&&this.$inputSource.off("keyup"),this.$inputSource=e,this.$inputSource.on("keyup",n.debounce(this.searchListFromInputSource,100))},selectItem:function(e){var t=this.$(e.currentTarget),n=t.data();this.trigger("selectTypeAheadItem",n)},hideItems:function(e){return this.$inputSource&&this.$inputSource.data("skip-validate",!e),this.$el.toggleClass("showItems",!e),this},boldTypeAheadSearch:function(t){if(t){var n=this.$(".js-searchPoint"),i=new RegExp("("+t+")","ig");n.each(function(){var t=e(this),n=t.html(),r=n.replace(i,"<strong>$1</strong>");t.html(r)})}},removeThumbnail:function(e){var t=e.currentTarget;this.$(t).hide();var n=this.collection.findWhere({thumbnailUrl:t.src});n.unset("thumbnailUrl")},selectAccessibleItem:function(e){var t,n,i=e&&e.keyCode,r=13,a=38,o=40;i===r?(e.preventDefault(),this.selectItem(e)):i===a?(e.preventDefault(),t=e.target.previousSibling,t?t.focus():this.$inputSource.focus()):i===o&&(e.preventDefault(),n=e.target.nextSibling,n&&n.focus())},searchListFromInputSource:function(e){var t=this.$inputSource;if(!e||!e.currentTarget.value)return this.trigger("deselectItem"),this.collection.reset([]);var i=e&&e.keyCode,r=40;if(i===r)return t.data("skip-validate",!0),this.$("li:first").focus();this.collection.parse(this.list.toJSON());var a,o=e.currentTarget.value,s=this.options&&this.options.toJSON();this.collection.searchList?(a=this.collection.searchList(o,s),this.collection.reset(n.first(a,5))):this.collection.reset(this.collection.toJSON()),this.boldTypeAheadSearch(o);var l=this.model.get("selectedItem");l&&l.doesInputMatchSelectedItem&&!l.doesInputMatchSelectedItem(o)&&this.trigger("deselectItem")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(223),n(229),n(261),n(228),n(353),n(320),n(340)],r=function(e,t,n,i,r,a,o,s){"use strict";return n.extend({template:"wallet/overpanel/bank/bankFABList",events:{"click .bankLogin":"showFrictionlessLogin","click .manualAddBank":"showRoutingScreen"},initialize:function(e){var n=this.model||e.model;t.trigger("toggleLoading",!0),this.bankTemplateCountry=n.get("bankTemplateCountry"),this.fabExperimentation=n.get("fabExperimentation"),this.model=new t.Model,this.model.set("bankSpecs",n.get("bankSpecs")),this.listBankModel||(this.listBankModel=new a),this.fabExperimentation?(this.listenTo(t,"MFAtimeOut",this.MFAtimeOut),this.listenTo(t,"invalidMFA",this.invalidMFACase),this.listenToOnce(this.listBankModel,"sync",this.setListBankData),this.listenToOnce(this.listBankModel,"error",this.onError),this.listBankModel.fetch(),this.bankId=""):this.showRoutingScreen()},beforeRender:function(){this.invalidMFA=!1,this.timeout=!1,this.model.set("padExperimentation",i.isTreatment("8ball_wallet_fmx_PADaddbankflow_testvariant2_PADoptin")||i.isTreatment("8ball_wallet_fmx_PADaddbankflow_testvariant3_PADoptin2")||i.isTreatment("8ball_wallet_fmx_PADaddbankflow_testvariant1_autoenrollPAD")),this.model.set("fundingOptions",this.listBankModel.get("data")),t.trigger("setReplaceBankPresent",this.model)},setListBankData:function(){this.model.set("fundingOptions",this.listBankModel.get("data")),t.trigger("toggleLoading",!1),this.render()},showFrictionlessLogin:function(e){e&&(e.preventDefault(),this.bankId=this.$(e.currentTarget).data("attr")),t.trigger("toggleLoading",!0),this.bankId=this.bankId.toString(),this.frictionLessBankLoginModel=new o,this.listenToOnce(this.frictionLessBankLoginModel,"sync",this.successCallBack),this.listenToOnce(this.frictionLessBankLoginModel,"error",this.onError),this.frictionLessBankLoginModel.fetch({data:{id:this.bankId}})},MFAtimeOut:function(){t.trigger("toggleLoading",!0),this.timeout=!0,this.invalidMFA=!1,this.showFrictionlessLogin()},invalidMFACase:function(){this.invalidMFA=!0,this.timeout=!1,this.showFrictionlessLogin()},successCallBack:function(){var e,n=this.model.get("fundingOptions"),i=this.frictionLessBankLoginModel.get("data"),a=this.dividerData(i),o=this,s=n.filter(function(e){return e.id===o.bankId?e:void 0});this.loginModel||(this.loginModel=new t.Model),s=s[0],e="generic"===s.bankClassName?!0:!1,this.loginModel.set({loginData:i,bankDetail:s,id:this.bankId,confirmType:"fabAddBank",generic:e,MFAtimeOut:this.timeout||!1,invalidMFA:this.invalidMFA||!1,flowType:"fabAddBankFlow",viewContext:this.model.get("viewContext"),bankSpecs:this.model.get("bankSpecs"),divider:a}),this.addBankConfirmYodleeView.model.set(this.loginModel.toJSON()),t.trigger("toggleLoading",!1),r.setContent(this.addBankConfirmYodleeView),t.trigger("trackLink",null,"fabLogin","main:walletweb:wallet:bank:fablogin","main:walletweb:wallet:bank:fablogin:"+this.bankId+"::")},dividerData:function(e){var t,n=e&&e.constraints&&e.constraints[0]&&e.constraints[0].properties,i=[];for(n=n||[],t=0;t<n.length-1;t++)i.push(n[t]);return i},showRoutingScreen:function(e){e.preventDefault(),t.trigger("toggleLoading",!1),this.addBankView||(this.addBankView=new s({model:this.model,collection:this.collection})),this.addBankView.template="wallet/overpanel/bank/entryForm/addBank_"+this.bankTemplateCountry,this.addBankView.model.set("frictionlessNotEligible",!0),r.setContent(this.addBankView),t.trigger("trackLink",null,"addDifferentBank","main:walletweb:wallet:add:bankadd")},onError:function(){e("body").data("frictionlessnoteligible",!0),t.trigger("toggleLoading",!1),this.addBankView||(this.addBankView=new s({model:this.model,collection:this.collection}),this.addBankView.template="wallet/overpanel/bank/entryForm/addBank_"+this.bankTemplateCountry),r.setContent(this.addBankView),t.trigger("trackError",{message:"Error loading bank login"})}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/listFrictionLessBanks"},parse:function(e){return e.data=e.data.bankLists,e}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,,,,,function(e,t,n){var i,r;i=[n(3),n(273)],r=function(e){e.widget("pp.lap",{_create:function(){this._getElements(),this._addListeners(),this._check()},_getElements:function(){this.elements={},this.elements.input=this.element.find("input, textarea"),this.elements.label=this.element.find("label")},_addListeners:function(){var t=this.elements.input;this.elements.input.bind("change keyup",e.proxy(this._check,this)),this.elements.input.bind("focus",e.proxy(this._watch,this)),this.elements.input.bind("blur",e.proxy(this._unwatch,this)),this.elements.label.bind("click touchstart",function(e){e.preventDefault(),e.stopPropagation(),t.focus()}).hover(function(){t.addClass("hovered")},function(){t.removeClass("hovered")})},_check:function(){this.elements.input.val()?this.elements.label.addClass("accessAid"):this.elements.label.removeClass("accessAid")},_watch:function(){this._watchInterval=setInterval(e.proxy(this._check,this),200),this.elements.label.addClass("focus")},_unwatch:function(){clearInterval(this._watchInterval),this.elements.label.removeClass("focus")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(273)],r=function(e){e.widget("pp.textField",{_create:function(){this._getElements(),this._addListeners(),this._load()},_getElements:function(){this.elements={},this.elements.parent=this.element,this.elements.input=this.element.find("input, textarea"),this.elements.helpErrors=this.element.find(".help-error"),this.elements.helpInformation=this.element.find(".help-information")},_addListeners:function(){this.elements.input.bind("focus",e.proxy(this._focus,this)),this.elements.input.bind("blur",e.proxy(this._blur,this)),this.elements.input.bind("complete",e.proxy(function(){this.closeBubble();var e=this.elements.input[0],t=this.validateField(e);t.valid?(this.elements.parent.removeClass("hasError"),this.elements.input.attr("aria-invalid","false")):(this.elements.parent.addClass("hasError"),this.elements.input.attr("aria-invalid","true"))},this)),this.elements.input.bind("error",e.proxy(this.openError,this))},_load:function(){this.elements.input.val()?this.elements.input.addClass("userText"):this.elements.input.removeClass("userText")},_blur:function(){this._load(),this.closeBubble();var e=this.elements.input[0],t=this.validateField(e);this._emptyFieldRule(t)},_emptyFieldRule:function(e){e.valid||"valueMissing"===e.error?(this.elements.parent.removeClass("hasError"),this.elements.input.attr("aria-invalid","false")):(this.elements.parent.addClass("hasError"),this.elements.input.attr("aria-invalid","true"))},_focus:function(e){this.closeAllBubble(),hasErrors=this.elements.parent.hasClass("hasError"),hasErrors?this.openError():this.openHelp()},openError:function(){var e=this.elements.input.attr("id");e&&e.length>0&&this.elements.input.attr("aria-describedby",e+"-help-error"),this.elements.helpErrors.addClass("open"),this.elements.parent.addClass("focus")},openHelp:function(e){var t=this.elements.input.attr("id");t&&t.length>0&&this.elements.input.attr("aria-describedby",t+"-help-information"),this.elements.helpInformation.addClass("open"),this.elements.parent.addClass("focus")},closeBubble:function(){var e=this.elements.input.attr("id");e&&e.length>0&&this.elements.input.removeAttr("aria-describedby"),this.elements.helpErrors.removeClass("open"),this.elements.helpInformation.removeClass("open"),this.elements.parent.removeClass("focus")},closeAllBubble:function(){e("p.open, div.open").removeClass("open"),this.elements.parent.removeClass("focus")},validateField:function(t){if(t&&e(t).data("skip-validate"))return{valid:!0};if(t.checkValidity){if(!t.checkValidity()){var n="";for(n in t.validity)if(t.validity[n]===!0&&"valid"!==n)return{valid:!1,error:n}}}else{if(validity={valueMissing:this.processRequired(),typeMismatch:!0,patternMismatch:this.processPattern(),rangeUnderflow:!0,rangeOverflow:!0,customError:!0
},!validity.valueMissing)return{valid:!1,error:"valueMissing"};if(!validity.patternMismatch)return{valid:!1,error:"patternMismatch"}}return{valid:!0}},processRequired:function(){if("undefined"!=typeof this.elements.input.attr("required")){var t=this.elements.input.val();return null!=t&&e.trim(t).length>0?!0:!1}return!0},processPattern:function(){var e=this.elements.input;if(!e.attr("pattern"))return!0;var t=new RegExp("^"+e.attr("pattern")+"$");return t.test(e.val())}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,,,,,function(e,t,n){var i,r;i=[n(3),n(223),n(224),n(229),n(228),n(373)],r=function(e,t,n,i,r){"use strict";var a=i.extend({template:"widgets/addressDropdown",events:{"change select":"selectOptionChanged"},initialize:function(e){this.model=new t.Model({state:""}),this.collection.isBillingAddress=e.isBillingAddress||this.collection.isBillingAddress,this.listenTo(this.model,"change:state",this.dispatch),this.listenTo(this.collection,"reset",this.render),this.listenTo(this.collection,"change",this.render),this.listenTo(t,"address:added",this.selectAddedAddress)},afterRender:function(){this.$(".selectDropdown").nativeDropdown(),this.model.set("state",""),r.isOpen?r.$el.focus():this.$("#shippingAddress, #billingAddress").focus(),this.limitCharacters()},serialize:function(){return{addressBook:this.collection.getAddressBook(),isBillingAddress:this.collection.isBillingAddress}},dispatch:function(){var e=t.history.getFragment(),n=e.split("/")[0];"add"===this.model.get("state")&&setTimeout(function(){t.history.navigate(n+"/add/address/"+e,{trigger:!0})},50)},limitCharacters:function(){var t=this.$(".selectDropdown option"),n=this.$(".nativeDropdown").data("ellipsis");t.each(function(){var t=e(this).text();t.length>75&&e(this).text(t.substring(0,75)+n)})},selectOptionChanged:function(t){var n=e(t.currentTarget),i=n.find("option:selected");t.preventDefault(),this.model.set("state",i.data("state")||"")},setSelectedAddress:function(e){this.collection.invoke("set",{isDefault:!1});var t=this.collection.get(e);t&&t.set("isDefault",!0)},selectAddedAddress:function(e){e&&this.setSelectedAddress(e.id)}});return a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3)],r=function(e){e.fn.nativeDropdown=function(t){var n={replacedClass:"replaced",customSelectClass:"custom-select",activeClass:"active",wrapperElement:'<div class="custom-select-container" />'};t&&e.extend(n,t),this.each(function(){var t=e(this),i=t.find("select"),r=e('<div class="'+n.customSelectClass+'" aria-hidden="true">'+e("option:selected",this).text()+"</div>");t.append(r);var a=function(){var t=e("option:selected",this),n=t.attr("data-abbreviation")?t.attr("data-abbreviation"):t.text();r.text(n)};i.bind("change keyup",a),i.bind("mouseenter focus",function(){t.addClass("hovered")}),i.bind("mouseleave blur",function(){t.removeClass("hovered")})})}}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(e,t,n){var i,r;i=[n(3),n(224),n(223),n(229),n(427),n(428),n(250),n(242),n(429),n(241),n(430),n(426),n(431),n(432),n(433),n(434),n(437),n(438),n(440),n(441),n(228),n(261)],r=function(e,t,n,i,r,a,o,s,l,c,u,d,h,p,f,m,g,v,y,w,b,k){"use strict";var C=i.extend({events:{"click .continue":"convertAndReview","click .add":"convertAndReview","change #balanceList":"setAmountModel","change #bankList":"setAmountModel","focusout #amount":"checkAmountLimit","click .keepBalance":"closeOverPanel","click .closeToolTip":"closeToolTip","click .gotoView":"closeTipOverPanel","click .paypalCashLink":"addMoneyWithPayPalCash","change #bankName":"showTopUpInstructions","click .topUpFromUs":"loadDefaultAddFundsView"},initialize:function(e){this.rootURL=n.history.options.root,this.alertMsg||(this.alertMsg=new s),this.banksModel=new o,this.sessionFlagModel=new d,this.currencyAmountModel=new r(e.locality),this.converterModel=new a,this.bankCollection=e.bankCollection,this.cardCollection=e.cardCollection,this.viewContext=e.viewContext,this.withdrawFundsSpecs=e.withdrawFundsSpecs,this.addFundsSpecs=e.addFundsSpecs,this.linksConfig=e.linksConfig,this.linkAttributesConfig=e.linkAttributesConfig,this.model.set("useDefaultTemplate",e.addFundsSpecs.useDefaultTemplate),this.balanceAmountView=new l({collection:this.collection}),this.model.set("bankSpecs",this.bankCollection.bankSpecs),this.listenTo(this.model,"change:action",this.setUrlRoot),this.listenToOnce(this.bankCollection,"sync",this.banksFetchSuccess),this.listenToOnce(this.bankCollection,"error",this.banksFetchError),this.listenTo(n,"success",this.updateSessionFlag),this.listenTo(n,"setAmountModel",this.setAmountModel),this.listenTo(n,"success",this.success),this.listenTo(n,"showEntryView",this.render),this.listenTo(n,"setReviewAndConfirmModel",this.setReviewAndConfirmModel),this.withdrawFundsSpecs.get("feeSchedule")&&(this.dynamicFeeScheduleModel=new r(e.locality),this.listenTo(n,"fundingSourceSelected",this.updateDynamicFeeSchedule))},setReviewAndConfirmModel:function(e){this.withdrawTimeForReviewAndConfirmModel=e},updateDynamicFeeSchedule:function(e,t){var n,i,r,a,o,s,l,c=t?this.cardCollection.findWhere({fiId:e}):this.bankCollection.findWhere({fiId:e});"withdraw"===this.model.get("action")&&(r=this.withdrawFundsSpecs.get("feeSchedule"),t?(i=c.get("cardType").toUpperCase(),n=r&&r.card&&r.card[i]):(i=c.countryCode,n=r&&r.bank&&r.bank[i]),this.dynamicFeeScheduleView||(this.dynamicFeeScheduleView=new g({model:this.dynamicFeeScheduleModel}),a=this.collection.getCurrencySymbol("USD")||"$",o=this.collection.findWhere({currency:this.collection.primaryCurrency}),o=o&&o.get("available"),l=o&&0!==o.balanceFormatted.indexOf(o.currency),this.dynamicFeeScheduleModel.set({currency:"USD",currencySymbol:a,displayCurrencyCode:!0,isCurrencyCodeAtEnd:l})),s=n?this.dynamicFeeScheduleView.model.formatAmount(""+n):null,this.dynamicFeeScheduleView.model.unset("formattedFeeAmount",{silent:!0}),this.dynamicFeeScheduleView.model.set({formattedFeeAmount:s}))},beforeRender:function(){var e=k.isTreatment("us_8ball_wallet_ppcash_test"),t=k.isTreatment("8ball_wallet_fmx_bwop_test1"),n=k.isTreatment("8ball_wallet_fmx_bwop_test2"),i=k.isTreatment("8ball_wallet_fmx_bwop_test3"),r=t||n||i;this.model.set("paypalCash",e),this.model.set("bwopExpVar1",t),this.model.set("bwopExpVar2",n),this.model.set("bwopExpVar3",i),this.model.set("bwopExp",r)},afterRender:function(){var e,t,n=this.model.get("action"),i=this.withdrawFundsSpecs.get("canWithdrawToCard"),r=this.withdrawFundsSpecs.get("withdrawToCardTypes")||[],a=this.getBanks("all"),o=this.getBanks("confirmed"),s=this.addFundsSpecs.allowedCountries;this.countryCode=this.model.get("countryCode"),"add"===n&&s?t=o.filter(function(e){var t=e.get("countryCode");return s.indexOf(t)>-1}):"withdraw"===n&&i?(e=r.length?this.getCards("allowedForWithdraw"):this.getCards("all"),t=a.concat(e)):"add"===n?t=o:(t=a,"C2"===this.countryCode&&(t=t.filter(function(e){return e.attributes&&"CN"!==e.attributes.countryCode}))),this.collection.action=n,this.bankCollection.action=n,this.cardCollection.action=n,0===t.length&&("add"===n&&this.model.get("useDefaultTemplate")||"withdraw"===n)?(this.linkBankView||(this.linkBankView=new y({model:this.model})),this.linkBankView.setElement(this.$(".overpanel-content")).render(),this.undelegateEvents()):(this.delegateEvents(),this.renderBalanceAction(n,t)),this.model.set("useDefaultTemplate",this.addFundsSpecs.useDefaultTemplate)},updateSessionFlag:function(){var e;"summary"===this.viewContext?n.trigger("showDelayMessage"):(e={hideTransactionDelayMessage:!1},this.sessionFlagModel.setSessionFlag(e,!0))},renderBalanceAction:function(e,t){this.currencyAmountModel.set({countryCode:this.model.get("countryCode"),action:e,auth:this.collection.auth},{silent:!0}),this.banksModel.set("auth",this.collection.auth,{silent:!0}),"withdraw"===e&&n.trigger("toggleLoading",!0),this.banksDropdownView&&this.banksDropdownView.undelegateEvents(),this.banksDropdownView=new m({model:this.model,banks:this.bankCollection,cards:this.cardCollection,withdrawFundsSpecs:this.withdrawFundsSpecs,addFundsSpecs:this.addFundsSpecs,validFundingSources:t}),this.currencyAmountView?(this.balancesDropdownView.setElement(this.$(".balancesDropdown")).render(),this.banksDropdownView.setElement(this.$(".banksDropdown")).render(),this.maxWithDrawLimitView.setElement(this.$(".maxWithDrawLimit")).render(),this.currencyAmountView.model.set("amount",this.model.get("amount")),this.currencyAmountView.setElement(this.$(".amount")).render()):(this.balancesDropdownView=new p({collection:this.collection}),this.maxWithDrawLimitView=new f({model:this.currencyAmountModel}),this.currencyAmountView=new u({model:this.currencyAmountModel,el:this.$(".amount")}),this.currencyAmountView.template="wallet/inc/amount",this.currencyAmountModel.trigger("change")),this.dynamicFeeScheduleView&&this.dynamicFeeScheduleView.setElement(this.$(".js_dynamicFeeScheduleView")).render(),this.withdrawMoneyFormView=new c({el:this.$('form[name="withdrawMoney"]')}),this.addMoneyFormView=new c({el:this.$('form[name="addMoney"]')}),this.$el.focus()},removeServiceErrorMsg:function(){this.$(".alertMsg").remove()},showServiceErrorMsg:function(e){this.removeServiceErrorMsg(),this.$el.find(".overpanel-header").after(this.alertMsg.setMessage(e).el)},banksFetchSuccess:function(){n.trigger("toggleLoading",!1)},banksFetchError:function(e,t){var i=t.error&&t.error.message;n.trigger("toggleLoading",!1),i&&this.showServiceErrorMsg(i)},setUrlRoot:function(e){this.model.urlRoot="withdraw"===e.get("action")?this.rootURL+"wallet/withdrawBalance":this.rootURL+"wallet/balance/addFunds"},getBanks:function(e){var t;return"confirmed"===e?t=this.bankCollection.where({state:"confirmed"}).concat(this.bankCollection.where({state:"ready_to_use"})):"all"===e&&(t=this.bankCollection.filter(function(e){return!0})),t},getCards:function(e){var t,n=this.withdrawFundsSpecs.get("withdrawToCardTypes")||[];return"allowedForWithdraw"===e?t=this.cardCollection.filter(function(e){var t=e.get("cardType").toUpperCase();return n.indexOf(t)>-1}):"all"===e&&(t=this.cardCollection.filter(function(e){return!0})),t},reviewAndConfirm:function(){n.trigger("trackLink",this.$(".continue")),this.reviewAndConfirmView||(this.reviewAndConfirmView=new v({model:this.model}),this.reviewAndConfirmView.alertMsg=this.alertMsg),this.withdrawTimeForReviewAndConfirmModel&&(this.reviewAndConfirmView.model.set("minimumDays",this.withdrawTimeForReviewAndConfirmModel.minimumDays),this.reviewAndConfirmView.model.set("maximumDays",this.withdrawTimeForReviewAndConfirmModel.maximumDays),this.reviewAndConfirmView.model.set("extraWithdrawInformation",this.withdrawTimeForReviewAndConfirmModel.extraWithdrawInformation)),this.reviewAndConfirmView.setElement(this.$el).render(),n.trigger("toggleLoading",!1)},convertAndReview:function(e){var t,i,r,a=this.model.get("action"),o=this.$("form:visible").serializeArray(),s="withdraw"===a&&o?o[2].value:o[0].value,l=this.bankCollection.findWhere({fiId:s})||this.cardCollection.findWhere({fiId:s}),c=this.collection.findWhere({currency:l.get("currency")})?!0:!1,u=l&&l.attributes&&l.attributes.dataFormat;e.preventDefault(),n.trigger("toggleLoading",!0),"withdraw"===a&&(t=this.collection.findWhere({id:o[0].value})),i=t?t.get("currency"):l.get("currency"),r=this.currencyAmountView.el?this.currencyAmountModel.getUnformattedAmount(this.$("#amount").val()):this.$("#amount").val().replace(/[^0-9\.]/g,""),this.model.set({primaryCurrency:this.collection.primaryCurrency,amount:r,currency:i,fiId:s,selectedBank:l.toJSON()}),this.converterModel.set({action:a,fiId:s,amount:r,currency:i,currencyExist:c,primaryCurrency:this.collection.primaryCurrency,dataFormat:u}),this.converterModel.save(),this.listenToOnce(this.converterModel,"sync",this.setConverter),this.listenToOnce(this.converterModel,"error",this.submitError)},setConverter:function(e){var t=0,n=e&&e.get("from"),i=e&&e.get("to"),r=e&&e.get("fee");e.get("exchangeRate")&&e.get("exchangeRate").toFixed(6)&&(t=parseFloat(e.get("exchangeRate").toFixed(6))),this.model.set({converterRate:t,converterFromAmount:n&&n.amount,converterFromCurrency:n&&n.currency,converterToAmount:i&&i.amount,converterToCurrency:i&&i.currency,converterFromBalanceFormatted:n&&n.balanceFormatted,converterToBalanceFormatted:i&&i.balanceFormatted,withdrawFeeBalanceFormatted:r&&r.balanceFormatted,hasWithdrawFee:parseInt(r&&r.amount,10)>0}),this.reviewAndConfirm()},submitError:function(e,t,i){n.trigger("trackError",{message:i,code:t.error.code}),this.showServiceErrorMsg(i),n.trigger("toggleLoading",!1)},success:function(){this.collection.action="success",this.collection.fetch()},setAmountModel:function(){var e,t,i,r,a,o,s,l;n.trigger("toggleLoading",!1),"withdraw"===this.model.get("action")?(e=1===this.collection.length?this.$('input[name="balance"]'):this.$('select[name="balanceList"] option:selected'),t=this.collection.findWhere({id:e.val()}),s=t.get("currencySymbol"),this.currencyAmountModel.set({minAmountBalanceFormatted:t.get("minWithdrawLimit").balanceFormatted,maxAmountBalanceFormatted:t.get("available").balanceFormatted,currency:t.get("currency"),currencySymbol:s})):this.getBanks("confirmed").length>0&&(i=this.$('select[name="bankList"] option:selected'),r=this.bankCollection.findWhere({fiId:i.val()}),s=r&&r.get("currencySymbol"),o=this.currencyAmountModel.get("locality"),l=this.currencyAmountModel.get("decimal"),a=o?this.currencyAmountModel.get("locality").separator:this.currencyAmountModel.get("separator"),this.currencyAmountModel.set({minAmountBalanceFormatted:s+"1"+l+"00",maxAmountBalanceFormatted:s+"100"+a+"000"+l+"00",currency:r&&r.get("currency"),currencySymbol:s}))},checkAmountLimit:function(){var e=this.$("#amount"),t=e.val(),n=this.$("#amount-help-error"),i=this.withdrawMoneyFormView.checkInputMax(e,t),r=this.withdrawMoneyFormView.checkInputMin(e,t);i||n.text(this.$("#amountMaxLimitErrorText").text()),r||n.text(this.$("#amountMinLimitErrorText").text())},updateViewState:function(e,t,n){t="fromDetails"===t?"balanceDetails":t,this.model.set({action:e,section:t,state:n,withdrawFundsSpecs:this.withdrawFundsSpecs.toJSON(),addFundsSpecs:this.addFundsSpecs,balanceSpec:this.balanceSpecs,links:this.linksConfig,linkAttributes:this.linkAttributesConfig})},unsetModel:function(e){this.model.unset(e)},closeTipOverPanel:function(){this.closeToolTip(),this.closeOverPanel()},closeOverPanel:function(){b.isOpen&&b.hideOverpanel()},closeToolTip:function(){e(".tooltipClose").click()},addMoneyWithPayPalCash:function(e){e.preventDefault(),n.trigger("toggleLoading",!0),this.payPalCashBarcodeModel=this.payPalCashBarcodeModel||new h,this.payPalCashBarcodeModel.fetch(),this.listenToOnce(this.payPalCashBarcodeModel,"sync",this.addMoneyWithPayPalCashSuccess),this.listenToOnce(this.payPalCashBarcodeModel,"error",this.addMoneyWithPayPalCashError)},addMoneyWithPayPalCashSuccess:function(e,t){var n=t.data&&t.data.encryptedData;this.$(".encryptedData").val(n),this.$('form[name="addMoneyWithPayPalCash"]').submit()},addMoneyWithPayPalCashError:function(e,t,i){n.trigger("toggleLoading",!1),i&&this.showServiceErrorMsg(i)},showTopUpInstructions:function(e){var t=this.$(".instructions"),n=t.data("attr"),i=this.$(e.target).val();t.removeClass("hide"),t.data("attr",i),this.$(".registerImg").removeClass(n).addClass(i),this.$(".transferImg").removeClass(n).addClass(i)},loadDefaultAddFundsView:function(e){e.preventDefault(),this.model.set("useDefaultTemplate",!0),this.render()}});return C}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({urlRoot:"/myaccount/config",setSessionFlag:function(e,t){var n=t?1e3:0;setTimeout(this.save.bind(this,e,{ignoreErrors:!0}),n)}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({defaults:{amountPattern:"[^\\d]{0,}(\\d+)[\\.|,|]?(\\d{0,})?"},initRegexVars:function(){var e=this.get("decimal");this.set("regex",{numberPattern:new RegExp("[^0-9\\"+e+"]","g"),leadingSeparatorPattern:new RegExp("^\\"+e)})},getUnformattedAmount:function(e){var t=this.get("decimal"),n=this.get("regex"),i=n&&n.numberPattern,r=n&&n.leadingSeparatorPattern,a=e&&e.replace(i,"").replace(r,"0"+t);return a},formatAmount:function(e){var t,n,i,r,a=this.get("decimal"),o=this.get("currencySymbol"),s=this.get("currency"),l=this.get("displayCurrencyCode");return this.get("regex")||this.initRegexVars(),t=this.getUnformattedAmount(e).replace(a,"."),n=""!==t?parseFloat(t).toFixed(2):"",i=n.replace(".",a),r=""!==o&&""!==t?o+i:i,l&&s?this.formatAmountWithCurrencyCode(r,s):r},formatAmountWithCurrencyCode:function(e,t){var n;return n=this.get("isCurrencyCodeAtEnd")?e+" "+t:t+" "+e},deformatAmount:function(e){var t=e&&e.replace(/^\D+/g,"");return t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({initialize:function(){this.on("change:action",this.setUrlRoot)},parse:function(e){return e.data},setUrlRoot:function(){var t="withdraw"===this.get("action")?"wallet/balances/analyzeWithdraw":"wallet/balances/analyzeAdd";this.urlRoot=e.history.options.root+t}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229)],r=function(e){"use strict";var t=e.extend({el:".balanceNumeral",template:"widgets/inc/balanceAmount",initialize:function(){this.listenTo(this.collection,"change",this.render)},serialize:function(){return{data:{balance:this.collection.getBalanceData()},balanceSpecs:this.collection.getBalanceConfig().balanceSpecs}}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229)],r=function(e,t){"use strict";var n=t.extend({el:".amount",events:{'focusin input[name="amount"]':"deformatAmount",'focusout input[name="amount"]':"formatAmount"},initialize:function(){this.listenTo(this.model,"change",this.render)},afterRender:function(){this.$el.find(".lap").lap().textField(),this.model.get("regex")||this.model.initRegexVars()},formatAmount:function(){var e=this.$('input[name="amount"]'),t=this.model.formatAmount(e.val(),this.regex);e.val(t)},deformatAmount:function(){var e=this.$('input[name="amount"]'),t=this.model.deformatAmount(e.val());e.val(t)}});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/balances/addFunds/paypalCash"}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229),n(223)],r=function(e,t,n){"use strict";var i=t.extend({el:".balancesDropdown",template:"wallet/inc/balancesDropdown",initialize:function(){this.listenTo(this.collection,"sync",this.render),this.render()},afterRender:function(){this.$(".selectDropdown").nativeDropdown(),"withdraw"===this.collection.action&&this.collection.length&&n.trigger("setAmountModel")},serialize:function(){return{auth:this.collection.auth,length:this.collection.length,action:this.collection.action,balanceDetails:this.collection.toJSON(),totalAvailable:this.collection.totalAvailable}}});return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229)],r=function(e,t){"use strict";var n=t.extend({el:".maxWithDrawLimit",template:"wallet/inc/maxWithDrawLimit",initialize:function(){this.listenTo(this.model,"change",this.render)}});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229),n(223),n(435),n(436)],r=function(e,t,n,i,r){"use strict";var a=t.extend({el:".banksDropdown",template:"wallet/inc/banksDropdown",events:{"change #bankList":"handleSelectedFundingSource"},initialize:function(e){this.bankCollection=e.banks,this.cardCollection=e.cards,this.action=e.action,this.withdrawFundsSpecs=e.withdrawFundsSpecs,this.addFundsSpecs=e.addFundsSpecs,this.validFundingSources=e.validFundingSources,this.listenTo(this.bankCollection,"sync",this.render),this.listenTo(this.cardCollection,"sync",this.render),this.render()},beforeRender:function(){this.countryCode=this.$el.data("countryCode")||""},afterRender:function(){var e=this.withdrawFundsSpecs.get("otherWithdrawalTimes");this.$(".selectDropdown").nativeDropdown(),e&&(this.withdrawalTimeModel=new r({minimumDays:this.withdrawFundsSpecs.get("minimumDays"),maximumDays:this.withdrawFundsSpecs.get("maximumDays"),showMemoField:this.withdrawFundsSpecs.get("showMemoField")||!1}),this.withdrawalTimeView=new i({model:this.withdrawalTimeModel})),this.handleSelectedFundingSource(),("add"===this.bankCollection.action||"add"===this.cardCollection.action)&&n.trigger("setAmountModel")},serialize:function(){var e,t=this.bankCollection.action;return e=this.validFundingSources.map(function(e){return e.toJSON()}),{action:t,validFundingSources:e,countryCode:this.countryCode,minimumDays:this.withdrawFundsSpecs.get("minimumDays"),maximumDays:this.withdrawFundsSpecs.get("maximumDays"),showWithdrawTimeContent:this.withdrawFundsSpecs.get("showWithdrawTimeContent")}},updateWithdrawalTimes:function(e,t){var i=this.withdrawFundsSpecs.get("otherWithdrawalTimes"),r=i&&i[e];t.minimumDays=r?r.minimumDays:this.withdrawFundsSpecs.get("minimumDays"),t.maximumDays=r?r.maximumDays:this.withdrawFundsSpecs.get("maximumDays"),t.extraWithdrawInformation=r&&r.extraWithdrawInformation||!1,t.showMemoField=r&&r.showMemoField||!1,n.trigger("setReviewAndConfirmModel",t),this.withdrawalTimeModel.set(t)},handleSelectedFundingSource:function(e){var t,i=this.$('select[name="bankList"] option:selected'),r=i.val(),a=r&&r.indexOf("CC")>-1,o=this.withdrawFundsSpecs.get("otherWithdrawalTimes"),s=!(!o||!o.card),l={showMessaging:!0,isCardSelected:a};if(this.withdrawFundsSpecs.get("feeSchedule")&&n.trigger("fundingSourceSelected",r,a),o){if(a){if(!s)return void this.withdrawalTimeModel.set({hideMessaging:!0});t="card"}else t="bank_"+i.data("country");l.hideMessaging=!1,this.updateWithdrawalTimes(t,l)}}});return a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229)],r=function(e,t){"use strict";var n=t.extend({el:".js_dynamicWithdrawalTimeView",template:"wallet/inc/withdrawalTimeText",initialize:function(){this.listenTo(this.model,"change",this.render),this.render()}});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({defaults:{minimumDays:0,maximumDays:0,hideMessaging:!1,isCardSelected:!1}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229)],r=function(e,t){"use strict";var n=t.extend({el:".js_dynamicFeeScheduleView",template:"wallet/inc/dynamicFeeSchedule",initialize:function(){this.listenTo(this.model,"change",this.render),this.render()}});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(223),n(229),n(439)],r=function(e,t,n,i){"use strict";var r=n.extend({template:"wallet/overpanel/balance/reviewAndConfirm",events:{"click .change":"showEntryView","click .reviewAndConfirm":"doAction"},afterRender:function(){this.$el.focus()},removeServiceErrorMsg:function(){this.$(".alertMsg").remove()},showServiceErrorMsg:function(e){this.removeServiceErrorMsg(),this.$el.find(".overpanel-header").after(this.alertMsg.setMessage(e).el)},showEntryView:function(e){e.preventDefault(),t.trigger("showEntryView"),this.$("#amount").focus()},success:function(e){t.trigger("success"),this.successView||(this.successView=new i({model:e})),this.successView.setElement(this.$el).render(),t.trigger("toggleLoading",!1)},submitError:function(e,n,i){t.trigger("trackError",{message:i,code:n.error.code}),this.showServiceErrorMsg(i),t.trigger("toggleLoading",!1)},doAction:function(e){e.preventDefault(),t.trigger("toggleLoading",!0),this.model.save(),this.listenToOnce(this.model,"sync",this.success),this.listenToOnce(this.model,"error",this.submitError)}});return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229)],r=function(e,t){"use strict";var n=t.extend({template:"wallet/overpanel/balance/success",afterRender:function(){this.$el.focus()}});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(229),n(242),n(431)],r=function(e,t,n,i){"use strict";return t.extend({template:"wallet/overpanel/balance/linkBank",events:{"click .paypalCashLink":"addMoneyWithPayPalCash"},initialize:function(e){var t=e.model.get("withdrawFundsSpecs"),n=t&&t.withdrawOptionsWithNoBankNeeded;this.model.set("withdrawOptionsWithNoBankNeeded",n)},afterRender:function(){e.trigger("toggleLoading",!1),this.$el.focus()},showServiceErrorMsg:function(e){this.alertMsg||(this.alertMsg=new n),this.removeServiceErrorMsg(),this.$el.find(".linkBankWarning").before(this.alertMsg.setMessage(e).el)},addMoneyWithPayPalCash:function(t){t.preventDefault(),e.trigger("toggleLoading",!0),this.payPalCashBarcodeModel=this.payPalCashBarcodeModel||new i,this.payPalCashBarcodeModel.fetch(),this.listenToOnce(this.payPalCashBarcodeModel,"sync",this.addMoneyWithPayPalCashSuccess),this.listenToOnce(this.payPalCashBarcodeModel,"error",this.addMoneyWithPayPalCashError)},addMoneyWithPayPalCashSuccess:function(e,t){var n=t.data&&t.data.encryptedData;this.$(".encryptedData").val(n),this.$('form[name="addMoneyWithPayPalCash"]').submit()},addMoneyWithPayPalCashError:function(t,n,i){e.trigger("toggleLoading",!1),i&&this.showServiceErrorMsg(i)},removeServiceErrorMsg:function(){this.$(".alertMsg").remove()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229),n(223),n(427),n(430),n(434)],r=function(e,t,n,i,r,a){"use strict";var o=t.extend({template:"wallet/overpanel/balance/add_default",initialize:function(){},afterRender:function(){var e=this.$(".amount");this.currencyAmountView?(this.currencyAmountView.model.set("amount",this.model.get("amount")),this.currencyAmountView.setElement(e).render()):(this.currencyAmountView=new r({model:this.model.get("currencyAmountModel"),el:e}),this.currencyAmountView.template="wallet/inc/amount"),this.banksDropdownView=new a({banks:this.model.get("banks"),cards:this.model.get("cards"),withdrawFundsSpecs:this.model.get("withdrawFundsSpecs"),addFundsSpecs:this.model.get("addFundsSpecs")}),this.banksDropdownView.setElement(this.$(".banksDropdown")).render()}});return o}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,function(e,t,n){var i,r;i=[n(223),n(229),n(261),n(446),n(228),n(447),n(453)],r=function(e,t,n,i,r,a,o){"use strict";return t.extend({initialize:function(e){this.checkCIPStatusModel=new i,this.addressCollection=e.addressCollection,this.model.set("isCipTreatment",n.isTreatment("us_8ball_wallet_cip_flow_test")),this.listenTo(this.model,"change:state",this.dispatch)},action:{checkStatus:"checkCIPStatus",collectData:"collectData",failed:"showFailure",techFailure:"showFailure",restricted:"showFailure"},dispatch:function(e){var t=this.action[e.get("state")];t&&this[t]()},checkCIPStatus:function(){this.model.shouldCheckCIPStatus()?("balanceDetails"===this.model.get("section")?e.trigger("toggleLoading",!0):e.trigger("mainContent:toggleLoading",!0),this.listenToOnce(this.checkCIPStatusModel,"sync",this.checkCIPStatusSuccess),this.listenToOnce(this.checkCIPStatusModel,"error",this.checkCIPStatusError),this.checkCIPStatusModel.fetch()):this.model.set("state","pass")},checkCIPStatusSuccess:function(e){this.model.set("resCenterLink",e.get("resCenterLink")),this.model.setStateAfterCheck(e)},checkCIPStatusError:function(){this.model.set("state","techFailure")},initializeDataCollectionView:function(){this.dataCollectionView||(this.dataCollectionView=new a({model:this.model,addressCollection:this.addressCollection})),e.trigger("toggleLoading",!1)},initializeFailureView:function(){this.failureView||(this.failureView=new o({model:this.model})),e.trigger("toggleLoading",!1)},collectData:function(){var t=window.fpti?fpti.link:"cipCollectData";this.initializeDataCollectionView(),this.dataCollectionView.model.set({user:this.model.get("user"),section:this.model.get("section")}),r.setContent(this.dataCollectionView),e.trigger("trackLink",null,t,"main:walletweb:wallet:cip:collectdata")},showFailure:function(){var t=window.fpti?fpti.link:"cipCollectData";this.initializeFailureView(),r.setContent(this.failureView),e.trigger("trackLink",null,t,"main:walletweb:wallet:cip:"+this.model.get("state"))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/checkCIPStatus"},parse:function(e){var t;return e.data&&e.data.user&&e.data.user.documentDetails&&(t=e.data.user.documentDetails.value),"undefined"!=typeof t&&(""!==t?e.data.user.documentDetails.docPattern="^("+t+"|\\d{4})$":e.data.user.documentDetails.docPattern="^(\\d{4})$"),e.data}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(223),n(448),n(449)],r=function(e,t,n,i){"use strict";return e.extend({template:"cip/dataCollectionForm",initialize:function(e){this.headerView=new n({model:new t.Model}),this.collectDataView=new i({model:this.model,addressCollection:e.addressCollection}),this.listenTo(t,"setHeaderState",this.setHeaderState)},afterRender:function(){this.headerView.setElement(this.$("#overpanel-header")).render().model.set("headerState","collectData"),this.collectDataView.setElement(this.$("#dataCollection")).render()},setHeaderState:function(e){this.headerView.model.set("headerState",e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229)],r=function(e){"use strict";return e.extend({template:"cip/inc/header",initialize:function(){this.listenTo(this.model,"change",this.render)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(229),n(450),n(241),n(372),n(451),n(452),n(244)],r=function(e,t,n,i,r,a,o){"use strict";var s=t.extend({template:"cip/collectData",events:{"click #cipReview":"reviewData"},initialize:function(t){this.addressCollection=t.addressCollection,this.userDataCollectionModel=new n({docType:this.model.get("docType"),docNum:this.model.get("docNum")}),this.addressDropdownView=new r({collection:this.addressCollection}),this.documentDetailsView=new a({model:new e.Model({isTaxIdConfirmed:this.model.get("isTaxIdConfirmed")}),isFourDigits:this.model.isFourDigits}),this.cipFormView=new i({el:this.$el}),this.reviewDataView=new o({model:this.model})},afterRender:function(){var t=this.model.get("shouldMaskTaxId"),n=this.model.get("docNum"),r=this.model.get("docType");this.model.isDocNumMasked()||this.userDataCollectionModel.set({docType:r,docNum:n}),this.addressDropdownView.setElement(this.$(".addressDropdown")).render(),n=t?"XX"+n.slice(-2):n,this.model.set("docNum",n),this.documentDetailsView.model.set({docPattern:t?"^("+n+"|\\d{4})$":"^\\d{4}$",docType:r||"ssn",docNum:n}),this.documentDetailsView.setElement(this.$(".docField")).render(),this.cipFormView=new i({el:this.$el}),this.$(".selectDropdown").nativeDropdown(),this.$(".textInput.lap").lap().textField(),e.trigger("mainContent:toggleLoading",!1)},reviewData:function(t){var n=this.$("#docNum").val();if(t.preventDefault(),this.model.get("isTaxIdConfirmed")?(n=this.userDataCollectionModel.get("docNum"),this.model.set("shouldMaskTaxId",!0)):n&&0===n.indexOf("XX")?n=this.userDataCollectionModel.get("docNum"):this.model.set("shouldMaskTaxId",!1),this.cipFormView.validateBeforeSubmit(t)){var i=this.$("#billingAddress option:selected").attr("id"),r=this.addressCollection.findWhere({id:i}).toJSON(),a=e.Syphon.serialize(this);a.address=r,a.docNum=n,this.userDataCollectionModel.set(a),this.reviewDataView.userDataCollectionModel=this.userDataCollectionModel,this.model.get("isCipTreatment")?(this.model.set({state:"reviewData",birthMonth:parseInt(a.birthMonth,10),birthDay:parseInt(a.birthDay,10),birthYear:parseInt(a.birthYear,10),address:r,docType:a.docType,docNum:this.model.getFormattedDocNum(a.docNum)}),this.reviewDataView.setElement(this.$('form[name="cipCollectData"]')).render()):this.reviewDataView.submitData(t);
}}});return s}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"wallet/dataCollectionCIP"},parse:function(e){return e.data}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229)],r=function(e){"use strict";return e.extend({template:"cip/inc/documentDetails",events:{'change input[name="docType"]':"changeIssuer","keyup #docNum":"check4Digit"},initialize:function(e){this.isFourDigits=e.isFourDigits,this.listenTo(this.model,"change",this.render)},changeIssuer:function(e){this.model.set({docType:this.$(e.currentTarget).val(),docNum:""}),this.$('input[name="docType"]:checked').focus()},check4Digit:function(e){var t=this.$(e.currentTarget);this.isFourDigits(t.val())&&t.parent().removeClass("hasError")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(223)],r=function(e,t){"use strict";return e.extend({template:"cip/reviewData",events:{"click a[data-back]":"editData","click #cipSubmit":"submitData"},afterRender:function(){t.trigger("setHeaderState","reviewData")},editData:function(e){e.preventDefault(),this.model.set("state","collectData")},submitData:function(e){e.preventDefault(),this.listenToOnce(this.userDataCollectionModel,"sync",this.dataCollectionCIPSuccess),this.listenToOnce(this.userDataCollectionModel,"error",this.dataCollectionCIPError),t.trigger("toggleLoading",!0),this.userDataCollectionModel.save()},dataCollectionCIPSuccess:function(e){this.model.setStateAfterDataCollection(e)},dataCollectionCIPError:function(){this.model.set("state","techFailure")}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(223),n(228)],r=function(e,t,n){"use strict";return e.extend({template:"cip/failure",events:{"click .tryAgain":"tryAgain",'click [name="resCenter"]':"restrictAccount"},initialize:function(){var e=t.Model.extend({url:t.history.options.root+"wallet/restrictAccount"});this.restrictionModel=new e},afterRender:function(){t.trigger("mainContent:toggleLoading",!1)},tryAgain:function(e){e.preventDefault(),this.model.set("state","collectData")},restrictAccount:function(){this.model.get("isCipTreatment")&&this.restrictionModel.save(),n.hideOverpanel()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(229),n(228)],r=function(e,t,n){"use strict";var i=t.extend({el:"#overpanel",template:"widgets/inc/zeroBalanceAlert",events:{"click #js_closeZeroBalAlert":"closeZeroBalAlert"},initialize:function(){},updateViewWithSection:function(e){this.model.set({section:e})},closeZeroBalAlert:function(){n.hideOverpanel()}});return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229),n(258)],r=function(e,t,n){"use strict";return t.extend({template:"widgets/PayAfterDeliveryModule",initialize:function(e){this.model=new n({status:e.padEligibilityStatus,isDefaultPaymentMethod:e.isDefaultPaymentMethod,fiId:e.fiId||""}),this.render()},serialize:function(){var e=this.model.get("fiId")||"",t=e?this.collection.findWhere({fiId:e}).toJSON():[];return{banks:t,isDefaultPaymentMethod:this.model.get("isDefaultPaymentMethod"),padEligibilityStatus:this.model.get("status")}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,function(e,t,n){(function(e){!function(e){function t(){return new Date(Date.UTC.apply(Date,arguments))}function n(t,n){var i,r=e(t).data(),a={},o=new RegExp("^"+n.toLowerCase()+"([A-Z])"),n=new RegExp("^"+n.toLowerCase());for(var s in r)n.test(s)&&(i=s.replace(o,function(e,t){return t.toLowerCase()}),a[i]=r[s]);return a}function i(t){var n={};if(u[t]||(t=t.split("-")[0],u[t])){var i=u[t];return e.each(c,function(e,t){t in i&&(n[t]=i[t])}),n}}var r=e(window),a=function(t,n){this._process_options(n),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=this.element.is(".date")?this.element.find(".add-on, .btn"):!1,this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=e(d.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&(this.picker.addClass("datepicker-rtl"),this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right")),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};a.prototype={constructor:a,_process_options:function(t){this._o=e.extend({},this._o,t);var n=this.o=e.extend({},this._o),i=n.language;switch(u[i]||(i=i.split("-")[0],u[i]||(i=l.language)),n.language=i,n.startView){case 2:case"decade":n.startView=2;break;case 1:case"year":n.startView=1;break;default:n.startView=0}switch(n.minViewMode){case 1:case"months":n.minViewMode=1;break;case 2:case"years":n.minViewMode=2;break;default:n.minViewMode=0}n.startView=Math.max(n.startView,n.minViewMode),n.weekStart%=7,n.weekEnd=(n.weekStart+6)%7;var r=d.parseFormat(n.format);n.startDate!==-(1/0)&&(n.startDate?n.startDate instanceof Date?n.startDate=this._local_to_utc(this._zero_time(n.startDate)):n.startDate=d.parseDate(n.startDate,r,n.language):n.startDate=-(1/0)),n.endDate!==1/0&&(n.endDate?n.endDate instanceof Date?n.endDate=this._local_to_utc(this._zero_time(n.endDate)):n.endDate=d.parseDate(n.endDate,r,n.language):n.endDate=1/0),n.daysOfWeekDisabled=n.daysOfWeekDisabled||[],e.isArray(n.daysOfWeekDisabled)||(n.daysOfWeekDisabled=n.daysOfWeekDisabled.split(/[,\s]*/)),n.daysOfWeekDisabled=e.map(n.daysOfWeekDisabled,function(e){return parseInt(e,10)});var a=String(n.orientation).toLowerCase().split(/\s+/g),o=n.orientation.toLowerCase();if(a=e.grep(a,function(e){return/^auto|left|right|top|bottom$/.test(e)}),n.orientation={x:"auto",y:"auto"},o&&"auto"!==o)if(1===a.length)switch(a[0]){case"top":case"bottom":n.orientation.y=a[0];break;case"left":case"right":n.orientation.x=a[0]}else o=e.grep(a,function(e){return/^left|right$/.test(e)}),n.orientation.x=o[0]||"auto",o=e.grep(a,function(e){return/^top|bottom$/.test(e)}),n.orientation.y=o[0]||"auto";else;},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t,n,i=0;i<e.length;i++)t=e[i][0],n=e[i][1],t.on(n)},_unapplyEvents:function(e){for(var t,n,i=0;i<e.length;i++)t=e[i][0],n=e[i][1],t.off(n)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(this.update,this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{"mousedown touchstart":e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var i=n||this.date,r=this._utc_to_local(i);this.element.trigger({type:t,date:r,format:e.proxy(function(e){var t=e||this.o.format;return d.formatDate(i,t,this.o.language)},this)})},show:function(e){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.height=this.component?this.component.outerHeight():this.element.outerHeight(),this.place(),this._attachSecondaryEvents(),e&&e.preventDefault(),this._trigger("show")},hide:function(e){this.isInline||this.picker.is(":visible")&&(this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"))},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},_utc_to_local:function(e){return new Date(e.getTime()+6e4*e.getTimezoneOffset())},_local_to_utc:function(e){return new Date(e.getTime()-6e4*e.getTimezoneOffset())},_zero_time:function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){return this.date},setDate:function(e){this.setUTCDate(this._local_to_utc(e))},setUTCDate:function(e){this.date=e,this.setValue()},setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e).change():this.component&&this.element.find("input").val(e).change()},getFormattedDate:function(e){return void 0===e&&(e=this.o.format),d.formatDate(this.date,e,this.o.language)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){var t=this.picker.outerWidth(),n=this.picker.outerHeight(),i=10,a=r.width(),o=r.height(),s=r.scrollTop(),l=parseInt(this.element.parents().filter(function(){return"auto"!=e(this).css("z-index")}).first().css("z-index"))+10,c=this.component?this.component.parent().offset():this.element.offset(),u=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),d=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),h=c.left,p=c.top;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(h-=t-d)):(this.picker.addClass("datepicker-orient-left"),c.left<0?h-=c.left-i:c.left+t>a&&(h=a-t-i));var f,m,g=this.o.orientation.y;"auto"===g&&(f=-s+c.top-n,m=s+o-(c.top+u+n),g=Math.max(f,m)===m?"top":"bottom"),this.picker.addClass("datepicker-orient-"+g),"top"===g?p+=u:p-=n+parseInt(this.picker.css("padding-top")),this.picker.css({top:p,left:h,zIndex:l})}},_allow_update:!0,update:function(){if(this._allow_update){var e,t=new Date(this.date),n=!1;arguments&&arguments.length&&("string"==typeof arguments[0]||arguments[0]instanceof Date)?(e=arguments[0],e instanceof Date&&(e=this._local_to_utc(e)),n=!0):(e=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),delete this.element.data().date),this.date=d.parseDate(e,this.o.format,this.o.language),n?this.setValue():e?t.getTime()!==this.date.getTime()&&this._trigger("changeDate"):this._trigger("clearDate"),this.date<this.o.startDate?(this.viewDate=new Date(this.o.startDate),this.date=new Date(this.o.startDate)):this.date>this.o.endDate?(this.viewDate=new Date(this.o.endDate),this.date=new Date(this.o.endDate)):(this.viewDate=new Date(this.date),this.date=new Date(this.date)),this.fill()}},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var n='<th class="cw">&nbsp;</th>';t+=n,this.picker.find(".datepicker-days thead tr:first-child").prepend(n)}for(;e<this.o.weekStart+7;)t+='<th class="dow">'+u[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;12>t;)e+='<span class="month">'+u[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").html(e)},setRange:function(t){t&&t.length?this.range=e.map(t,function(e){return e.valueOf()}):delete this.range,this.fill()},getClassNames:function(t){var n=[],i=this.viewDate.getUTCFullYear(),r=this.viewDate.getUTCMonth(),a=this.date.valueOf(),o=new Date;return t.getUTCFullYear()<i||t.getUTCFullYear()==i&&t.getUTCMonth()<r?n.push("old"):(t.getUTCFullYear()>i||t.getUTCFullYear()==i&&t.getUTCMonth()>r)&&n.push("new"),this.o.todayHighlight&&t.getUTCFullYear()==o.getFullYear()&&t.getUTCMonth()==o.getMonth()&&t.getUTCDate()==o.getDate()&&n.push("today"),t.valueOf()==a&&n.push("active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||-1!==e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled))&&n.push("disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&n.push("range"),-1!=e.inArray(t.valueOf(),this.range)&&n.push("selected")),n},fill:function(){var n,i=new Date(this.viewDate),r=i.getUTCFullYear(),a=i.getUTCMonth(),o=this.o.startDate!==-(1/0)?this.o.startDate.getUTCFullYear():-(1/0),s=this.o.startDate!==-(1/0)?this.o.startDate.getUTCMonth():-(1/0),l=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,c=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0;this.date&&this.date.valueOf();this.picker.find(".datepicker-days thead th.datepicker-switch").text(u[this.o.language].months[a]+" "+r),this.picker.find("tfoot th.today").text(u[this.o.language].today).toggle(this.o.todayBtn!==!1),this.picker.find("tfoot th.clear").text(u[this.o.language].clear).toggle(this.o.clearBtn!==!1),this.updateNavArrows(),this.fillMonths();var h=t(r,a-1,28,0,0,0,0),p=d.getDaysInMonth(h.getUTCFullYear(),h.getUTCMonth());h.setUTCDate(p),h.setUTCDate(p-(h.getUTCDay()-this.o.weekStart+7)%7);var f=new Date(h);f.setUTCDate(f.getUTCDate()+42),f=f.valueOf();for(var m,g=[];h.valueOf()<f;){if(h.getUTCDay()==this.o.weekStart&&(g.push("<tr>"),this.o.calendarWeeks)){var v=new Date(+h+(this.o.weekStart-h.getUTCDay()-7)%7*864e5),y=new Date(+v+(11-v.getUTCDay())%7*864e5),w=new Date(+(w=t(y.getUTCFullYear(),0,1))+(11-w.getUTCDay())%7*864e5),b=(y-w)/864e5/7+1;g.push('<td class="cw">'+b+"</td>")}if(m=this.getClassNames(h),m.push("day"),this.o.beforeShowDay!==e.noop){var k=this.o.beforeShowDay(this._utc_to_local(h));void 0===k?k={}:"boolean"==typeof k?k={enabled:k}:"string"==typeof k&&(k={classes:k}),k.enabled===!1&&m.push("disabled"),k.classes&&(m=m.concat(k.classes.split(/\s+/))),k.tooltip&&(n=k.tooltip)}m=e.unique(m),g.push('<td class="'+m.join(" ")+'"'+(n?' title="'+n+'"':"")+">"+h.getUTCDate()+"</td>"),h.getUTCDay()==this.o.weekEnd&&g.push("</tr>"),h.setUTCDate(h.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(g.join(""));var C=this.date&&this.date.getUTCFullYear(),_=this.picker.find(".datepicker-months").find("th:eq(1)").text(r).end().find("span").removeClass("active");C&&C==r&&_.eq(this.date.getUTCMonth()).addClass("active"),(o>r||r>l)&&_.addClass("disabled"),r==o&&_.slice(0,s).addClass("disabled"),r==l&&_.slice(c+1).addClass("disabled"),g="",r=10*parseInt(r/10,10);var D=this.picker.find(".datepicker-years").find("th:eq(1)").text(r+"-"+(r+9)).end().find("td");r-=1;for(var x=-1;11>x;x++)g+='<span class="year'+(-1==x?" old":10==x?" new":"")+(C==r?" active":"")+(o>r||r>l?" disabled":"")+'">'+r+"</span>",r+=1;D.html(g)},updateNavArrows:function(){if(this._allow_update){var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-(1/0)&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-(1/0)&&t<=this.o.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(n){n.preventDefault();var i=e(n.target).closest("span, td, th");if(1==i.length)switch(i[0].nodeName.toLowerCase()){case"th":switch(i[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var r=d.modes[this.viewMode].navStep*("prev"==i[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,r),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,r),1===this.viewMode&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"today":var a=new Date;a=t(a.getFullYear(),a.getMonth(),a.getDate(),0,0,0),this.showMode(-2);var o="linked"==this.o.todayBtn?null:"view";this._setDate(a,o);break;case"clear":var s;this.isInput?s=this.element:this.component&&(s=this.element.find("input")),s&&s.val("").change(),this._trigger("changeDate"),this.update(),this.o.autoclose&&this.hide()}break;case"span":if(!i.is(".disabled")){if(this.viewDate.setUTCDate(1),i.is(".month")){var l=1,c=i.parent().find("span").index(i),u=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(c),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(t(u,c,l,0,0,0,0))}else{var u=parseInt(i.text(),10)||0,l=1,c=0;this.viewDate.setUTCFullYear(u),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(t(u,c,l,0,0,0,0))}this.showMode(-1),this.fill()}break;case"td":if(i.is(".day")&&!i.is(".disabled")){var l=parseInt(i.text(),10)||1,u=this.viewDate.getUTCFullYear(),c=this.viewDate.getUTCMonth();i.is(".old")?0===c?(c=11,u-=1):c-=1:i.is(".new")&&(11==c?(c=0,u+=1):c+=1),this._setDate(t(u,c,l,0,0,0,0))}}},_setDate:function(e,t){t&&"date"!=t||(this.date=new Date(e)),t&&"view"!=t||(this.viewDate=new Date(e)),this.fill(),this.setValue(),this._trigger("changeDate");var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&n.change(),!this.o.autoclose||t&&"date"!=t||this.hide()},moveMonth:function(e,t){if(!t)return e;var n,i,r=new Date(e.valueOf()),a=r.getUTCDate(),o=r.getUTCMonth(),s=Math.abs(t);if(t=t>0?1:-1,1==s)i=-1==t?function(){return r.getUTCMonth()==o}:function(){return r.getUTCMonth()!=n},n=o+t,r.setUTCMonth(n),(0>n||n>11)&&(n=(n+12)%12);else{for(var l=0;s>l;l++)r=this.moveMonth(r,t);n=r.getUTCMonth(),r.setUTCDate(a),i=function(){return n!=r.getUTCMonth()}}for(;i();)r.setUTCDate(--a),r.setUTCMonth(n);return r},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))return void(27==e.keyCode&&this.show());var t,n,i,r=!1;switch(e.keyCode){case 27:this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;t=37==e.keyCode?-1:1,e.ctrlKey?(n=this.moveYear(this.date,t),i=this.moveYear(this.viewDate,t),this._trigger("changeYear",this.viewDate)):e.shiftKey?(n=this.moveMonth(this.date,t),i=this.moveMonth(this.viewDate,t),this._trigger("changeMonth",this.viewDate)):(n=new Date(this.date),n.setUTCDate(this.date.getUTCDate()+t),i=new Date(this.viewDate),i.setUTCDate(this.viewDate.getUTCDate()+t)),this.dateWithinRange(n)&&(this.date=n,this.viewDate=i,this.setValue(),this.update(),e.preventDefault(),r=!0);break;case 38:case 40:if(!this.o.keyboardNavigation)break;t=38==e.keyCode?-1:1,e.ctrlKey?(n=this.moveYear(this.date,t),i=this.moveYear(this.viewDate,t),this._trigger("changeYear",this.viewDate)):e.shiftKey?(n=this.moveMonth(this.date,t),i=this.moveMonth(this.viewDate,t),this._trigger("changeMonth",this.viewDate)):(n=new Date(this.date),n.setUTCDate(this.date.getUTCDate()+7*t),i=new Date(this.viewDate),i.setUTCDate(this.viewDate.getUTCDate()+7*t)),this.dateWithinRange(n)&&(this.date=n,this.viewDate=i,this.setValue(),this.update(),e.preventDefault(),r=!0);break;case 13:this.hide(),e.preventDefault();break;case 9:this.hide()}if(r){this._trigger("changeDate");var a;this.isInput?a=this.element:this.component&&(a=this.element.find("input")),a&&a.change()}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".datepicker-"+d.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var o=function(t,n){this.element=e(t),this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e}),delete n.inputs,e(this.inputs).datepicker(n).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};o.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.date}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){var n=e(t.target).data("datepicker"),i=n.getUTCDate(),r=e.inArray(t.target,this.inputs),a=this.inputs.length;if(-1!=r){if(i<this.dates[r])for(;r>=0&&i<this.dates[r];)this.pickers[r--].setUTCDate(i);else if(i>this.dates[r])for(;a>r&&i>this.dates[r];)this.pickers[r++].setUTCDate(i);this.updateDates()}},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var s=e.fn.datepicker;e.fn.datepicker=function(t){var r=Array.apply(null,arguments);r.shift();var s;return this.each(function(){var c=e(this),u=c.data("datepicker"),d="object"==typeof t&&t;if(!u){var h=n(this,"date"),p=e.extend({},l,h,d),f=i(p.language),m=e.extend({},l,f,h,d);if(c.is(".input-daterange")||m.inputs){var g={inputs:m.inputs||c.find("input").toArray()};c.data("datepicker",u=new o(this,e.extend(m,g)))}else c.data("datepicker",u=new a(this,m))}return"string"==typeof t&&"function"==typeof u[t]&&(s=u[t].apply(u,r),void 0!==s)?!1:void 0}),void 0!==s?s:this};var l=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,orientation:"auto",rtl:!1,startDate:-(1/0),startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},c=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=a;var u=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},d={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4===0&&e%100!==0||e%400===0},getDaysInMonth:function(e,t){return[31,d.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\x00").split("\x00"),n=e.match(this.validParts);if(!t||!t.length||!n||0===n.length)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(n,i,r){if(n instanceof Date)return n;if("string"==typeof i&&(i=d.parseFormat(i)),/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(n)){var o,s,l=/([\-+]\d+)([dmwy])/,c=n.match(/([\-+]\d+)([dmwy])/g);n=new Date;for(var h=0;h<c.length;h++)switch(o=l.exec(c[h]),s=parseInt(o[1]),o[2]){case"d":n.setUTCDate(n.getUTCDate()+s);break;case"m":n=a.prototype.moveMonth.call(a.prototype,n,s);break;case"w":n.setUTCDate(n.getUTCDate()+7*s);break;case"y":n=a.prototype.moveYear.call(a.prototype,n,s)}return t(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),0,0,0)}var p,f,o,c=n&&n.match(this.nonpunctuation)||[],n=new Date,m={},g=["yyyy","yy","M","MM","m","mm","d","dd"],v={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){if(isNaN(e))return e;for(t-=1;0>t;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!=t;)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}};v.M=v.MM=v.mm=v.m,v.dd=v.d,n=t(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0);var y=i.parts.slice();if(c.length!=y.length&&(y=e(y).filter(function(t,n){return-1!==e.inArray(n,g)}).toArray()),c.length==y.length){for(var h=0,w=y.length;w>h;h++){if(p=parseInt(c[h],10),o=y[h],isNaN(p))switch(o){case"MM":f=e(u[r].months).filter(function(){var e=this.slice(0,c[h].length),t=c[h].slice(0,e.length);return e==t}),p=e.inArray(f[0],u[r].months)+1;break;case"M":f=e(u[r].monthsShort).filter(function(){var e=this.slice(0,c[h].length),t=c[h].slice(0,e.length);return e==t}),p=e.inArray(f[0],u[r].monthsShort)+1}m[o]=p}for(var b,k,h=0;h<g.length;h++)k=g[h],k in m&&!isNaN(m[k])&&(b=new Date(n),v[k](b,m[k]),isNaN(b)||(n=b))}return n},formatDate:function(t,n,i){"string"==typeof n&&(n=d.parseFormat(n));var r={d:t.getUTCDate(),D:u[i].daysShort[t.getUTCDay()],DD:u[i].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:u[i].monthsShort[t.getUTCMonth()],MM:u[i].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};r.dd=(r.d<10?"0":"")+r.d,r.mm=(r.m<10?"0":"")+r.m;for(var t=[],a=e.extend([],n.separators),o=0,s=n.parts.length;s>=o;o++)a.length&&t.push(a.shift()),t.push(r[n.parts[o]]);return t.join("")},headTemplate:'<thead><tr><th class="prev">&laquo;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&raquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};d.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+d.headTemplate+"<tbody></tbody>"+d.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+d.headTemplate+d.contTemplate+d.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+d.headTemplate+d.contTemplate+d.footTemplate+"</table></div></div>",e.fn.datepicker.DPGlobal=d,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=s,this},e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var n=e(this);n.data("datepicker")||(t.preventDefault(),n.datepicker("show"))}),e(function(){e('[data-provide="datepicker-inline"]').datepicker()})}(e)}).call(t,n(3))},function(e,t,n){var i,r;i=[n(224),n(389),n(236),n(223),n(229),n(462)],r=function(e,t,n,i,r,a){"use strict";var o=r.extend({el:"#js_transactionCollection",template:"activity/transactionCollectionSimple",activeTransactionViews:[],initialize:function(e){this.viewContext=e.viewContext||"",this.country=e.country||"",this.statementLinks=e.statementLinks||[],e.showDetailedView&&"activity"===this.viewContext&&this.setViewTemplate("detailed"),this.listenTo(this.collection,"reset",this.render),this.listenTo(i,"displayMode:change",this.setViewTemplate),this.listenTo(i,"filter:triggerSearch",this.loadTransactions),this.listenTo(i,"transactionItem:toggleLoading",this.toggleTransactionLoading),this.listenTo(i,"transactionItem:toggleExpanded",this.toggleTransactionExpanded),this.listenTo(i,"transactionItem:viewRendered",this.cacheTransactionView),this.listenTo(i,"transactionDetails:toggleRequestedToShow",this.toggleTransactionDetails),"credit"!==this.viewContext&&this.renderCollectionSubViews()},loadTransactions:function(e){this.$el.toggleClass("hasSpinner",!0),this.collection.load(e)},serialize:function(){var t=this.collection.groupBy("grouping"),n={COMPLETED:e.invoke(t.COMPLETED,"toJSON"),PENDING:e.invoke(t.PENDING,"toJSON")};return n.viewContext=this.viewContext,n.country=this.country,n.data=this.collection.data,n.statementLinks=this.statementLinks,"credit"===this.viewContext&&(n.data={},n.hideStatusHeader=this.parent.model.id>0?!0:!1),n},afterRender:function(){"credit"!==this.viewContext&&(this.renderCollectionSubViews(),this.$el.toggleClass("hasSpinner",!1))},setViewTemplate:function(e){"detailed"===e?this.template="activity/transactionCollectionDetailed":this.template="activity/transactionCollectionSimple",this.displayMode=e,this.render()},renderCollectionSubViews:function(){e.invoke(this.activeTransactionViews,"remove"),this.activeTransactionViews.length=0,this.collection.each(function(e){var t=new a({viewContext:this.viewContext,model:e,displayMode:this.displayMode});e.set("wurfl",n),t.render()},this)},cacheTransactionView:function(t){this.activeTransactionViews.push(t),this.activeTransactionViews.length===this.collection.length&&("detailed"===this.displayMode?this.$(".js_transactionList tbody").remove():this.$(".js_transactionList").empty(),e.each(this.activeTransactionViews,function(e){"PENDING"===e.model.get("grouping")?this.$(".js_pendingModule .js_transactionList").append(e.$el):this.$(".js_completedModule .js_transactionList").append(e.$el),e.model.set("isAppended",!0)},this))},toggleTransactionDetails:function(e,t){this.collection.get(e).get("transactionDetailsModel").toggleRequestedToShow(t)},toggleTransactionLoading:function(e,t){var n,i=this.$el.find(".js_transactionItem-"+e),r=i.find("#transactionDetails-"+e),a=i.find("#js_spinnerLabelText-"+e).text(),o="js_spinner-txnId_"+e;t===!1?(this.$el.find("#"+o).remove(),r.attr("aria-busy",!1)):(n=this.createSpinner({transactionId:e,spinnerId:o,spinnerLabelText:a}),this.$el.append(n),this.$el.find("#"+o).focus(),r.attr("aria-busy",!0)),this.collection.get(e).toggleProp("isLoading",t)},createSpinner:function(e){var t=this.$el.find(".js_transactionItem-"+e.transactionId),n=document.createElement("div");return n.setAttribute("id",e.spinnerId),n.setAttribute("role","alert"),n.setAttribute("tabindex","-1"),n.setAttribute("aria-label",e.spinnerLabelText),n.setAttribute("class","detailedView hasSpinner"),n.setAttribute("style","position:absolute;width:"+(t.outerWidth()+2)+"px;height:"+t.outerHeight()+"px;top:"+t.position().top+"px;left:"+(t.position().left-2)+"px;"),n},toggleTransactionExpanded:function(e,t){var n=this.$el.find(".js_transactionItem-"+e);t===!1&&(n.find(".js_transactionDetails").attr("aria-busy",!1),this.$el.find("#txnDescription-"+e).focus()),this.collection.get(e).toggleProp("isExpanded",t)}});return o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(229),n(463),n(467)],r=function(e,t,n,i){"use strict";var r=t.extend({template:"activity/transactionItemSimple",events:{"click .js_linkedBlock":"checkNativeTDSupport","click .js_detailedTable-transactionItem_row":"invokeDetailsLink"},initialize:function(t){this.viewContext=t.viewContext||"",this.displayMode=t.displayMode||"simple",t&&t.displayMode&&this.setViewTemplate(t.displayMode),this.listenTo(this.model,"change:isExpanded",this.toggleDetailsExpanded),this.listenTo(this.model,"change:isAppended",this.handleYearDivider),this.listenTo(e,"displayMode:change",this.setViewTemplate)},_doRender:function(e){this.setElement(e)},afterRender:function(){var t=new i({id:this.model.get("transactionId")}),r=new n({model:t});r.setElement(this.$(".js_transactionDetails")),this.model.set("transactionDetailsModel",t),e.trigger("transactionItem:viewRendered",this)},toggleDetailsExpanded:function(e,t){var n=this.$el.find(".js_transactionDescriptionContainer");"detailed"===this.displayMode?(this.$el.find(".js_detailedTable-transactionItem_row").toggleClass("highlightTransactionRow",t),
this.$el.find(".js_detailedTable-transactionItem_actions").toggleClass("highlightTransactionRow",t)):this.$el.find(".js_transactionItem").toggleClass("highlightTransactionRow",t),n.attr("aria-expanded",t),t||this.$el.find(".js_transactionDetailsContainer a.js_linkedBlock").focus()},handleYearDivider:function(){this.model.get("hasYearDivider")&&this.$el.length>1&&this.setElement(this.$el.get(1))},setViewTemplate:function(e){"activity"===this.viewContext&&("detailed"===e?this.template="activity/transactionItemDetailed":this.template="activity/transactionItemSimple")},invokeDetailsLink:function(e){var t=this.$(e.currentTarget).find(".js_linkedBlock");t.focus().click()},checkNativeTDSupport:function(t){var n=this.$el.data("href")||"";t.preventDefault(),t.stopPropagation(),this.model.isInlineEnabled()?e.trigger("transactionDetails:toggleRequestedToShow",this.model.get("transactionId")):window.open(n,"_self")}});return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,,,,,,function(e,t,n){var i,r;i=[n(223),n(224),n(473)],r=function(e,t,n){"use strict";var i=e.Collection.extend({model:n,url:function(){return e.history.options.root+"activity"},initialize:function(){t.bindAll(this,"triggerReset")},parse:function(t){if(t.data&&t.data.activity){var n=t.data.activity,i=n.PENDING||[],r=n.COMPLETED||[];return this.data={user:t.data.user,links:t.data.links,startDate:n.startDate,endDate:n.endDate,couldHaveMore:n.couldHaveMore},e.trigger("transactionCollection:parse",this.data),i.concat(r)}return t.data},load:function(t){var n={data:t};t.isNewSearch?(n.url=e.history.options.root+"activity/filter",n.reset=!0):(n.url=e.history.options.root+"activity/loadMore",n.remove=!1,n.success=this.triggerReset),this.fetch(n)},triggerReset:function(){this.trigger("reset")}});return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({idAttribute:"transactionId",defaults:{actions:[],amount:0,status:"COMPLETED",isLoading:!1,isExpanded:!1,isAppended:!1},isInlineEnabled:function(){var e=this.get("actions").details,t=e&&e.nativeUrl,n=this.get("wurfl")&&this.get("wurfl").isSmartphone;return t&&!n},toggleProp:function(e,t){"undefined"==typeof t&&(t=!this.get(e)),this.set(e,t)}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,function(e,t,n){var i,r;i=[n(3),n(223),n(229),n(479),n(481),n(484),n(485),n(486),n(487),n(461),n(506),n(426),n(257),n(246),n(472),n(536),n(538),n(540),n(542),n(543),n(478),n(544),n(248),n(249),n(251),n(228),n(240),n(262),n(425),n(454),n(434),n(445),n(547),n(548),n(455),n(236),n(261),n(362),n(373),n(363)],r=function(e,t,n,i,r,a,o,s,l,c,u,d,h,p,f,m,g,v,y,w,b,k,C,_,D,x,T,E,M,S,A,N,P,O,I,B,F){"use strict";var L=n.extend({el:"#js_summaryView",events:{"click #js_dismissEngagementCoupon":"dismissEngagementCoupon","click #js_dismissEngagementUnilateral":"dismissEngagementUnilateral","click .engagement-coupon--terms-link":"showEngagementCouponTerms"},initialize:function(){var e=this.$el.data(),n=(e.transactions||[],e.hasTransactionsPending||!1,e.hasTransactionsCompleted||!1,e.transactionsPending||[]),i=e.transactionsCompleted||[],h=e.installments||[],g=e.showLoadbar,v=this.$el.data("padbankeligibility"),y=this.$el.data("paddefaultpayment"),w={hidePercentAnimation:"true",hideTransactionDelayMessage:"true"};g&&(this.loadErrorModuleMessagingView=new P),this.locality=e.locality,this.accttype=e.accttype,this.countryCode=e.country,this.addAddressTemplateCountry=e.addAddressTemplateCountry,this.linksConfig=e.linksConfig,this.linkAttributesConfig=e.linkAttributesConfig,this.sessionFlagModel=new d,this.sessionFlagModel.setSessionFlag(w,!0),this.initializeBalanceCollection(),this.initializeFundingOptionsCollections(e),B.isSmartphone?(this.engagementMobileModel=new o({overpanelContext:"home"}),this.engagementMobileView=new a({model:this.engagementMobileModel})):(this.engagementModuleView=new r,this.profilePhotoView=new O({uploadPhotoUrl:"/myaccount/photo"}),this.progressMeterView=new s,this.unconfirmedEmail=e.unconfirmedEmail),this.initializeFiModuleModelAndViews(),F.isTreatment("us_8ball_summary_alpha_treatment")||F.isTreatment("us_8ball_activity_experience_beta_treatment")?l("summary",e):(this.transactionCollection=new f(n.concat(i)),this.transactionCollectionView=new c({collection:this.transactionCollection,experiments:e.experiments,viewContext:"summary"})),h&&h.length>0&&(this.installmentCollection=new m(h),this.installmentCollectionView=new u({collection:this.installmentCollection})),this.addressCollection=new p(e.addresses),this.addressCollection.setHomeAddress(),"ENROLLED"===v&&y&&(this.payAfterDeliveryModuleView=new I({collection:this.bankCollection,el:this.$("#payafterdelivery"),padEligibilityStatus:v,fiId:this.$el.data("padbankid")})),this.initializeCreditProductView(e),this.listenTo(t,"showDelayMessage",this.showDelayMessage),this.listenTo(t,"mainContent:toggleLoading",this.toggleLoadingMain),this.withdrawFundsSpecsModel=new t.Model,this.withdrawFundsSpecsModel.set(e.withdrawfundsspecs)},showDelayMessage:function(e){this.$el.find(".js_txnDelayMessage").removeClass("hidden")},showEngagementCouponTerms:function(e){e.preventDefault(),this.$(e.target).siblings(".fullScreenTooltip").children("a").click()},measureElHeight:function(e,t){var n;n=e.addClass("toggle--render").outerHeight(),e.removeClass("toggle--render"),t(n)},dismissEngagementUnilateral:function(e){this.sessionFlagModel.setSessionFlag({hideEngagementUnilateral:"true"},!0),this.dismissEngagement(e)},dismissEngagementCoupon:function(e){this.sessionFlagModel.setSessionFlag({hideEngagementCoupon:"true"},!0),this.dismissEngagement(e)},dismissEngagement:function(t){function n(){r.addClass("toggle--hidden").removeClass("toggle--animate").removeClass("toggle--collapse").attr("aria-expanded","false")}var i=t.currentTarget,r=e(i).parents(".js_toggle--container");t.preventDefault(),this.sessionFlagModel.setSessionFlag({hideEngagementCoupon:"true"},!0),this.measureElHeight(r,function(e){r.removeClass("toggle--autoHeight").addClass("toggle--animate").height(e),setTimeout(function(){r.addClass("toggle--collapse").removeAttr("style")},25),""===document.body.style.transition?r.one("transitionend",n):setTimeout(n,550)})},initializeCreditProductView:function(e){var t=this.$("#creditProduct");t.length&&(this.creditProductView=new E({el:t,creditProduct:e.creditproduct,moduleContext:"summary"}))},initializeFundingOptionsCollections:function(e){this.bankCollection=new _(e.banks),this.cardCollection=new D(e.cards)},initializeBalanceCollection:function(){var e;e=this.$el.data("balance"),e.country=this.$el.data("country"),this.balanceCollection=new C(e.balanceDetails),this.balanceCollection.setBalanceData(e),this.balanceCollection.auth=this.$el.data("auth")},initializeBalanceActionsView:function(){this.paypalBalanceActionsView||(this.paypalBalanceActionsView=new M({model:new t.Model,collection:this.balanceCollection,bankCollection:this.bankCollection,cardCollection:this.cardCollection,locality:this.locality.currencyFormat,withdrawFundsSpecs:this.withdrawFundsSpecsModel,addFundsSpecs:this.$el.data("addfundsspecs"),viewContext:"summary",linksConfig:this.linksConfig,linkAttributesConfig:this.linkAttributesConfig})),this.toggleLoadingMain(!1)},initializeFiModuleModelAndViews:function(){var e,t,n,i,r,a=new g,o=new v;a.parse(this.cardCollection),o.parse(this.bankCollection),e=a.detectAlertTypeMix(),t=new y(e),n=new w({locale:this.locality.locale,country:this.countryCode}),n.parse({cardAlerts:a,bankAlerts:o}),i=new k({model:n,cardAlertCollection:a,bankAlertCollection:o,cardCollection:this.cardCollection,bankCollection:this.bankCollection,cardAlertMessagingModel:t}),t.get("numOfAlerts")&&(r=new b({cardCollection:this.cardCollection,cardAlertCollection:a,cardAlertMessagingModel:t}))},addAddress:function(e){this.addAddressView=this.addAddressView||new T({model:new t.Model({section:"home",newAddress:this.$el.data("add-new-address"),addAddressTemplateCountry:this.addAddressTemplateCountry}),collection:this.addressCollection}),this.addAddressView.model.set("addAddressReturnRoute",e||"home"),x.setContent(this.addAddressView)},toggleLoadingMain:function(e){this.$el.toggleClass("hasSpinner",e)},checkCIPStatus:function(){this.cipView||(this.cipView=new N({model:new h({countryCode:this.countryCode,accttype:this.accttype}),addressCollection:this.addressCollection}),this.listenTo(this.cipView.model,"change:state",this.cipStatus)),this.cipView.model.set({state:"checkStatus",section:"home"})},cipStatus:function(e){var t=e.get("state");("pass"===t||"success"===t)&&this.openBalanceAction("add",e.get("section"),t)},openBalanceAction:function(e,t,n){this.initializeBalanceActionsView(),this.paypalBalanceActionsView.template="wallet/overpanel/balance/"+e,this.paypalBalanceActionsView.updateViewState(e,t,n),this.paypalBalanceActionsView.model.set("countryCode",this.$el.data("country")),this.paypalBalanceActionsView.unsetModel("amount"),x.setContent(this.paypalBalanceActionsView)},initializeZeroBalanceAlertView:function(){this.zeroBalanceAlertView||(this.zeroBalanceAlertView=new S({model:new t.Model}))},openZeroBalanceAlert:function(e){this.initializeZeroBalanceAlertView(),this.zeroBalanceAlertView.updateViewWithSection(e),x.setContent(this.zeroBalanceAlertView)},initializeConfirmEmail:function(){this.confirmEmailView||(this.confirmEmailView=new i({model:new t.Model({section:"home",email:this.unconfirmedEmail.email,id:this.unconfirmedEmail.id})}))},openConfirmEmail:function(){this.initializeConfirmEmail(),x.setContent(this.confirmEmailView)}});return L}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(224),n(229),n(426)],r=function(e,t,n,i){"use strict";var r=n.extend({el:".js_fiModule-mobileAlertView",template:"summary/inc/fiModule/mobileAlert",events:{"click .js_fiModule-mobileAlertDismiss":"closeMobileAlert"},initialize:function(e){var t;this.cardCollection=e.cardCollection,this.cardAlertMessagingModel=e.cardAlertMessagingModel,this.cardAlertCollection=e.cardAlertCollection,t=this.cardAlertMessagingModel.get("numOfAlerts"),this.sessionFlagModel=new i,this.singleCardAlert=null,1===t&&(this.singleCardAlert=this.cardAlertMessagingModel.getSingleCardAlert(this.cardCollection,this.cardAlertCollection)),this.listenTo(this.cardAlertCollection,"alertsParsed",this.render),this.render(),(t>1||1===t&&this.singleCardAlert)&&this.$el.removeClass("hide")},serialize:function(){return{CREDIT:this.cardCollection.toJSON(),cardAlerts:this.cardAlertCollection.toJSON(),cardAlertMessaging:this.cardAlertMessagingModel.toJSON(),singleCardAlert:this.singleCardAlert}},closeMobileAlert:function(e){var t={hideFiModuleMobileAlert:"true"};e.preventDefault(),this.$el.addClass("hide"),this.sessionFlagModel.setSessionFlag(t,!0)}});return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(224),n(229),n(228),n(480)],r=function(e,t,n,i,r){"use strict";var a=n.extend({el:"#overpanel",template:"summary/inc/overlays/confirmEmail",events:{"click #js_unconfirmedEmail":"confirmEmail"},initialize:function(e){this.options=e},initWidgets:function(){},confirmEmail:function(){return this.$("#js_unconfirmedEmail").addClass("hide"),this.$("#js_confirmedEmailSent").removeClass("hide"),this.confirmEmailModel=new r({url:"/myaccount/email/confirm"}),this.confirmEmailModel.set("id",this.options.model.id),this.confirmEmailModel.save(),!1}});return a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return this.get("url")||e.history.options.root+"settings/email/confirm"},idAttribute:"confirm",defaults:{isDefault:!1},parse:function(e){return e.data}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(223),n(229),n(426),n(482),n(483)],r=function(e,t,n,i,r,a){"use strict";var o=n.extend({el:"#js_engagementModuleView",events:{"click .js_selectModule":"selectModule","click .js_dismiss":"closeEmContainer","click .js_engagementSneakPeek-trigger":"showFullModule","mouseenter .js_setupStep":"hideInitialAction"},initialize:function(){var t,n=this.$el.find("#js_emSlideDownContainer"),o=this.$el.data(),s=this.$el.find(".js_selectModule"),l=this.$el.find(".js_emModule"),c=this.$el.find(".js_mpiOffer"),u=0,d=0,h=0,p=s.length,f=l.length,m=c.length,g=[],v=this.$el.find("#js_emSlideDownContainer").data(),y=v.hideAccountCompletion,w=v.hideSneakPeek,b="none"===this.$el.find("#js_engagementActions").css("display"),k=!y&&!w&&!b;for(this.hasCalled=[],this.engagementModel=new a,u;f>u;u++)e(l[u]).data("bg-img")&&(t=e(l[u]).data("bg-img"),e("body").append('<img class="renderToCache" src='+t+">"),l[u].style.backgroundImage="url("+t+")",e(".renderToCache").remove());for(d;p>d;d++)s[d].setAttribute("data-module-number",d),k&&l[d].getAttribute("data-is-sneak-peek-available")&&g.push(d);for(h;m>h;h++)this.trackingCall("GET",c[h].getAttribute("data-offer-impression"));this.engagementModel.set("isEmOpen",this.$el.find("#js_emSlideDownContainer").data("em-open")),this.engagementModel.set("currentModule",n.data("current-module")),this.engagementModel.set("hasCssTransition",""===document.body.style.transition),!this.engagementModel.get("isEmOpen")&&g.length&&this.showSneakPeek(n,s,g),this.$el.find("#js_emSlideDownContainer").attr("aria-expanded",this.engagementModel.get("isEmOpen")),this.showHideInitialAction(),this.sessionFlagModel=new i,this.sessionFlagModel.set({hideAccountCompletion:y}),o.engagementBadges.isUserEnrolledForBadge&&(this.profileStateContainerView=new r({}))},trackingCall:function(t,n){n&&-1===this.hasCalled.indexOf(n)&&(this.hasCalled.push(n),e.ajax({type:t,url:n,ignoreErrors:!0}))},selectModule:function(t){var n=this,i=t.currentTarget,r={currentInt:parseInt(n.engagementModel.get("currentModule"),10),requestedInt:parseInt(i.getAttribute("data-module-number"),10),offerClickTracking:i.getAttribute("data-offer-click"),bannerImpressionTracking:i.getAttribute("data-banner-impression"),sneakPeekClickTracking:i.getAttribute("data-sneak-peek-click"),sneakPeekImpressionTracking:i.getAttribute("data-sneak-peek-impression"),$container:n.$el.find("#js_emSlideDownContainer"),$emModules:n.$el.find(".js_emModule"),$trigger:e(i).is("a")||e(i).is("button")?e(i):e(i).find(".js_emTrigger")},a=this.$el.find("#js_BadgeLanding").find(".active"),o=this.$el.find("#js_BadgeLanding").find("#profileStateContainer").find(".js_badges");return a.removeClass("active").addClass("hide"),0===r.requestedInt&&o.removeClass("hide").addClass("active"),this.showHideInitialAction(),this.engagementModel.lastTrigger=r.$trigger,r.$container.hasClass("animate")||r.$container.hasClass("animate_sneakPeek")||e(t.currentTarget).find("a").height()<0?!1:"js_toggleProfileStatus"===r.$trigger.context.id&&"js_engagementActionTrigger"!==t.target.id?(this.$el.find(".js_emTrigger").click(),!1):(t.preventDefault(),void(null===r.currentInt||window.isNaN(r.currentInt)?(this.openEmAndSetActive(r),this.engagementModel.get("isSneakPeekOpeningSequence")||this.trackingCall("GET",r.offerClickTracking)):r.currentInt===r.requestedInt?this.engagementModel.get("isSneakPeekOpen")?this.showFullModule(null,r):this.closeEmAndUnsetActive(r):(this.trackingCall("GET",r.offerClickTracking),this.slideToRequestedEmOffer(r))))},findSelectModuleTrigger:function(e){var t;return t=e.$trigger.hasClass("js_selectModule")?e.$trigger:e.$trigger.parents(".js_selectModule")},openEmAndSetActive:function(t){function n(){r.removeClass("animate"),i.engagementModel.get("isSneakPeekOpeningSequence")?(i.engagementModel.set({isSneakPeekOpeningSequence:!1,isSneakPeekOpen:!0}),i.trackingCall("GET",t.sneakPeekImpressionTracking),i.sessionFlagModel.setSessionFlag(a,!0)):i.trackingCall("GET",t.bannerImpressionTracking)}var i=this,r=this.findSelectModuleTrigger(t),a={hideSneakPeek:!0};this.toggle(t.$container,t.$trigger,t.$emModules[t.requestedInt]),e(t.$emModules[t.requestedInt]).addClass("active"),this.engagementModel.set("currentModule",t.requestedInt),r.addClass("animate"),setTimeout(function(){r.addClass("active")},25),this.engagementModel.get("hasCssTransition")?t.$container.one("transitionend",n):setTimeout(n,550)},closeEmAndUnsetActive:function(t){function n(){i.engagementModel.set("currentModule",null),e(t.$emModules[t.currentInt]).removeClass("active"),r.removeClass("animate")}var i=this,r=this.findSelectModuleTrigger(t);this.toggle(t.$container,t.$trigger,t.$emModules[t.requestedInt]),r.addClass("animate"),setTimeout(function(){r.removeClass("active")},25),this.engagementModel.get("hasCssTransition")?t.$container.one("transitionend",n):setTimeout(n,550)},slideToRequestedEmOffer:function(t){function n(){t.$container.removeClass("animate").removeClass("animate_sneakPeek").addClass("autoHeight").removeClass("slideRightStart").removeClass("slideRightEnd").removeClass("slideLeftStart").removeClass("slideLeftEnd").removeAttr("style"),e(t.$emModules[t.currentInt]).removeClass("active"),c.removeClass("animate"),u.removeClass("animate"),o.trackingCall("GET",t.bannerImpressionTracking)}function i(){t.$container.height(o.engagementModel.get("currentModuleHeight")),o.hideSneakPeek(t.$container,l),o.engagementModel.get("hasCssTransition")?t.$container.one("transitionend",n):setTimeout(n,550)}var r,a,o=this,s=t.currentInt<t.requestedInt,l=e(t.$emModules[t.currentInt]),c=this.$el.find(".js_engagementMainBar-container").find(".active"),u=this.findSelectModuleTrigger(t);this.engagementModel.get("isSneakPeekOpen")&&(this.engagementModel.set("isSneakPeekOpen",!1),r=!0,o.triggerPullTabAnimation(!1)),s?t.$container.height(o.engagementModel.get("currentModuleHeight")).addClass("slideRightStart").attr("aria-label",t.$trigger.text()).focus():t.$container.height(o.engagementModel.get("currentModuleHeight")).addClass("slideLeftStart").attr("aria-label",t.$trigger.text()).focus(),e(t.$emModules[t.requestedInt]).addClass("active"),r?t.$container.addClass("animate_sneakPeek"):t.$container.addClass("animate"),c.addClass("animate"),setTimeout(function(){c.removeClass("active")},25),u.addClass("animate"),setTimeout(function(){u.addClass("active"),s?t.$container.addClass("slideRightEnd"):t.$container.addClass("slideLeftEnd"),setTimeout(function(){o.measureElHeight(t.$emModules[t.requestedInt],!0,function(e){r||t.$container.height(e)}),o.engagementModel.set("currentModule",t.requestedInt),a=r?i:n,o.engagementModel.get("hasCssTransition")?t.$container.one("transitionend",a):setTimeout(a,550)},50)},25)},measureElHeight:function(t,n,i){var r;r=e(t).addClass("showEl").outerHeight(),n&&this.engagementModel.set("currentModuleHeight",r),e(t).removeClass("showEl"),i(r)},toggle:function(t,n,i){function r(){t.removeClass("animate").removeClass("collapseEm").addClass("autoHeight").removeAttr("style"),t.attr("aria-expanded",o.engagementModel.get("isEmOpen")).attr("aria-label",n.text()).focus(),l&&(o.engagementModel.set("isSneakPeekOpen",!1),s.find(".js_engagementSneakPeek").removeClass("animate"),n.removeClass("animate"),o.hideSneakPeek(t,s)),o.showHideInitialAction()}function a(){t.addClass("hide").removeClass("animate").attr("aria-expanded","false"),l&&(o.engagementModel.set("isSneakPeekOpen",!1),o.hideSneakPeek(t,s))}var o=this,s=this.$(i),l=this.engagementModel.get("isSneakPeekOpen");l&&!n.hasClass("js_dismiss")?(this.engagementModel.set("isEmOpen",!0),n.addClass("animate"),t.height(o.engagementModel.get("sneakPeekModuleHeight")).removeClass("autoHeight"),s.removeClass("emModule_sneakPeek").find(".js_engagementSneakPeek").addClass("animate"),setTimeout(function(){t.addClass("animate"),o.measureElHeight(i,!0,function(e){s.find(".js_engagementSneakPeek").removeClass("active"),n.removeClass("selectModule_sneakPeek"),o.engagementModel.set("currentModuleHeight",e),t.height(e).find(".js_engagementSneakPeek-overlay").removeClass("active"),o.triggerPullTabAnimation(!1),o.engagementModel.get("hasCssTransition")?t.one("transitionend",r):setTimeout(r,550)})},25)):this.engagementModel.get("isEmOpen")?(this.engagementModel.set("isEmOpen",!1),e("body").off("keyup.closeEm"),this.sessionFlagModel.get("hideAccountCompletion")||this.setSessionFlag(),this.measureElHeight(i,!0,function(e){t.removeClass("autoHeight").height(e).attr("aria-label",""),setTimeout(function(){t.addClass("animate"),setTimeout(function(){t.addClass("collapseEm").removeAttr("style"),l&&o.triggerPullTabAnimation(!1)},25)},25),o.engagementModel.get("hasCssTransition")?t.one("transitionend",a):setTimeout(a,550)})):(this.engagementModel.set("isEmOpen",!0),e("body").on("keyup.closeEm",this,o.closeEmContainerOnEsc),t.removeClass("hide").addClass("animate"),this.measureElHeight(i,!0,function(e){setTimeout(function(){t.height(e),o.engagementModel.get("isSneakPeekOpeningSequence")&&o.triggerPullTabAnimation(!0)},25),o.engagementModel.get("hasCssTransition")?t.one("transitionend",r):setTimeout(r,550)}))},closeEmContainer:function(t){function n(){c.engagementModel.set("currentModule",null),i.removeClass("active"),r.removeClass("active").addClass("hide"),a.removeClass("hide").addClass("active")}var i=this.$el.find("#js_emSlideDownContainer").find(".active"),r=this.$el.find("#js_BadgeLanding").find(".active"),a=this.$el.find("#js_BadgeLanding").find("#profileStateContainer").find(".js_badges"),o=this.$el.find("#js_emSlideDownContainer"),s=e(t.currentTarget),l=this.$el.find(".js_engagementMainBar-container").find(".active"),c=this;t.preventDefault(),l.addClass("animate"),setTimeout(function(){l.removeClass("active")},25),this.toggle(o,s,i),this.engagementModel.lastTrigger&&this.engagementModel.lastTrigger.focus(),this.engagementModel.get("hasCssTransition")?o.one("transitionend",n):setTimeout(n,550)},closeEmContainerOnEsc:function(e){27===e.keyCode&&e.data.closeEmContainer(e)},toggleProfileStatus:function(e){e.preventDefault(),this.profileView.toggle()},hideSneakPeek:function(e,t){e.find(".js_engagementSneakPeek-overlay").removeClass("active"),t.removeClass("emModule_sneakPeek").find(".js_engagementSneakPeek").addClass("hide").end().find(".js_mpiBannerContainer").removeClass("hide"),this.$(".js_selectModule_sneakPeek").removeClass("selectModule_sneakPeek").removeClass("js_selectModule_sneakPeek")},showSneakPeek:function(t,n,i){var r=this,a=Math.floor(Math.random()*i.length),o=i[a],s=this.$(".js_emModule"),l=e(s[o]),c=l.data("sneakPeekTexts"),u=l.data("sneakPeekLinkName"),d=Math.floor(Math.random()*c.length),h=u[d],p=c[d];l.find(".js_engagementSneakPeek-trigger").attr("name",h),l.find(".js_engagementSneakPeek-content").text(p),l.addClass("emModule_sneakPeek").find(".js_engagementSneakPeek").addClass("active").removeClass("hide"),t.removeClass("hide"),this.measureElHeight(s[o],!1,function(e){r.engagementModel.set({isSneakPeekOpeningSequence:!0,sneakPeekModuleHeight:e}),r.engagementModel.get("isEmOpen")||t.addClass("hide"),t.find(".js_engagementSneakPeek-overlay").addClass("active"),setTimeout(function(){r.$(n[o]).addClass("js_selectModule_sneakPeek").addClass("selectModule_sneakPeek").click()},25)})},showFullModule:function(t,n){var i=this.$(".js_selectModule.active"),r=this.$(".js_emModule.active"),a=r.parents("#js_emSlideDownContainer"),o=i.data("bannerImpression");t?this.trackingCall("GET",e(t.currentTarget).data("sneakPeekClick")):this.trackingCall("GET",n.offerClickTracking),this.trackingCall("GET",o),this.toggle(a,i,r)},triggerPullTabAnimation:function(e){function t(){i.removeClass("animate")}var n=this,i=this.$(".js_engagementSneakPeek-pullTab");i.addClass("animate"),setTimeout(function(){e?i.addClass("active"):i.removeClass("active"),n.engagementModel.get("hasCssTransition")?i.one("transitionend",t):setTimeout(t,250)},50)},showHideInitialAction:function(){var e=this.$el.find(".js_setupStep.isShown"),t=this.$el.find(".js_setupStep").first(),n=this.engagementModel.get("isEmOpen");n&&0===e.length?t.addClass("isShown"):e.removeClass("isShown")},hideInitialAction:function(){var e=this.$el.find(".js_setupStep.isShown");e.removeClass("isShown")},setSessionFlag:function(){var e={hideAccountCompletion:"true"};this.sessionFlagModel.setSessionFlag(e,!0)}});return o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229)],r=function(e,t){"use strict";return t.extend({el:"#js_BadgeLanding",template:"summary/inc/profileStateContainer",events:{"click .js_badgeLink":"toggleBadgeContent"},toggleBadgeContent:function(t){var n=e(t.currentTarget),i=e(n.data("container"));t.preventDefault(),this.$el.find(".active").addClass("hide").removeClass("active"),i.removeClass("hide").addClass("active"),this.$el.parent().focus()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{currentModule:null,currentModuleHeight:null,sneakPeekModuleHeight:null,isSneakPeekOpen:!1,isSneakPeekOpeningSequence:!1,isEmOpen:!1,hasCssTransition:!1,lastTrigger:null}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(223),n(229),n(228)],r=function(e,t,n,i){"use strict";var r=n.extend({el:"#js_engagementModuleView",events:{"click .js_engagementOffer-item_mobile":"setOfferTrigger"},initialize:function(e){this.options=e,this.listenTo(this.model,"change:lastTrigger",this.handleOfferSelection)},setOfferTrigger:function(t){var n=e(t.currentTarget).data("engagementMobileOfferType");t.preventDefault(),this.model.unset("lastTrigger",{silent:!0}),this.model.set("lastTrigger",n)},initializeBannerView:function(){this.bannerView||(this.bannerView=new n({model:this.model,el:"#overpanel"}),this.bannerView.template="widgets/overpanel")},handleOfferSelection:function(t){var n=t.get("lastTrigger"),r="#js_engagementBanner-container_"+n+"Mobile",a=e(r).html();this.model.set("overpanelClass","engagementBanner-background_"+n+"Mobile"),this.initializeBannerView(),i.setContent(this.bannerView),this.bannerView.$el.find(".overpanel-body").html(a)}});return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{lastTrigger:null,overpanelClass:null}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(223),n(229),n(426)],r=function(e,t,n,i){"use strict";var r=n.extend({el:"#js_progressMeterView",template:"summary/inc/outerCircle",events:{click:"doNothing"},initialize:function(){var e,n,r;this.totalPercentage=this.$el.attr("data-total-percentage"),r=this.$el.data("hide-percent-animation")===!0,this.sessionFlagModel=new i,this.sessionFlagModel.set({hidePercentAnimation:r}),this.totalPercentage<50?(this.$el.find(".js_greaterThan50").addClass("hide"),n=this.totalPercentage/100*360,e=0):(n=180,e=(this.totalPercentage-50)/100*360),this.model=new t.Model({rightPercentage:n,leftPercentage:e}),this._doRender=function(e){this.$(".outerCircle").html(e)},this.afterRender=this.animatePercentNumeral,this.render()},animatePercentNumeral:function(){function e(){i>a&&"100"!==i&&!r?(a+=2,t.text(o.replace(s,a)),setTimeout(function(){l(e)},50)):(i&&t.text(o.replace(s,i)),setTimeout(function(e){e.addClass("fadeOut")},1750,t),setTimeout(function(e){e.addClass("hide"),e.removeClass("percentage")},2500,t))}var t=this.$el.find("#js_percentage"),n=this.$el.find("#js_percentageContainer"),i=this.totalPercentage,r=this.sessionFlagModel.get("hidePercentAnimation"),a=i%2*-1,o=t.text(),s=/\b\d+\b/,l=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(e){e()};n.removeClass("hide"),e()},doNothing:function(e){e.preventDefault(),e.stopPropagation()}});return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},,,,,,,,,,,,,,,,,,,,function(e,t,n){var i,r;i=[n(3),n(224),n(223),n(229),n(507)],r=function(e,t,n,i,r){"use strict";var a=i.extend({el:"#js_installmentCollection .js_installmentListView",itemViews:[],initialize:function(){this.listenTo(n,"installmentItem:toggleLoading",this.toggleViewLoading),this.listenTo(n,"installmentItem:toggleExpanded",this.toggleViewExpanded),this.listenTo(n,"installmentDetails:toggleRequestedToShow",this.toggleDetailsRequestedToShow),this.itemViews=this.collection.map(function(e){return new r({model:e,el:this.$("#js_installmentItem_"+e.get("promoId"))})},this)},toggleViewExpanded:function(e,t){this.collection.get(e).toggleProp("isExpanded",t)},toggleDetailsRequestedToShow:function(e,t){var n=this.collection.get(e);n.installmentDetailsModel&&n.installmentDetailsModel.toggleRequestedToShow(t)}});return a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(230),n(224),n(229),n(508),n(535)],r=function(e,t,n,i,r,a){"use strict";var o=i.extend({template:"activity/installmentItem",events:{"click .js_linkedBlock":"triggerExpansion"},initialize:function(){var e,t,n,i;this.listenTo(this.model,"change:isExpanded",this.myToggleExpanded),this.model.canExpand()&&(n=this.model.get("originalTransactionAmount"),i=this.model.get("nextPaymentDue"),e=new a({id:this.model.get("promoId"),transactionDate:this.model.get("transactionDate"),originalTransactionAmount:n&&n.amount,interestRate:this.model.get("interestRate"),nextPaymentDueDate:this.model.get("nextPaymentDueDate"),transactionDescription:this.model.get("transactionDescription"),nextPaymentDueAmount:i&&i.amount,currentBalance:this.model.get("balance"),isCloseEndedCredit:this.model.get("isCloseEndedCredit")}),t=new r({model:e}),t.setElement(this.$(".paymentPlansDescWrapper")),this.model.installmentDetailsModel=e)},triggerExpansion:function(t){t.preventDefault(),e.trigger("installmentDetails:toggleRequestedToShow",this.model.get("promoId"))},myToggleExpanded:function(t,n){var i=this.$el.find(".js_installmentDescriptionContainer");this.$el.toggleClass("highlightInstallmentRow",n),i.attr("aria-expanded",n),n?e.trigger("trackLink",null,"installmentViewExpanded","main:walletweb:summary:installmentview"):(e.trigger("trackLink",null,"installmentViewCollapsed","main:walletweb:summary:installmentview"),this.$el.find(".js_creditPromotion-link").focus())}});return o}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(224),n(464),n(509),n(533)],r=function(e,t,n,i,r){"use strict";var a=n.extend({template:"activity/installmentDetails",events:function(){return t.extend({},n.prototype.events,{"click .js_viewActivitiesBtn":"showActivity","click .js_changeBank":"changeBank","click .js_addPayment":"addPayment"})},eventPrefix:"installmentItem",initialize:function(){this.listenTo(this.model,"change:requestedToShow",this.showHideWithPossiblePreliminaryFetch)},triggerRender:function(){this.render()},showActivity:function(e){this.paymentInstallmentView=new r({id:this.model.get("id"),remainingBalance:this.model.get("currentBalance").amount}),e.preventDefault()},changeBank:function(e){i.startPaymentFlow(e),e.preventDefault()},addPayment:function(e){i.startPaymentFlow(e),e.preventDefault()}});return a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229),n(510),n(530),n(228)],r=function(e,t,n,i,r){"use strict";var a=t.extend({el:".credit",events:{"click #makePaymentPlaceHolder, .startCreditPaymentFlow":"startPaymentFlow"},initialize:function(){this.el=this.el||".credit"},startPaymentFlow:function(t){t&&t.preventDefault();var a,o,s,l,c,u,d,h=t?e(t.currentTarget):null,p=h?h.data("paymentoperationtype"):"create",f=h?h.data("paymenttype"):"onetime",m=e("body").data("iswireless")||!1,g=!1,v="recurring"===f;h&&(a=h.data("paymentid"),s=h.data("installmentdata"),s&&(a=s.id,g=s.isCloseEndedCredit,l=s.currentBalance,c=s.nextPaymentDueAmount,u=s.nextPaymentDueDate,d=s.transactionDescription)),o={operationType:p,paymentType:f,isMobile:m,isCloseEndedCredit:g},a&&(o.paymentId=a||""),this.paymentModelInstance&&this.paymentModelInstance.destroy(),g&&(v||(o.remainingBalance=l),o.nextPaymentDueAmount=c,o.nextPaymentDueDate=u,o.transactionDescription=d),this.paymentViewInstance?this.paymentViewInstance.initialize(o):this.paymentViewInstance=g?new i(o):new n(o),r.setContent(this.paymentViewInstance,{
className:"payment-flow"})}});return new a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(511),n(526),n(529)],r=function(e,t,n){"use strict";return e.extend({fetchPaymentModel:function(e){this.resetPaymentFlowFlags(),this.model=new t(e)},getPaymentFIModel:function(){return n}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(224),n(223),n(229),n(512),n(513),n(514),n(515),n(519),n(389),n(228),n(520),n(245),n(340),n(328),n(352),n(266),n(260),n(521),n(522),n(524),n(525),n(460),n(362),n(373),n(363)],r=function(e,t,n,i,r,a,o,s,l,c,u,d,h,p,f,m,g,v,y,w,b,k){"use strict";var C=i.extend({formName:"payment",paymentSubmitted:!1,paymentView:{},events:{"click .paymentOptions li:not(.selected)":"togglePayment","focus .paymentOptions li:not(.selected) #amount, .fixedType":"selectOtherAmount","focus .radioButton":"togglePaymentForFocus","click #reviewPayment":"showReviewPaymentModal","click .changePaymentLink":"togglePaymentView","click #makePayment:not(.disabled), #submitModifyPayment, #submitCancelPayment":"submitPayment","click .fundingSourceList li:not(.addBankCardLink)":"updatePaymentSource","click .paymentMethod":"showPaymentMethods","click .gotoPayPalCredit, .dismiss.close":"closePaymentModal","click .addBankCardLink, .addBankCardLinkError":"showAddBankFlow","focusout .paymentOptions .otherAmount input#amount":"setFixedAmount","click #onetimePaymentTab:not(.active)":"fetchOnetimePaymentInfo","click #recurringPaymentTab:not(.active)":"fetchRecurringPaymentInfo","focusout #scheduledDate":"validateScheduleDate","focusout #amount":"formatAmount","click #showCreditPaymentActivities":"showPaymentActivities","click #downloadStatementPayingByMail":"downloadStatementPayingByMail","click #updateBank":"updateBank"},template:"payment/index",initialize:function(t){var i;this.fetchPaymentModel(t),i=this.getPaymentFIModel(),this.model.set({latestStatementId:e(".credit").data("lateststatementid")}),this.adjustedBalanceModel=new a,this.adjustedBalanceView=new l({model:this.adjustedBalanceModel}),this.reviewPaymentModel?this.reviewPaymentModel.initialize(this.model.options):this.reviewPaymentModel=new r(this.model.options),this.reviewPaymentView||(this.reviewPaymentView=new o({model:this.reviewPaymentModel})),this.slideOutReference="#overpanel",this.$slideOutReference=e(this.slideOutReference),this.accessAid=[],this.paymentSidePanelView=new d({el:"#sidepanelpayment",slideOutReference:this.slideOutReference,focusSelectorOnClose:".paymentSidepanelVertialBar"}),this.paymentSidePanelView.onSidepanelClose=function(){u.shouldListenToEsc(!0)},this.listenTo(this.model,"change",this.render),this.listenTo(this.adjustedBalanceModel,"change",this.adjustedBalanceView.render),this.listenTo(n,"replaceBank",this.replaceBank),this.adjustedBalanceModel.set({showPayingByEmail:this.model.get("showPayingByEmail"),showOnlyAdjustedBalance:this.model.get("showOnlyAdjustedBalance"),isPaymentBalanceAdjusted:this.model.get("isPaymentBalanceAdjusted")}),this.alertView=this.alertView||new v,this.alertView.template="wallet/walletAlertDialogs",this.agreementView=this.agreementView||new f,this.addBankConfirmYodleeView=this.addBankConfirmYodleeView||new g({model:new n.Model}),this.addBankConfirmYodleeView.model.set("viewContext","credit"),this.paymentFIModel=new i({paymentId:this.model.get("paymentId"),isRecurringPayment:this.model.get("isRecurringPayment")})},getPaymentModel:function(){return this.$(".paymentModelData").data("paymentmodel")||{}},togglePaymentForFocus:function(e){var t=this.$(e.currentTarget).parent().parent();this.togglePayment(t)},togglePayment:function(e){var t,n=e.currentTarget?this.$(e.currentTarget):e,i=this.$(".paymentOptions .selected input:radio[name=paymentOptionType]:checked").val(),r=this.getPaymentModel(),a=!1;n.hasClass("otherAmount")&&(a=!0),i&&r.paymentOptions&&(r.paymentOptions[i].selected=!1),this.cleanState(n),t=this.$(".paymentOptions .selected input:radio[name=paymentOptionType]:checked").val(),t&&r.paymentOptions&&(r.paymentOptions[t].selected=!0,r.paymentOptions&&r.paymentOptions[t]&&(r.selectedPaymentValue=r.paymentOptions[t].value,r.showOtherAmountInfo=this.model.showOtherAmountInfo(r.paymentOptions))),a||("create"===this.model.get("operationType")&&r.paymentOptions&&r.paymentOptions.FIXED&&(this.$("#amount").val(""),r.paymentOptions.FIXED.value=""),this.$(".otherAmount").find(".textInput").removeClass("hasError"),r.paymentOptions&&r.paymentOptions.FIXED&&(r.paymentOptions.FIXED.selected=!1)),r.isPaymentBalanceAdjusted=this.model.isPaymentBalanceAdjusted(r.paymentOptions),this.accessAid.push(".paymentOptions .selected input:radio[name=paymentOptionType]"),this.model.set(r,{silent:!r.isRecurringPayment}),this.adjustedBalanceModel.set({isPaymentBalanceAdjusted:r.isPaymentBalanceAdjusted}),a&&this.$("#amount").focus()},cleanState:function(e){this.$("#paymentPlan-help-error").removeClass("open"),this.$("#amount-help-error").removeClass("open"),e.parent().find(".selected").removeClass("selected"),e.toggleClass("selected"),this.$(".paymentOptions .selected input:radio[name=paymentOptionType]").prop("checked",!0)},selectOtherAmount:function(e){var t=this.$(e.currentTarget);this.$(".fixedType").find(".textInput").removeClass("hasError"),this.model.get("isCreditPayment")&&!t.hasClass("selected")&&(t=this.$(".paymentOptions li.otherAmount"),this.togglePayment(t))},updatePaymentSource:function(e){var t,n,i=this.$(e.currentTarget),r=i.data("funding_source_id"),a=i.data("funding_source_short_label"),o={},s=[],l=this.$(".paymentMethodError");return l.removeClass("hasError"),r=r?r.toString():r,null===r?!0:(this.$("#paymentOptions").val(r),i.parent().find(".isSelected").removeClass("isSelected"),i.addClass("isSelected"),t=this.getPaymentModel(),n=t.eligibleWalletInstruments,n.forEach(function(e){e.funding_source_id===r?(e.selected=!0,o=e):e.selected=!1,s.push(e)}),o.funding_source_last_n?o.funding_source_label=o.issuer_name+" - "+o.funding_source_last_n:o.issuer_name=this.$("#paymentMethodLabel").data("issuer_name")+" - "+o.totalAvailable,o.shortIssuerName=this.model.getShorterIssuerName(o.issuer_name),t.selectedWalletInstruments=o,t.eligibleWalletInstruments=s,this.model.set(t,{silent:!!a}),a&&(this.$(".js_paymentMethod-icon").removeClass("hide icon-pp-logo icon-bank-half-solid paymentFI-icon_ppLogo paymentFI-icon_bank").addClass("PAYPAL_BALANCE"===o.funding_source_type?"icon-pp-logo paymentFI-icon_ppLogo":"icon-bank-half-solid paymentFI-icon_bank"),this.$("#paymentMethodLabel").text(a),this.$(".paymentModelData").data("paymentmodel",this.model.toJSON())),void this.paymentSidePanelView.hideSidePanelWithDelay())},showPaymentMethods:function(){this.$slideOutReference.removeClass("fadeInUpBig"),this.paymentSidePanelView.showSidePanel(),u.shouldListenToEsc(!1),this.$(".sidepanel.payment").focus()},togglePaymentView:function(){this.setOverpanelContent(this.paymentView)},showAddBankFlow:function(t){var i,r=this.model.get("countryCode"),a=this,o=this.model.get("banksCount"),s=this.model.get("user"),l=this.model.get("wallet"),c=this.model.get("fabExperimentation"),u=e("body").data("frictionlessnoteligible");o>=h.wallet.bank.MAX_BANKS_LIMIT?this.alertView.showAlert("meetMaxBank"):(this.paymentSidePanelView.hideSidePanel(),this.addBankView||(i=new n.Model({username:s.fullname,firstname:s.firstname,lastname:s.lastname,userdob:s.dateOfBirth,birthyearlist:l.birthYearList,bankSpecs:l.config.bankSpecs,countryCode:r,viewContext:"credit",frictionlessNotEligible:u,fabExperimentation:c}),this.addBankView=new p({model:i,collection:new n.Collection}),this.addBankView.alertView=this.alertView,this.addBankView.agreementView=this.agreementView,this.addBankView.template="wallet/overpanel/bank/entryForm/addBank_"+r,this.addBankView.skipBankConfirm=!0,this.addBankView.doCustomAction=function(e){a.showAddBankDone(r,e)}),!u&&c?(this.bankFABList||(this.bankFABList=new m({model:this.addBankView.model,collection:new n.Collection}),this.bankFABList.model.set("viewContext","credit"),this.bankFABList.model.set("sourceFlowURL","/myaccount/credit"),this.bankFABList.addBankConfirmYodleeView=this.addBankConfirmYodleeView,this.bankFABList.addBankConfirmYodleeView.triggerPaymentFlow=function(){a.updateFISidePanel(r,t)},this.bankFABList.addBankView=this.addBankView),this.setOverpanelContent(this.bankFABList),n.trigger("trackLink",null,"add","main:credit:payment:add:fab")):(this.setOverpanelContent(this.addBankView),n.trigger("trackLink",null,"add","main:credit:payment:add:bankadd")))},replaceBank:function(){n.trigger("bankReplaced")},showAddBankDone:function(e,t){this.addBankDoneView=this.addBankDoneView||new y({isRecurringPayment:this.model.get("isRecurringPayment"),creditType:this.model.get("creditType"),paymentId:this.model.get("paymentId")}),this.addBankDoneView.parentView=this,this.addBankDoneView.countryCode=e,this.addBankDoneView.bankDetails=t,this.setOverpanelContent(this.addBankDoneView)},updateFISidePanel:function(e,t){var n=this;this.toggleLoading(!0),this.paymentFIModel.fetch({success:function(){n.showUpdatedFISidePanel(t)}})},showUpdatedFISidePanel:function(e){var t,n=this.model.get("countryCode");switch(this.toggleLoading(!1),n){case"GB":this.model.get("isEmptyWallet")?(t=this.getPaymentModel(),t.isEmptyWallet=this.paymentFIModel.get("isEmptyWallet"),this.model.set(t),this.closePaymentModal(e)):(this.setOverpanelContent(this),this.paymentSidePanelView.showSidePanel());break;default:this.updatePaymentDataModel()}},updatePaymentDataModel:function(){var e;this.setOverpanelContent(this),e=this.getPaymentModel(),e.eligibleWalletInstruments=this.paymentFIModel.get("eligibleWalletInstruments").map(this.model.makeFILabelModel,this.model),e.isEmptyWallet=this.paymentFIModel.get("isEmptyWallet"),t.each(e.eligibleWalletInstruments,function(t){e.selectedWalletInstruments&&t.funding_source_id===e.selectedWalletInstruments.funding_source_id&&(t.selected=!0)}),this.model.set(e),e.isEmptyWallet||(this.$slideOutReference.removeClass("fadeInUpBig"),this.paymentSidePanelView.showSidePanel())},toggleFixedAmountError:function(e,t,n,i){var r=e||t||n,a=this.$(".otherAmount").find(".textInput"),o=this.$(".amountWrapper"),s=o.find(".help-error");e?s.text(o.data("error-required")):t?s.text(o.data("error-minimum-constraint")):n&&(i?s.text(o.data("error-adjusted-balance-bounds")):s.text(o.data("error-out-of-bounds"))),a.toggleClass("hasError",r),s.toggleClass("open",r)},setFixedAmount:function(e){var n,i,r,a,o,s=this.$(e.currentTarget),l=this.getPaymentModel(),c=s.val(),u=this.$(".otherAmount").find(".textInput"),d=this.$("#amount").val(),h=t.chain(l.paymentOptions).keys().find(function(e){return l.paymentOptions[e].selected}).value();return this.model.amount.set("rawValue",c),o=this.model.amount.get("canonicalValue"),n=this.model.isScheduledAmountOutOfBounds(o),a=this.model.isCurrentBalanceAdjusted(o),i=this.model.isMinimumConstraintViolated(o),r=this.model.isEmptyAmount(o),u.removeClass("hasError"),this.accessAid.push(".paymentOptions .otherAmount input:radio[name=paymentOptionType]"),this.model.get("isCreditPayment")&&""===d||!this.model.isNumeric(d)?(this.$("li.otherAmount").removeClass("selected"),s.val(""),!0):n||i?(setTimeout(t.bind(function(){this.toggleFixedAmountError(r,i,n,a)},this),1),this.model.get("isCreditPayment")&&this.$("li.otherAmount").removeClass("selected"),!1):void(l&&l.paymentOptions&&l.paymentOptions.FIXED&&(h&&(l.paymentOptions[h].selected=!1),l.paymentOptions.FIXED.value=s.val(),l.paymentOptions.FIXED.unformattedValue=c,l.paymentOptions.FIXED.selected=!0,this.model.get("isCreditPayment")&&(this.$("li.paymentOption.selected").removeClass("selected"),this.$("li.otherAmount").addClass("selected")),this.$(".paymentOptions .selected input:radio[name=paymentOptionType]").prop("checked",!0),this.model.set(l)))},fetchOnetimePaymentInfo:function(){this.toggleLoading(!0),this.model.getOnetimePaymentData(),this.resetReviewPaymentModel()},resetPaymentFlowFlags:function(){this.paymentSubmitted=!1},fetchRecurringPaymentInfo:function(){this.toggleLoading(!0),this.model.getRecurringPaymentData(),this.resetReviewPaymentModel("recurring")},fetchPaymentModel:function(e){},getPaymentFIModel:function(){},setOverpanelContent:function(e,t){t=t||"payment-flow",u.setContent(e,{className:t})},resetReviewPaymentModel:function(e){e=e||"onetime",this.reviewPaymentModel.clear({silent:!0}),this.reviewPaymentModel.set({operationType:"create",paymentType:e},{silent:!0})},validatePayment:function(){var e,t,n,i,r,a,o,s,l=!0,c=this.$(".paymentMethodError"),u=this.$(".paymentPlanOptions"),d=!1;if(c.removeClass("hasError"),e=this.$("#paymentOptions").val(),"-1"===e?(c.addClass("hasError").find(".help-error.default").addClass("open"),l=!1):this.model.isPayPalSelectedAsWI()&&!this.model.willPayPalBalanceCoverPayment()&&(this.model.get("banksCount")>0?c.addClass("hasError").find(".help-error.hasBank").addClass("open"):c.addClass("hasError").find(".help-error.noBank").addClass("open"),l=!1),u.removeClass("hasError"),n=this.$(".paymentOptions .selected input:radio[name=paymentOptionType]:checked").val(),this.model.get("hasNoPaymentOptions")||"undefined"!=typeof n||(u.addClass("hasError").find("#paymentPlan-help-error").addClass("open"),l=!1,d=!0),this.model.get("isRecurringPayment"))return l;if("cancel"!==this.model.get("operationType")){if(!this.validateScheduleDate())return!1;t=this.model.get("paymentOptions").FIXED,!d&&t&&t.selected&&(s=this.model.amount.get("canonicalValue"),i=this.model.isScheduledAmountOutOfBounds(s),r=this.model.isMinimumConstraintViolated(s),a=this.model.isEmptyAmount(s),o=this.model.isCurrentBalanceAdjusted(s),this.toggleFixedAmountError(a,r,i,o),l=l&&!a&&!r&&!i)}return l},validateScheduleDate:function(){var e=this.$("#scheduledDate").val(),t=c().year(),n=c(e).year(),i=this.$(".paymentCalendar");return i.removeClass("hasError"),n-t>=0&&2>=n-t&&c(e).isValid()?!0:(i.addClass("hasError").find(".help-error").addClass("open"),!1)},showReviewPaymentModal:function(){("cancel"===this.model.get("operationType")||this.validatePayment())&&(this.updateModel(),this.setOverpanelContent(this.reviewPaymentView),"cancel"!==this.model.get("operationType")&&(this.paymentView=this),this.paymentSidePanelView.hideSidePanel(),this.$('form[name="'+this.formName+'"]').hide())},updateModel:function(){var e,t,n,i,r,a,o,s=this.$(".paymentOptions .selected input:radio[name=paymentOptionType]:checked").val(),l=this.getPaymentModel(),u=l.selectedWalletInstruments,d=this.model.isPayPalSelectedAsWI(u),h=l.scheduledDate,p=l.timezone,f=c(h)?c(h).format("YYYY-MM-DD")+p:h,m=this.model.get("currencySymbol"),g=l.maxAmount&&l.maxAmount.formattedValue,v=!1;a=this.model.showSameDayPaymentMsg(f),o=this.model.showPayPalBalanceMsg(d,a),l.selectedWalletInstruments&&l.selectedWalletInstruments.funding_source_label&&(n=l.selectedWalletInstruments.funding_source_label,i=l.selectedWalletInstruments.issuer_name,r=l.selectedWalletInstruments.funding_source_last_n),d&&(v=this.model.hasOnlyPayPalInWalletInstrument(d,l.eligibleWalletInstruments)),l&&l.paymentOptions&&l.paymentOptions[s]&&(e=l.paymentOptions[s].value,l.isPaymentBalanceAdjusted&&g&&(e=g),e=e.indexOf(m)<0?m+e:e,t="FIXED"===s?this.model.amount.get("canonicalValue"):e.replace(/^\D+/g,"")),this.reviewPaymentModel.set({operationType:l.operationType,paymentType:l.paymentType,isRecurringPayment:l.isRecurringPayment,schedule_date:f,schedule_date_formatted:l.localizedScheduledDate||h,schedule_amount:t,schedule_amount_formatted:e,payment_option:s,funding:u,funding_source_label:n,issuer_name:i,funding_source_last_n:r,showPayPalBalanceMsg:o,primaryBankInfo:this.model.get("primaryBankInfo"),legacyBillPayId:this.model.get("legacyBillPayId"),showSameDayPaymentMsg:this.model.showSameDayPaymentMsg(f),hasPaidInstallmentFullBalance:this.model.hasPaidInstallmentFullBalance(t),hasOnlyPayPalInWalletInstrument:v,viewContext:l.viewContext,hasAgreement:!l.isInstallmentPayment,isInstallmentPayment:this.model.get("isInstallmentPayment"),hasSubTitleForAmount:l.hasSubTitleForAmount})},submitPayment:function(e){this.submitForm(e)},updateBank:function(e){this.validatePayment()&&(this.updateModel(),this.submitPayment(e))},submitForm:function(e){this.paymentSubmitted||(this.paymentSubmitted=!0,this.toggleLoading(!0),e.preventDefault(),this.listenToOnce(this.reviewPaymentModel,"sync",this.submitSuccess),this.listenToOnce(this.reviewPaymentModel,"error",this.submitError),this.reviewPaymentModel.urlRoot=this.model.getUrlRoot(),this.reviewPaymentModel.save())},submitSuccess:function(e){n.trigger("trackLink",null,"paymentSuccess","main:walletweb:credit:payment:onetimepaymentsuccess"),this.confirmPaymentViewInstance?this.confirmPaymentViewInstance.initialize(e.attributes,this.model.get("isCreditPayment")):this.confirmPaymentViewInstance=new s(e.attributes,this.model.get("isCreditPayment")),this.toggleLoading(!1),this.paymentSubmitted=!1,this.setOverpanelContent(this.confirmPaymentViewInstance)},submitError:function(e,t,n){this.formView.showError(n),this.toggleLoading(!1),this.paymentSubmitted=!1},closePaymentModal:function(e){this.clearView(),this.paymentSidePanelView.hideSidePanel(),this.alertView.hideAlert(e),u.hideOverpanel(e)},showPaymentActivities:function(e){this.closePaymentModal(e),n.history.navigate("credit/open/paymentActivities",{trigger:!0})},downloadStatementPayingByMail:function(){this.$("#latestStatementDownload").submit()},clearView:function(){this.model.clear(),this.undelegateEvents(),this.stopListening(),this.$el.empty(),this.toggleLoading(!1)},beforeRender:function(){return this.toggleLoading(!0),this},afterRender:function(){var e;this.model.get("isStandardError")?this.paymentStandardError=new k:"cancel"===this.model.get("operationType")?this.showReviewPaymentModal():this.model.get("hasPendingAuthBank")?(this.pendingAuthBank=new b,this.pendingAuthBank.render()):!this.model.get("noPaymentDue")&&this.model.get("isEmptyWallet")&&(e=this.getPaymentModel(),this.paymentNoFIView=new w(e)),this.alertView.render(),this.initForm()},formatAmount:function(){var e,t,n=this.$("#amount"),i=n.val(),r=this.getPaymentModel();return this.model.amount.set("rawValue",i),e=this.model.amount.get("localizedValue"),n.val(e),t=this.model.amount.get("canonicalValue"),this.model.isScheduledAmountOutOfBounds(t)||this.model.isMinimumConstraintViolated(t)?!0:(r.paymentOptions&&r.paymentOptions.FIXED&&null!==r.paymentOptions.FIXED.value&&(r.paymentOptions.FIXED.value=e),r.isPaymentBalanceAdjusted=this.model.isPaymentBalanceAdjusted(r.paymentOptions),this.accessAid.push(".paymentOptions .otherAmount input:radio[name=paymentOptionType]"),this.model.set(r,{silent:!0}),void(""===e&&this.$(".paymentAmount.textInput label").removeClass("accessAid")))},initForm:function(){var e=c().year()+1,t=this,n=this.getPaymentModel(),i=n.currentDate,r=n.dateFormat?n.dateFormat.datePickerFormat:null,a=n.dateFormat?n.dateFormat.format:null;this.toggleLoading(!this.model.get("modelLoaded")),this.model.get("modelLoaded")&&(this.$(".payment").removeClass("hide"),this.$(".title").removeClass("hide")),this.$(".textInput.lap").lap().textField(),r&&this.$(".paymentCalendar .input-append.date").datepicker({format:r,startDate:c(i).format(a),endDate:c(i).year(e).format(a),forceParse:!1,autoclose:!0,todayHighlight:!0}).on("hide",function(){t.paymentModel=t.$(".paymentModelData").data("paymentmodel")||{},t.paymentModel.scheduledDate=t.$("#scheduledDate").val(),t.model.set(t.paymentModel,{slient:!0})}),this.accessAid.length>0&&this.$(this.accessAid.pop()).focus()}});return C}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({urlRoot:function(){return e.history.options.root+"credit/payment/addonetime"},initialize:function(e){this.options=e||{},this.set("operationType",this.options.operationType||"create"),this.set("paymentType",this.options.paymentType||"onetime"),this.set("viewContext",this.options.viewContext)},parse:function(e){var t,n=e.data.credit,i="recurring"===this.get("paymentType"),r=n.effective_date;return r&&(t=r.split(",")[0]),{operationType:this.get("operationType"),paymentType:this.get("paymentType"),isRecurringPayment:i,schedule:n.schedule,status:n.status,effective_date:n.effective_date,effective_day:t,hasConfirmationEmail:n.hasConfirmationEmail,refreshAfterConfirmation:n.refreshAfterConfirmation,isNextBillingCycle:n.isNextBillingCycle,viewContext:this.get("viewContext")}}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{showPayingByEmail:!1,showOnlyAdjustedBalance:!1,isPaymentBalanceAdjusted:!1,isRecurringPayment:!1,paymentOptions:null},initialize:function(e){e&&this.set(e)}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(512)],r=function(e,t){"use strict";return e.extend({el:"#reviewPaymentOverPanel",model:t,template:"payment/inc/reviewPaymentModal",initialize:function(){this.listenTo(this.model,"change",this.render)},afterRender:function(){this.$el.focus()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(229),n(516),n(517),n(518)],r=function(e,t,n,i,r){"use strict";return t.extend({el:"#overpanel",template:"payment/inc/confirmPayment",events:{"click .gotoPayPalCredit, .dismiss.close":"closePaymentModal"},initialize:function(e,t){this.model=new n,this.listenTo(this.model,"change",this.render),this.model.set(e),t&&(this.paymentActivitiesModel=new i,this.paymentActivitiesView=new r({model:this.paymentActivitiesModel}))},closePaymentModal:function(){var t;this.model.get("isLoaded")&&this.model.get("refreshAfterConfirmation")&&(this.model.set("isLoaded",!1,{silent:!0}),t=this.model.get("isRecurringPayment")||"create"!==this.model.get("operationType")?"credit/latestStatement/paymentActivities":"credit/latestStatement",e.history.navigate(t,{trigger:!0}))}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{schedule_date:"",schedule_amount:"",payment_option:"",confirmation_number:"",viewContext:"credit",isLoaded:"true"}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[],r=function(){"use strict";return function(){}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[],r=function(){"use strict";return function(){}}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(513)],r=function(e,t){"use strict";return e.extend({el:".js_adjustedBalanceView",model:t,template:"payment/inc/adjustedBalance",initialize:function(){this.listenTo(this.model,"change",this.render)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},,function(e,t,n){var i,r;i=[n(3),n(224),n(229)],r=function(e,t,n){"use strict";return n.extend({el:"#overpanel",template:"payment/inc/addBankDone",events:{"click #addBankDone":"postAddBankDone"},initialize:function(t){this.options=t||{},this.options.isRecurringPayment=!1,this.options.isRecurringPayment=t.isRecurringPayment||!1,this.$slideOutReference=e("#overpanel")},postAddBankDone:function(e){return this.parentView.updateFISidePanel(this.countryCode,e),!0}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229),n(523)],r=function(e,t,n){"use strict";return t.extend({el:"#overpanel",template:"payment/inc/noFI",initialize:function(e){this.model=new n,this.listenTo(this.model,"change",this.render),this.model.set(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{operationType:"",paymentType:"",isRecurringPayment:"",options:"",eligibleWalletInstruments:"",primaryBankInfo:"",paymentOptions:"",scheduledDate:"",countryCode:"",isEmptyWallet:!1,hasPendingAuthBank:!1,paymentOptionsUIVariant:"",showMessageInSidePanel:"",showBankAvailability:!1}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229),n(228)],r=function(e,t,n){"use strict";return t.extend({el:"#overpanel",template:"payment/inc/pendingAuthBank",events:{"click .gotoPayPalCredit":"hidePaymentOverPanel"},hidePaymentOverPanel:function(e){n.hideOverpanel(e)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229)],r=function(e,t){"use strict";return t.extend({el:"#overpanel",template:"payment/inc/paymentStandardError",initialize:function(){this.render()}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(224),n(527)],r=function(e,t,n){"use strict";var i=n.extend({url:function(){return"onetime"===this.get("paymentType")&&"create"!==this.get("operationType")?e.history.options.root+"credit/payment/getonetime/"+this.get("paymentId"):"recurring"===this.get("paymentType")?e.history.options.root+"credit/payment/auto":e.history.options.root+"credit/payment"},getRecurringPaymentData:function(){this.clear(),this.set({operationType:"create",paymentType:"recurring",isRecurringPayment:!0,creditType:"payment",isCreditPayment:!0,isInstallmentPayment:!1,viewContext:"credit",urlRoot:e.history.options.root+"credit/payment/auto"}),this.fetch()},getOnetimePaymentData:function(){this.clear(),this.set({operationType:"create",paymentType:"onetime",isRecurringPayment:!1,creditType:"payment",isCreditPayment:!0,isInstallmentPayment:!1,viewContext:"credit",urlRoot:e.history.options.root+"credit/payment"}),this.fetch()},getUrlRoot:function(){return"create"===this.get("operationType")?"recurring"===this.get("paymentType")?e.history.options.root+"credit/payment/setupauto":e.history.options.root+"credit/payment/addonetime":"modify"===this.get("operationType")?"recurring"===this.get("paymentType")?e.history.options.root+"credit/payment/setupauto":e.history.options.root+"credit/payment/updateonetime/"+this.get("paymentId"):"recurring"===this.get("paymentType")?e.history.options.root+"credit/payment/cancelauto":e.history.options.root+"credit/payment/cancelonetime/"+this.get("paymentId")},parse:function(e){var t,n,i,r=e.data.credit,a=r.currentDate?"T"+r.currentDate.split("T")[1]:"",o=this.getscheduledDate(r.currentDate,r.scheduledDate,r.dateFormat),s=this.getEligibleWalletInstruments(r.eligibleWalletInstruments),l=this.getDisabledWalletInstruments(r.eligibleWalletInstruments),c=r.emptyWallet,u=r.hasPendingAuthBank,d=r.paymentOptions,h=r.scheduledPaymentType,p=this.getUIVariant(r),f=r.showNewBankAvailability,m=r.showPayingByEmail,g=e.data.banks&&e.data.banks.length,v=this.get("isRecurringPayment")?!1:r.noPaymentDue,y=e.error?!0:!1,w=r.maxAmount,b=w&&parseFloat(w.value),k=r.dateFormat,C=r.existingAutoPayment,_=r.hasCalendar,D=e.data.experimentModel;return r.currentDate&&(i=r.currentDate.split("T")[0]),this.checkDataForModify(d),this.get("isRecurringPayment")&&(o=r.scheduledDate),t=this.getSelectedFI(s),this.fixPaymentOptionsDataForFixedAmount(d,r.currencySymbol),n={operationType:this.get("operationType"),paymentType:this.get("paymentType"),isRecurringPayment:this.get("isRecurringPayment"),options:this.options,eligibleWalletInstruments:s,primaryBankInfo:this.getPrimaryBankInfo(r.primaryBank),paymentOptions:d,scheduledDate:o,timezone:a,countryCode:r.countryCode,isEmptyWallet:c,hasPendingAuthBank:u,paymentOptionsUIVariant:p,showMessageInSidePanel:"_lastStatement"===p,currencyFormat:r.currencyFormat,currencyPrecision:2,currencySymbol:r.currencySymbol,currentDate:i,maxAmount:w,minAmount:r.minAmount,minAmountValue:r.minAmount&&r.minAmount.formattedValue,showBankAvailability:f,showPayingByEmail:m,banksCount:g,noPaymentDue:v,isStandardError:y,isPaymentBalanceAdjusted:!1,modelLoaded:!0,legacyBillPayId:r.legacyBillPayId,isMobile:this.get("isMobile"),dateFormat:k,hasAutoPay:C,showOtherAmountInfo:!1,minimumPaymentDate:r.minimumPaymentDate,hasAutoPayment:r.hasAutoPayment,hasPaymentTabs:r.hasPaymentTabs,hasCalendar:_,user:e.data.user,wallet:e.data.wallet,viewContext:this.get("viewContext"),fabExperimentation:D&&D.us_8ball_web_wallet_fab_treatment||!1,hasSubTitleForAmount:e.hasSubTitleForAmount},t&&(n.selectedWalletInstruments=t),l&&(n.disabledWalletInstruments=l),h&&!v&&(n.scheduledPaymentType=h),this.get("isRecurringPayment")?(n.selectedPaymentValue=this.getSelectedPaymentOptionValue(d),n.showOtherAmountInfo=this.showOtherAmountInfo(d,m)):"cancel"!==this.get("operationType")&&(n.isPaymentBalanceAdjusted=this.isPaymentBalanceAdjusted(d,b),0!==b||v||(n.isPaymentBalanceAdjusted=!0,n.noPaymentDue=!0,n.showOnlyAdjustedBalance=!0,n.showPayingByEmail=!1)),this.setAmountContext(n.currencyFormat.separator,n.currencyFormat.decimal,n.currencyPrecision),n}});return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(224),n(389),n(528)],r=function(e,t,n,i){"use strict";var r=e.Model.extend({defaults:{operationType:"create",paymentType:"onetime",isRecurringPayment:!1,creditType:"payment",modelLoaded:!1,isMobile:!1,showPayingByEmail:!1,showOnlyAdjustedBalance:!1,isPaymentBalanceAdjusted:!1,showOtherAmountInfo:!1,hasAutoPayment:!0,hasPaymentTabs:!0,isCloseEndedCredit:!1,isCreditPayment:!0,isInstallmentPayment:!1,viewContext:"credit"},initialize:function(e){this.options=e||{},this.options.operationType=this.options.operationType||"create",this.options.paymentType=this.options.paymentType||"onetime",this.options.isRecurringPayment="recurring"===this.options.paymentType,this.options.isCloseEndedCredit=this.options.isCloseEndedCredit||!1,this.options.isCloseEndedCredit&&(this.set("creditType","installment"),this.set("isInstallmentPayment",!0),this.set("isCreditPayment",!1),this.set("viewContext","home")),!this.options.isRecurringPayment&&this.options.remainingBalance&&this.set("remainingBalance",this.options.remainingBalance),this.set("isRecurringPayment",this.options.isRecurringPayment),this.set("isMobile",this.options.isMobile),this.fetch()},setAmountContext:function(e,t,n){this.amount=new i({precision:n,decimalPoint:t,separator:e})},getUIVariant:function(e){var t="";return e._lastStatement?t="_lastStatement":e._fixed&&(t="_fixed"),t},fixPaymentOptionsDataForFixedAmount:function(e,t){e&&e.FIXED&&(e.FIXED.value&&(e.FIXED.value=e.FIXED.value.replace(t,"")),e.FIXED.selected||(e.FIXED.value=null))},checkDataForModify:function(e){"modify"===this.get("operationType")&&e&&e.FIXED&&(e.FIXED.selected||(e.FIXED.value=null,e.FIXED.unformmattedValue=null))},showOtherAmountInfo:function(e,t){return t=t||this.get("showPayingByEmail"),e=e||this.get("paymentOptions"),!t&&this.get("isRecurringPayment")&&e&&e.FIXED&&e.FIXED.selected?!0:!1},showSameDayPaymentMsg:function(e){var t=this.get("currentDate");return!this.get("isRecurringPayment")&&t&&e?n(t).format("MM-DD-YYYY")===n(e).format("MM-DD-YYYY"):!1},getSelectedFI:function(e){var t,n,i;if(!e)return null;for(n=0;n<e.length;n++)if(i=e[n],i.selected===!0)return t=i,i.funding_source_last_n&&(t.funding_source_label=this.getIssuerLabel(i),t.shortIssuerName=this.getShorterIssuerName(i.issuer_name)),t;return null},getIssuerLabel:function(e){return e.issuer_name+" - "+e.funding_source_last_n},getShorterIssuerName:function(e){var t=e;return e&&e.length>21&&(t=e.substr(0,16)+"..."),t},getSelectedPaymentOptionValue:function(e,n){var i=t.find(e,function(e){return e.selected});return n=n||!1,i?n?parseFloat(i.unformattedValue):i.value:null},isPayPalSelectedAsWI:function(e){return e=e||this.get("selectedWalletInstruments"),e&&e.funding_source_type&&"PAYPAL_BALANCE"===e.funding_source_type},hasOnlyPayPalInWalletInstrument:function(e,t){return e=e||this.isPayPalSelectedAsWI(),t=t||this.get("eligibleWalletInstruments"),e&&t?1===t.length:!1},showPayPalBalanceMsg:function(e,t){return t?!1:e?!0:!1},getPrimaryBankInfo:function(e){return e?e.issuer_name+" - "+e.funding_source_last_n:""},getscheduledDate:function(e,t,i){var r=i&&i.momentFormat;return this.get("isRecurringPayment")?t:t&&n(t).isValid()?n(t.split("T")[0]).format(r):e?n(e.split("T")[0]).format(r):""},isScheduledAmountOutOfBounds:function(e){return this.isZeroAmount(e)?!1:this.get("isRecurringPayment")?this.isMinimumConstraintViolated(e):parseFloat(e)<parseFloat(this.get("minAmount").value)||parseFloat(e)>parseFloat(this.get("maxAmount").value);
},isCurrentBalanceAdjusted:function(){var e,t=this.get("paymentOptions"),n=parseFloat(this.get("maxAmount").value);return this.get("isRecurringPayment")?!1:(t&&t.CURRENT_BALANCE&&t.CURRENT_BALANCE.unformattedValue&&(e=parseFloat(t.CURRENT_BALANCE.unformattedValue)),e!==n)},isMinimumConstraintViolated:function(e){return this.isZeroAmount(e)||parseFloat(e)<0?!0:parseFloat(e)<parseFloat(this.get("minAmount").value)},isZeroAmount:function(e){return 0===parseFloat(e)},isEmptyAmount:function(e){return t.isUndefined(e)||t.isNull(e)||""===e},isNumeric:function(e){return!t.isNaN(parseFloat(e))},isPaymentBalanceAdjusted:function(e,n){var i,r=e||this.get("paymentOptions"),a=this.get("maxAmount");return(n=n||a&&parseFloat(a.value))?(i=t.find(r,function(e){return e.selected}))&&parseFloat(i.unformattedValue)>n?(this.set("isPaymentBalanceAdjusted",!0,{silent:!0}),!0):(this.set("isPaymentBalanceAdjusted",!1,{silent:!0}),!1):!1},getEligibleWalletInstruments:function(e){var n;return n=t.chain(e).reject(function(e){return e&&e.funding_source_type&&"PAYPAL_BALANCE"===e.funding_source_type?e.unformattedTotalAvailable<=0:void 0}).map(this.makeFILabelModel,this).value()},getDisabledWalletInstruments:function(e){var t;return t=e&&e.filter(function(e){return e&&e.funding_source_type&&"PAYPAL_BALANCE"===e.funding_source_type?e.unformattedTotalAvailable<=0:void 0}),t||[]},willPayPalBalanceCoverPayment:function(){var e,t=this.get("selectedWalletInstruments"),n=t&&t.unformattedTotalAvailable,i=this.get("paymentOptions"),r=this.get("maxAmount"),a=r&&parseFloat(r.value);return n?(i&&(e=this.isPaymentBalanceAdjusted(i)?a:this.getSelectedPaymentOptionValue(i,!0)),e?n>=e:!0):!1},hasPaidInstallmentFullBalance:function(){return!1},makeFILabelModel:function(e){return e.funding_source_last_n&&(e.shortIssuerName=this.getShorterIssuerName(e.issuer_name),e.funding_source_label=this.getIssuerLabel(e)),e}});return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{separator:",",decimalPoint:".",precision:2},initialize:function(){this.listenTo(this,"change:rawValue",this.setFormattedValue),this.regex=this.initRegexVars()},initRegexVars:function(){var e=this.get("decimalPoint");return{cleanup:new RegExp("[^0-9\\"+e+"]","g"),safeLeadingZero:new RegExp("^\\"+e)}},setFormattedValue:function(){var e=this.get("rawValue"),t=this.get("decimalPoint"),n=this.get("precision");this.set(this.format(e,t,n))},format:function(e,t,n){var i=e.replace(this.regex.cleanup,"").replace(this.regex.safeLeadingZero,"0"+t).replace(t,".");return""!==i&&(i=parseFloat(i).toFixed(n)),{canonicalValue:i,localizedValue:i.replace(".",t)}}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return this.options.isRecurringPayment?e.history.options.root+"credit/payment/autoinstruments":e.history.options.root+"credit/payment/onetimeinstruments"},defaults:{isRecurringPayment:!1},initialize:function(e){this.options=e||{}},parse:function(e){var t=e.data.credit,n=t.eligibleWalletInstruments||[],i=0===n.length;return{eligibleWalletInstruments:n,isEmptyWallet:i}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(511),n(531),n(532)],r=function(e,t,n){"use strict";return e.extend({fetchPaymentModel:function(e){this.resetPaymentFlowFlags(),this.model=new t(e)},getPaymentFIModel:function(){return n}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(224),n(527)],r=function(e,t,n){"use strict";var i=n.extend({url:function(){return this.get("isRecurringPayment")?e.history.options.root+"installment/auto/"+this.get("paymentId"):e.history.options.root+"installment/onetime/"+this.get("paymentId")},getUrlRoot:function(){return this.get("isRecurringPayment")?e.history.options.root+"installment/updateauto/"+this.get("paymentId"):e.history.options.root+"installment/addonetime/"+this.get("paymentId")},getUIVariant:function(){return"_fixed"},parse:function(e){var t,n,i,r=e.data.credit,a=r.currentDate?"T"+r.currentDate.split("T")[1]:"",o=this.getscheduledDate(r.currentDate,r.scheduledDate,r.dateFormat),s=this.getEligibleWalletInstruments(r.eligibleWalletInstruments),l=r.emptyWallet,c=r.hasPendingAuthBank,u=r.paymentOptions,d=r.scheduledPaymentType,h=this.getUIVariant(r),p=r.showNewBankAvailability,f=r.showPayingByEmail,m=e.data.banks&&e.data.banks.length,g=this.get("isRecurringPayment")?!1:r.noPaymentDue,v=e.error?!0:!1,y=r.maxAmount,w=y&&parseFloat(y.value),b=r.dateFormat,k=r.existingAutoPayment,C=r.hasCalendar;return r.currentDate&&(i=r.currentDate.split("T")[0]),y&&(y.value=w),this.checkDataForModify(u),this.get("isRecurringPayment")&&(o=r.scheduledDate),t=this.getSelectedFI(s),this.fixPaymentOptionsDataForFixedAmount(u,r.currencySymbol),n={operationType:this.get("operationType"),paymentType:this.get("paymentType"),isRecurringPayment:this.get("isRecurringPayment"),options:this.options,eligibleWalletInstruments:s,primaryBankInfo:this.getPrimaryBankInfo(r.primaryBank),paymentOptions:u,scheduledDate:o,localizedScheduledDate:r.currentDateFormatted||o,timezone:a,countryCode:r.countryCode,isEmptyWallet:l,hasPendingAuthBank:c,paymentOptionsUIVariant:h,showMessageInSidePanel:"_lastStatement"===h,currencyFormat:r.currencyFormat,currencyPrecision:2,currencySymbol:r.currencySymbol,currentDate:i,maxAmount:y,minAmount:r.minAmount,minAmountValue:r.minAmount&&r.minAmount.formattedValue,showBankAvailability:p,showPayingByEmail:f,banksCount:m,noPaymentDue:g,isStandardError:v,isPaymentBalanceAdjusted:!1,modelLoaded:!0,legacyBillPayId:r.legacyBillPayId,isMobile:this.get("isMobile"),dateFormat:b,hasAutoPay:k,showOtherAmountInfo:!1,minimumPaymentDate:r.minimumPaymentDate,hasAutoPayment:r.hasAutoPayment,hasPaymentTabs:r.hasPaymentTabs,hasCalendar:C,user:e.data.user,wallet:e.data.wallet,viewContext:this.get("viewContext"),isBankInvalid:r.isBankInvalid,isBankChanged:r.isBankChanged,newBankEffectDate:r.newBankEffectDate,isBankChangedInTime:r.isBankChangedInTime,newBank:r.newBank,oldBank:t,hasPendingPayment:this.hasPendingPayment(this.get("remainingBalance"),y)},t&&(n.selectedWalletInstruments=t),d&&!g&&(n.scheduledPaymentType=d),this.get("isRecurringPayment")?(n.selectedPaymentValue=this.getSelectedPaymentOptionValue(u),n.showOtherAmountInfo=this.showOtherAmountInfo(u,f)):"cancel"!==this.get("operationType")&&(n.isPaymentBalanceAdjusted=this.isPaymentBalanceAdjusted(u,w),0!==w||g||(n.isPaymentBalanceAdjusted=!0,n.noPaymentDue=!0,n.showOnlyAdjustedBalance=!0,n.showPayingByEmail=!1)),this.mockDEData(n),this.setAmountContext(n.currencyFormat.separator,n.currencyFormat.decimal,n.currencyPrecision),n},mockDEData:function(e){e.paymentOptionsUIVariant="_fixed",e.showPayingByEmail=!1,e.hasPaymentTabs=!1,e.scheduledPaymentType=null,e.hasCalendar=!1,e.paymentOptions={FIXED:{value:null,unformattedValue:null,selected:!0}},this.get("isRecurringPayment")&&(e.paymentOptions.FIXED.selected=!1,e.hasNoPaymentOptions=!0,e.updateBankFlow=!0)},showSameDayPaymentMsg:function(){return!1},hasPaidInstallmentFullBalance:function(e,t){return this.get("remainingBalance")?(t=t||this.get("maxAmount").value,e>=t):!1},hasPendingPayment:function(e,t){var n=e&&e.unformattedAmount||0,i=t&&t.value||0;return parseFloat(n)>parseFloat(i)}});return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(529)],r=function(e,t){"use strict";return t.extend({url:function(){return this.get("isRecurringPayment")?e.history.options.root+"installment/auto/"+this.get("paymentId"):e.history.options.root+"installment/onetime/"+this.get("paymentId")},defaults:{isRecurringPayment:!1},initialize:function(e){this.options=e||{},this.set("paymentId",this.options.paymentId),this.set("isRecurringPayment",this.options.isRecurringPayment||!1)}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(229),n(534),n(228)],r=function(e,t,n){"use strict";var i=e.extend({el:".overpanel-content",template:"credit/inc/installmentActivities",initialize:function(e){this.model=new t(e),this.listenTo(this.model,"change",this.renderActivities)},renderActivities:function(){n.setContent(this,{className:"payment-flow"})},beforeRender:function(){return this.toggleLoading(!0),this},afterRender:function(){return this.toggleLoading(!1),this}});return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";return e.Model.extend({url:function(){return e.history.options.root+"installment/"+this.get("installmentId")+"/activities"},initialize:function(e){this.set("installmentId",e.id),this.set("remainingBalance",e.remainingBalance),this.fetch()},parse:function(e){var t=e.data.credit;return{installmentActivities:t.installmentActivities,remainingBalance:this.get("remainingBalance")}}})}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(468)],r=function(e,t){"use strict";var n=t.extend({});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(537)],r=function(e,t){"use strict";var n=e.Collection.extend({model:t});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({idAttribute:"promoId",defaults:{isExpanded:!1},toggleProp:function(e,t){"undefined"==typeof t&&(t=!this.get(e)),this.set(e,t)},canExpand:function(){return"ACTIVE"===this.get("promoStatus")}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(224),n(223),n(389),n(539)],r=function(e,t,n,i){"use strict";var r=t.Collection.extend({model:i,parse:function(e){var t=this,n=this.model;e.each(function(e){var i=Number(e.get("expirationYear")).toString().substr(2,2),r=e.get("expirationMonth"),a=r+"/"+i,o=t.isNearExpiryDate(a),s=e.get("state"),l=new n({fiId:e.get("fiId"),expiryDate:a});e.get("hasExpired")?l.set({alertType:"critical",hasAlert:!0}):o?l.set({alertType:"attention",hasAlert:!0}):s&&"complete_confirmation"===s&&l.set({alertType:"unconfirmed",hasAlert:!0}),t.add(l)}),this.trigger("alertsParsed")},isNearExpiryDate:function(e){var t,i=n(e,"MM-YY"),r=!1;return i.isValid()&&(t=i.clone().endOf("month"),r=n().isAfter(t.clone().subtract(45,"days"))),r},detectAlertTypeMix:function(){var e=this.where({alertType:"critical"}),t=this.where({alertType:"attention"}),n=e.length,i=t.length,r={numOfAlerts:n+i};return n>=1&&i>=1?r.generalAlertType="mixed":n>1&&0===i?r.generalAlertType="critical-multi":1===n&&0===i?(r.generalAlertType="critical-single",r.singleAlertFiId=e[0].get("fiId")):0===n&&i>1?r.generalAlertType="attention-multi":0===n&&1===i&&(r.generalAlertType="attention-single",r.singleAlertFiId=t[0].get("fiId")),r}});return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{fiId:null,alertType:null,expiryDate:null,hasAlert:!1}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(224),n(223),n(389),n(541)],r=function(e,t,n,i){"use strict";var r=t.Collection.extend({model:i,parse:function(e){var t=this,n=this.model;e.each(function(e){var i=e.get("state"),r=new n({fiId:e.get("fiId")});i&&"confirmed"!==i&&r.set({alertType:"unconfirmed",hasAlert:!0}),t.add(r)})}});return r}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{fiId:null,alertType:null,hasAlert:!1}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{generalAlertType:null,numOfAlerts:0,singleAlertFiId:null,links:null,linkAttributes:null},getSingleCardAlert:function(e,t){var n,i=e.findWhere({fiId:this.get("singleAlertFiId")})||null,r=t.findWhere({fiId:this.get("singleAlertFiId")})||null;return i&&r&&(n={lastDigits:i.get("lastDigits"),cardType:i.get("cardType"),expiryDate:r.get("expiryDate")}),n},parseLinks:function(e){var t={linkBank:{linkUrl:e.linkBank,target:e.linkTarget},linkCard:{linkUrl:e.linkCard,target:e.linkTarget},walletPage:{linkUrl:e.walletPage,target:e.linkTarget}},n={FIModule_linkBank:e.linkBankAttributes,FIModule_linkBankUS:e.linkBankUsAttributes,FIModule_linkCard:e.linkCardAttributes,FIModule_updateInWallet:e.updateFiAttributes};this.set({links:t,linkAttributes:n})}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{locale:null,numOfAlerts:0},parse:function(e){var t=e.cardAlerts.where({hasAlert:!0}).length,n=e.bankAlerts.where({hasAlert:!0}).length,i=t+n;this.set("numOfAlerts",i)}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(224),n(223),n(229),n(545)],r=function(e,t,n,i,r){"use strict";var a=i.extend({el:".js_fiModule-listView",template:"summary/inc/fiModule/fiList",initialize:function(e){var t=this.$el.data();this.bankCollection=e.bankCollection,this.cardCollection=e.cardCollection,this.cardAlertCollection=e.cardAlertCollection,this.bankAlertCollection=e.bankAlertCollection,this.cardAlertMessagingModel=e.cardAlertMessagingModel,this.cardAlertMessagingModel.parseLinks(t),this.userConfig={features:{bank:t.userConfigFeaturesBank}},this.listenTo(this.bankCollection,"change",this.parseBankCollection),this.listenTo(this.cardCollection,"change",this.parseCardCollection),this.render()},afterRender:function(){var e=this.cardCollection.length+this.bankCollection.length;e||(this.altContentView=new r({listModel:this.model,links:this.cardAlertMessagingModel.get("links"),linkAttributes:this.cardAlertMessagingModel.get("linkAttributes")}))},serialize:function(){return{BANK:this.bankCollection.toJSON(),CREDIT:this.cardCollection.toJSON(),bankAlerts:this.bankAlertCollection.toJSON(),cardAlerts:this.cardAlertCollection.toJSON(),listDetails:this.model.toJSON(),links:this.cardAlertMessagingModel.get("links"),linkAttributes:this.cardAlertMessagingModel.get("linkAttributes"),userConfig:this.userConfig}},parseCardCollection:function(){var e;this.cardAlertCollection.reset(),this.cardAlertCollection.parse(this.cardCollection),e=this.cardAlertCollection.detectAlertTypeMix(),this.cardAlertMessagingModel.set(e),this.render()},parseBankCollection:function(){this.bankAlertCollection.reset(),this.bankAlertCollection.parse(this.bankCollection),this.render()}});return a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(229),n(546)],r=function(e,t,n){"use strict";var i=t.extend({el:".js_fiModule-altContent",template:"summary/inc/fiModule/altContent",initialize:function(e){this.model=new n,this.listDetailsModel=e.listModel,this.links=e.links,this.linkAttributes=e.linkAttributes,this.render()},beforeRender:function(){this.model.randomizeModuleContent()},serialize:function(){return{altContent:this.model.toJSON(),listDetails:this.listDetailsModel.toJSON(),links:this.links,linkAttributes:this.linkAttributes}}});return i}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{linkBankContent:!0},randomizeModuleContent:function(){var e=Math.floor(100*Math.random());e>66&&this.set({linkBankContent:!1})}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223),n(229)],r=function(e,t){"use strict";var n=t.extend({el:".js_loadErrorModule",template:"widgets/loadError-moduleMessaging",events:{transitionend:"transitionEnd",webkitTransitionEnd:"transitionEnd",oTransitionEnd:"transitionEnd",MSTransitionEnd:"transitionEnd"},initialize:function(){this.render()},afterRender:function(){var e=this;setTimeout(function(){e.loadInitialError()},25)},triggerLoading:function(e,t){e.addClass("loadBarTransition"+t),setTimeout(function(){e.addClass("loadBarWidth")},25)},loadInitialError:function(){var e=this.$el.find(".js_loadErrorFirstLoad"),t=this.$el.find(".js_loadErrorLoadBar");e.hasClass("hide")===!1&&this.triggerLoading(t,1)},loadErrorAfterTransition:function(e){var t=e.parent().find(".js_loadErrorFirstLoad"),n=e.parent().find(".js_loadErrorSecondLoad"),i=e.parent().find(".js_loadErrorFinal");n.hasClass("hide")?(t.addClass("hide"),n.removeClass("hide"),this.triggerLoading(e,2)):(n.addClass("hide"),e.addClass("hide"),i.removeClass("hide"))},transitionEnd:function(e){var t=this,n=this.$el.find(e.target);n.removeClass("loadBarTransition1").removeClass("loadBarTransition2").removeClass("loadBarWidth"),setTimeout(function(){t.loadErrorAfterTransition(n)},25)}});return n}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(229),n(549),n(228),n(550)],r=function(e,t,n,i,r){"use strict";var a=t.extend({el:"#js_profilePhotoView",template:"components/component-photoupload/profilePhotoView",events:{click:"showPhotoUploadOverpanel"},photoEl:{imgEl:"#js_user_icon",size:200},initialize:function(e){var t,i=this.$el.find("#js_profilePhotoParent"),a=i.attr("data-profile-photo"),o=i.attr("data-wurfl"),s=window.location.href.match(/myaccount\/(.*)/),l=s&&s[1]||"/";if(this.model=new n({contextRoot:l}),a)try{t=JSON.parse(a),t&&t[200]&&this.model.parse({200:t[200]}),t&&t[300]&&this.model.parse({300:t[300]})}catch(c){}this.model.set("isWireless",JSON.parse(o).isWireless),this.listenTo(this.model,"change:_200_url",this.render),this.render(),this._photoUploadView=this._photoUploadView||new r({model:this.model,uploadPhotoUrl:e&&e.uploadPhotoUrl})},afterRender:function(){this.listenTo(this.model,"change:hasFileReader",this.hasFileReader),this.model.checkForFileReader(),this.model.getHasPhoto()&&this.centerPhoto(this.photoEl)},centerPhoto:function(e){var t,n,i=e.imgEl,r=83,a=this.model.getImgDimensions(e.size),o=a.width,s=a.height;t=this.model.calculatePhotoPositioning({imgWidth:o,imgHeight:s,containerSideLength:r}),n={top:"-"+t.top+"px",left:"-"+t.left+"px"},this.$el.find(i).css(n)},showPhotoUploadOverpanel:function(e){return e.stopPropagation(),e.preventDefault(),this.model.getHasFileReader()?void i.setContent(this._photoUploadView):!1},hasFileReader:function(){this.$el.addClass("hasFileReader"),this.$el.find("#js_user_icon").removeClass("icon-profile-large"),this.$el.find("#js_user_icon").addClass("icon-profile-add-large")}});return a}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(223)],r=function(e){"use strict";var t=e.Model.extend({defaults:{hasPhoto:!1,fileMetadata:null,validPhotoFile:null,warningCode:null,isWireless:!1,previewPhoto:null,previewOrientation:null,previewPhotoTop:0,previewPhotoLeft:0,isConfirmation:!1,serverError:null,_32_url:null,_32_height:null,_32_width:null,_32_orientation:null,_64_url:null,_64_height:null,_64_width:null,_64_orientation:null,_96_url:null,_96_height:null,_96_width:null,_96_orientation:null,_200_url:null,_200_height:null,_200_width:null,_200_orientation:null,_300_url:null,_300_height:null,_300_width:null,_300_orientation:null,_400_url:null,_400_height:null,_400_width:null,_400_orientation:null},parseUploadSuccessModel:function(e){var t=e.get("photoUrls");this.set(this.defaults),this.parse(t)},parse:function(e){this.set({hasPhoto:!0,previewPhoto:null,isConfirmation:!1}),e[32]&&this.set({_32_url:e[32].url,_32_height:e[32].height,_32_width:e[32].width,_32_orientation:e[32].orientation}),e[64]&&this.set({_64_url:e[64].url,_64_height:e[64].height,_64_width:e[64].width,_64_orientation:e[64].orientation}),e[96]&&this.set({_96_url:e[96].url,_96_height:e[96].height,_96_width:e[96].width,_96_orientation:e[96].orientation}),e[200]&&this.set({_200_url:e[200].url,_200_height:e[200].height,_200_width:e[200].width,_200_orientation:e[200].orientation}),e[300]&&this.set({_300_url:e[300].url,_300_height:e[300].height,_300_width:e[300].width,_300_orientation:e[300].orientation}),e[400]&&this.set({_400_url:e[400].url,_400_height:e[400].height,_400_width:e[400].width,_400_orientation:e[400].orientation})},calculatePhotoPositioning:function(e){var t,n,i=parseInt(e.imgWidth,10),r=parseInt(e.imgHeight,10),a=e.containerSideLength,o=0,s=0;return i>r&&i/r>1.1?(t="landscape",n=a/r,s=(i*n-a)/2):r>i&&r/i>1.1?(t="portrait",n=a/i,o=(r*n-a)/2):t="square",{top:o,left:s,orientation:t}},getHasPhoto:function(){return this.get("hasPhoto")?!0:!1},getImgDimensions:function(e){var t=this.get("_"+e+"_height"),n=this.get("_"+e+"_width");return{height:t,width:n}},getWarningCode:function(){return this.get("warningCode")},getHasFileReader:function(){return this.get("hasFileReader")},clearWarningCode:function(){this.set({warningCode:null})},clearPreviewPhoto:function(){this.set({previewPhoto:null,isConfirmation:!1})},checkForFileReader:function(){this.get("hasFileReader")&&this.set({hasFileReader:null}),window.FileReader&&this.set({hasFileReader:!0})},setConfirmation:function(){this.set({isConfirmation:!0})},setServerError:function(e){this.set({serverError:e,isConfirmation:!1})}});return t}.apply(t,i),!(void 0!==r&&(e.exports=r))},function(e,t,n){var i,r;i=[n(3),n(223),n(229),n(228)],r=function(e,t,n,i){"use strict";var r,a=n.extend({el:"#overpanel",events:{"click #js_submitPhotoButton":"openFileExplorer","click #js_changePhotoButton":"openFileExplorer","change #js_photoUploadFileInput":"uploadPhoto","click #js_confirmPhotoButton":"sendPhoto","click #js_restartPhotoUploadButton":"showUploadPhotoView","click .close":"closeOverpanel",animationend:"focusOnAddPhotoButton",webkitAnimationEnd:"focusOnAddPhotoButton",oAnimationEnd:"focusOnAddPhotoButton",MSAnimationEnd:"focusOnAddPhotoButton"},template:"components/component-photoupload/photoUploadView",photoEl:{imgEl:"#js_profilePhoto",size:300},initialize:function(e){r=t.Model.extend({urlRoot:e.uploadPhotoUrl||"/myaccount/settings/photo"}),this.listenTo(this.model,"change:serverError",this.render),this.listenTo(this.model,"change:isConfirmation",this.render),this.listenTo(this.model,"change:contextRoot",this.render),this.listenTo(this.model,"change:warningCode",this.triggerWarning),this.listenTo(this.model,"validPhotoFile",this.handleUploadSuccess)},afterRender:function(){this.centerPhoto(this.photoEl)},centerPhoto:function(e){var t,n,i=e.imgEl,r=150,a=this.model.getImgDimensions(e.size),o=a.width,s=a.height;t=this.model.calculatePhotoPositioning({imgWidth:o,imgHeight:s,containerSideLength:r}),n={top:"-"+t.top+"px",left:"-"+t.left+"px"},this.$el.find(i).css(n)},openFileExplorer:function(){this.$el.find("#js_photoUploadFileInput").trigger("click")},handleUploadSuccess:function(){var e=this;this.addSpinner(),this.clearWarnings(),this.$el.find("#js_addingPhotoText").removeClass("hide"),setTimeout(function(){e.model.setConfirmation(),e.removeSpinner(),e.$("#js_addingPhotoText").addClass("hide"),e.render()},1e3)},clearWarnings:function(){this.$el.find("#js_photoWarning").addClass("hide"),this.$el.find(".js_allWarnings").addClass("hide"),this.model.clearWarningCode()},triggerWarning:function(){var e=this.model.getWarningCode();this.$el.find("#js_"+e).removeClass("hide"),this.$el.find("#js_photoWarning").removeClass("hide")},sendPhoto:function(e){var t,n=new FileReader,i=this.model.get("fileMetadata"),a=this;this.addSpinner(),this.$el.find("#js_addingPhotoText").removeClass("hide"),n.onload=function(e){t=new r({photo:e.target.result}),a.listenToOnce(t,"sync",a.handleSendPhotoResponse),a.listenToOnce(t,"error",a.showUploadErrorView),t.save()},n.readAsDataURL(i)},handleSendPhotoResponse:function(e){this.model.parseUploadSuccessModel(e),this.removeSpinner(),this.closeOverpanel(),this.stopListening(e)},showUploadErrorView:function(e){this.model.setServerError(!0),this.removeSpinner(),this.stopListening(e)},uploadPhoto:function(e){var t,n=this,i=e.currentTarget.files[0],r=/image[/](jpeg|jpg|gif|png|bmp)/,a=new FileReader;return e.preventDefault(),this.clearWarnings(),i?i.type.match(r)?i.size>2097152?void this.model.set({warningCode:"fileTooLargeWarning"}):(this.model.clearWarningCode(),a.onload=function(e){var r,a,o,s,l,c;t=e.target.result,r=document.createElement("img"),r.src=t,r.id="renderedImage",r.classList.add("invisible"),a=document.body.appendChild(r),setTimeout(function(){l=a.getClientRects(),o=l[0].width,s=l[0].height,document.body.removeChild(a),c=n.model.calculatePhotoPositioning({imgWidth:o,imgHeight:s,containerSideLength:150}),n.model.set({validPhotoFile:!0,previewPhoto:t,fileMetadata:i,previewOrientation:c.orientation,previewPhotoTop:c.top,previewPhotoLeft:c.left}),n.handleUploadSuccess()},100,a,l,o,s,c,n)},void a.readAsDataURL(i)):void this.model.set({warningCode:"fileTypeWarning"}):void this.model.set({warningCode:"noFileWarning"})},showUploadPhotoView:function(){this.model.setServerError(!1)},closeOverpanel:function(){i.hideOverpanel(),this.model.clearPreviewPhoto()},addSpinner:function(){this.$el.addClass("hasSpinner")},removeSpinner:function(){this.$el.removeClass("hasSpinner")}});return a}.apply(t,i),!(void 0!==r&&(e.exports=r))}]));
//# sourceMappingURL=4.4.js.map